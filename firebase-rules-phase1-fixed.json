{
  "rules": {
    "groups": {
      ".read": true,
      ".write": true,

      "$groupId": {
        ".read": true,
        ".write": true,

        "checkins": {
          "$date": {
            "$index": {
              ".validate": "(newData.hasChildren(['name', 'timestamp']) || newData.val() === null) && (!newData.child('playStyle').exists() || newData.child('playStyle').isString()) && (!newData.child('timestamp').exists() || newData.child('timestamp').isNumber())"
            }
          }
        },

        "activity": {
          "$date": {
            ".read": true,
            ".write": true
          }
        },

        "matchNotes": {
          "$date": {
            "$matchKey": {
              ".validate": "newData.isString() && newData.val().length <= 1000"
            }
          }
        },

        "userNotifications": {
          "$userId": {
            ".read": true,
            ".write": true,
            "items": {
              ".indexOn": ["timestamp"]
            }
          }
        },

        "settings": {
          "members": {
            ".read": true,
            ".write": true
          },

          "memberDetails": {
            "$memberName": {
              ".read": true,
              ".write": true
            }
          },

          "groupPin": {
            ".read": true,
            ".write": "!data.exists()",
            ".validate": "newData.isString() && newData.val().length >= 1 && newData.val().length <= 20"
          },

          "adminPin": {
            ".read": true,
            ".write": "!data.exists()",
            ".validate": "newData.isString() && newData.val().length >= 1 && newData.val().length <= 20"
          },

          "groupName": {
            ".read": true,
            ".write": true,
            ".validate": "newData.isString() && newData.val().length <= 100"
          },

          "location": {
            ".read": true,
            ".write": true
          }
        },

        "metadata": {
          ".read": true,
          ".write": "!data.exists()",
          ".validate": "newData.hasChildren(['archetype', 'createdAt', 'createdBy', 'shortCode', 'creator'])"
        }
      }
    },

    "siteSettings": {
      ".read": true,
      ".write": false
    },

    "userPreferences": {
      ".read": true,
      ".write": true
    },

    "_migrationCompleted": {
      ".read": true,
      ".write": false
    },

    "checkins": {
      ".read": true,
      ".write": false
    },

    "settings": {
      ".read": true,
      ".write": false
    },

    "shortCodeIndex": {
      ".read": true,
      ".write": true,
      "$shortCode": {
        ".validate": "newData.isString()"
      }
    },

    "platform": {
      "users": {
        "$deviceToken": {
          ".read": true,
          ".write": true
        }
      }
    },

    "contactRequests": {
      ".read": true,
      ".write": true,
      "$requestId": {
        ".validate": "newData.hasChildren(['type', 'name', 'email', 'createdAt'])"
      }
    }
  }
}
