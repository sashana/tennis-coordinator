(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function i(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=i(r);fetch(r.href,a)}})();var gn,M,Ti,Pi,Pe,si,Ei,Fi,Ni,Yn,Fn,Nn,kt={},Li=[],wo=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,mn=Array.isArray;function ye(e,n){for(var i in n)e[i]=n[i];return e}function Kn(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function _o(e,n,i){var o,r,a,l={};for(a in n)a=="key"?o=n[a]:a=="ref"?r=n[a]:l[a]=n[a];if(arguments.length>2&&(l.children=arguments.length>3?gn.call(arguments,2):i),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)l[a]===void 0&&(l[a]=e.defaultProps[a]);return nn(e,l,o,r,null)}function nn(e,n,i,o,r){var a={type:e,props:n,key:i,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++Ti,__i:-1,__u:0};return r==null&&M.vnode!=null&&M.vnode(a),a}function D(e){return e.children}function yt(e,n){this.props=e,this.context=n}function Qe(e,n){if(n==null)return e.__?Qe(e.__,e.__i+1):null;for(var i;n<e.__k.length;n++)if((i=e.__k[n])!=null&&i.__e!=null)return i.__e;return typeof e.type=="function"?Qe(e):null}function Bi(e){var n,i;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,n=0;n<e.__k.length;n++)if((i=e.__k[n])!=null&&i.__e!=null){e.__e=e.__c.base=i.__e;break}return Bi(e)}}function ci(e){(!e.__d&&(e.__d=!0)&&Pe.push(e)&&!an.__r++||si!=M.debounceRendering)&&((si=M.debounceRendering)||Ei)(an)}function an(){for(var e,n,i,o,r,a,l,s=1;Pe.length;)Pe.length>s&&Pe.sort(Fi),e=Pe.shift(),s=Pe.length,e.__d&&(i=void 0,o=void 0,r=(o=(n=e).__v).__e,a=[],l=[],n.__P&&((i=ye({},o)).__v=o.__v+1,M.vnode&&M.vnode(i),qn(n.__P,i,o,n.__n,n.__P.namespaceURI,32&o.__u?[r]:null,a,r??Qe(o),!!(32&o.__u),l),i.__v=o.__v,i.__.__k[i.__i]=i,Wi(a,i,l),o.__e=o.__=null,i.__e!=r&&Bi(i)));an.__r=0}function Oi(e,n,i,o,r,a,l,s,d,u,f){var p,h,c,g,y,v,x,b=o&&o.__k||Li,w=n.length;for(d=ko(i,n,b,d,w),p=0;p<w;p++)(c=i.__k[p])!=null&&(h=c.__i==-1?kt:b[c.__i]||kt,c.__i=p,v=qn(e,c,h,r,a,l,s,d,u,f),g=c.__e,c.ref&&h.ref!=c.ref&&(h.ref&&Jn(h.ref,null,c),f.push(c.ref,c.__c||g,c)),y==null&&g!=null&&(y=g),(x=!!(4&c.__u))||h.__k===c.__k?d=ji(c,d,e,x):typeof c.type=="function"&&v!==void 0?d=v:g&&(d=g.nextSibling),c.__u&=-7);return i.__e=y,d}function ko(e,n,i,o,r){var a,l,s,d,u,f=i.length,p=f,h=0;for(e.__k=new Array(r),a=0;a<r;a++)(l=n[a])!=null&&typeof l!="boolean"&&typeof l!="function"?(typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?l=e.__k[a]=nn(null,l,null,null,null):mn(l)?l=e.__k[a]=nn(D,{children:l},null,null,null):l.constructor==null&&l.__b>0?l=e.__k[a]=nn(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):e.__k[a]=l,d=a+h,l.__=e,l.__b=e.__b+1,(u=l.__i=Co(l,i,d,p))!=-1&&(p--,(s=i[u])&&(s.__u|=2)),s==null||s.__v==null?(u==-1&&(r>f?h--:r<f&&h++),typeof l.type!="function"&&(l.__u|=4)):u!=d&&(u==d-1?h--:u==d+1?h++:(u>d?h--:h++,l.__u|=4))):e.__k[a]=null;if(p)for(a=0;a<f;a++)(s=i[a])!=null&&(2&s.__u)==0&&(s.__e==o&&(o=Qe(s)),Ui(s,s));return o}function ji(e,n,i,o){var r,a;if(typeof e.type=="function"){for(r=e.__k,a=0;r&&a<r.length;a++)r[a]&&(r[a].__=e,n=ji(r[a],n,i,o));return n}e.__e!=n&&(o&&(n&&e.type&&!n.parentNode&&(n=Qe(e)),i.insertBefore(e.__e,n||null)),n=e.__e);do n=n&&n.nextSibling;while(n!=null&&n.nodeType==8);return n}function Co(e,n,i,o){var r,a,l,s=e.key,d=e.type,u=n[i],f=u!=null&&(2&u.__u)==0;if(u===null&&s==null||f&&s==u.key&&d==u.type)return i;if(o>(f?1:0)){for(r=i-1,a=i+1;r>=0||a<n.length;)if((u=n[l=r>=0?r--:a++])!=null&&(2&u.__u)==0&&s==u.key&&d==u.type)return l}return-1}function di(e,n,i){n[0]=="-"?e.setProperty(n,i??""):e[n]=i==null?"":typeof i!="number"||wo.test(n)?i:i+"px"}function Ut(e,n,i,o,r){var a,l;e:if(n=="style")if(typeof i=="string")e.style.cssText=i;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(n in o)i&&n in i||di(e.style,n,"");if(i)for(n in i)o&&i[n]==o[n]||di(e.style,n,i[n])}else if(n[0]=="o"&&n[1]=="n")a=n!=(n=n.replace(Ni,"$1")),l=n.toLowerCase(),n=l in e||n=="onFocusOut"||n=="onFocusIn"?l.slice(2):n.slice(2),e.l||(e.l={}),e.l[n+a]=i,i?o?i.u=o.u:(i.u=Yn,e.addEventListener(n,a?Nn:Fn,a)):e.removeEventListener(n,a?Nn:Fn,a);else{if(r=="http://www.w3.org/2000/svg")n=n.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(n!="width"&&n!="height"&&n!="href"&&n!="list"&&n!="form"&&n!="tabIndex"&&n!="download"&&n!="rowSpan"&&n!="colSpan"&&n!="role"&&n!="popover"&&n in e)try{e[n]=i??"";break e}catch{}typeof i=="function"||(i==null||i===!1&&n[4]!="-"?e.removeAttribute(n):e.setAttribute(n,n=="popover"&&i==1?"":i))}}function ui(e){return function(n){if(this.l){var i=this.l[n.type+e];if(n.t==null)n.t=Yn++;else if(n.t<i.u)return;return i(M.event?M.event(n):n)}}}function qn(e,n,i,o,r,a,l,s,d,u){var f,p,h,c,g,y,v,x,b,w,C,$,A,j,ue,pe,te,U=n.type;if(n.constructor!=null)return null;128&i.__u&&(d=!!(32&i.__u),a=[s=n.__e=i.__e]),(f=M.__b)&&f(n);e:if(typeof U=="function")try{if(x=n.props,b="prototype"in U&&U.prototype.render,w=(f=U.contextType)&&o[f.__c],C=f?w?w.props.value:f.__:o,i.__c?v=(p=n.__c=i.__c).__=p.__E:(b?n.__c=p=new U(x,C):(n.__c=p=new yt(x,C),p.constructor=U,p.render=$o),w&&w.sub(p),p.state||(p.state={}),p.__n=o,h=p.__d=!0,p.__h=[],p._sb=[]),b&&p.__s==null&&(p.__s=p.state),b&&U.getDerivedStateFromProps!=null&&(p.__s==p.state&&(p.__s=ye({},p.__s)),ye(p.__s,U.getDerivedStateFromProps(x,p.__s))),c=p.props,g=p.state,p.__v=n,h)b&&U.getDerivedStateFromProps==null&&p.componentWillMount!=null&&p.componentWillMount(),b&&p.componentDidMount!=null&&p.__h.push(p.componentDidMount);else{if(b&&U.getDerivedStateFromProps==null&&x!==c&&p.componentWillReceiveProps!=null&&p.componentWillReceiveProps(x,C),n.__v==i.__v||!p.__e&&p.shouldComponentUpdate!=null&&p.shouldComponentUpdate(x,p.__s,C)===!1){for(n.__v!=i.__v&&(p.props=x,p.state=p.__s,p.__d=!1),n.__e=i.__e,n.__k=i.__k,n.__k.some(function(he){he&&(he.__=n)}),$=0;$<p._sb.length;$++)p.__h.push(p._sb[$]);p._sb=[],p.__h.length&&l.push(p);break e}p.componentWillUpdate!=null&&p.componentWillUpdate(x,p.__s,C),b&&p.componentDidUpdate!=null&&p.__h.push(function(){p.componentDidUpdate(c,g,y)})}if(p.context=C,p.props=x,p.__P=e,p.__e=!1,A=M.__r,j=0,b){for(p.state=p.__s,p.__d=!1,A&&A(n),f=p.render(p.props,p.state,p.context),ue=0;ue<p._sb.length;ue++)p.__h.push(p._sb[ue]);p._sb=[]}else do p.__d=!1,A&&A(n),f=p.render(p.props,p.state,p.context),p.state=p.__s;while(p.__d&&++j<25);p.state=p.__s,p.getChildContext!=null&&(o=ye(ye({},o),p.getChildContext())),b&&!h&&p.getSnapshotBeforeUpdate!=null&&(y=p.getSnapshotBeforeUpdate(c,g)),pe=f,f!=null&&f.type===D&&f.key==null&&(pe=Hi(f.props.children)),s=Oi(e,mn(pe)?pe:[pe],n,i,o,r,a,l,s,d,u),p.base=n.__e,n.__u&=-161,p.__h.length&&l.push(p),v&&(p.__E=p.__=null)}catch(he){if(n.__v=null,d||a!=null)if(he.then){for(n.__u|=d?160:128;s&&s.nodeType==8&&s.nextSibling;)s=s.nextSibling;a[a.indexOf(s)]=null,n.__e=s}else{for(te=a.length;te--;)Kn(a[te]);Ln(n)}else n.__e=i.__e,n.__k=i.__k,he.then||Ln(n);M.__e(he,n,i)}else a==null&&n.__v==i.__v?(n.__k=i.__k,n.__e=i.__e):s=n.__e=So(i.__e,n,i,o,r,a,l,d,u);return(f=M.diffed)&&f(n),128&n.__u?void 0:s}function Ln(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Ln)}function Wi(e,n,i){for(var o=0;o<i.length;o++)Jn(i[o],i[++o],i[++o]);M.__c&&M.__c(n,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(a){a.call(r)})}catch(a){M.__e(a,r.__v)}})}function Hi(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:mn(e)?e.map(Hi):ye({},e)}function So(e,n,i,o,r,a,l,s,d){var u,f,p,h,c,g,y,v=i.props||kt,x=n.props,b=n.type;if(b=="svg"?r="http://www.w3.org/2000/svg":b=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),a!=null){for(u=0;u<a.length;u++)if((c=a[u])&&"setAttribute"in c==!!b&&(b?c.localName==b:c.nodeType==3)){e=c,a[u]=null;break}}if(e==null){if(b==null)return document.createTextNode(x);e=document.createElementNS(r,b,x.is&&x),s&&(M.__m&&M.__m(n,a),s=!1),a=null}if(b==null)v===x||s&&e.data==x||(e.data=x);else{if(a=a&&gn.call(e.childNodes),!s&&a!=null)for(v={},u=0;u<e.attributes.length;u++)v[(c=e.attributes[u]).name]=c.value;for(u in v)if(c=v[u],u!="children"){if(u=="dangerouslySetInnerHTML")p=c;else if(!(u in x)){if(u=="value"&&"defaultValue"in x||u=="checked"&&"defaultChecked"in x)continue;Ut(e,u,null,c,r)}}for(u in x)c=x[u],u=="children"?h=c:u=="dangerouslySetInnerHTML"?f=c:u=="value"?g=c:u=="checked"?y=c:s&&typeof c!="function"||v[u]===c||Ut(e,u,c,v[u],r);if(f)s||p&&(f.__html==p.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),n.__k=[];else if(p&&(e.innerHTML=""),Oi(n.type=="template"?e.content:e,mn(h)?h:[h],n,i,o,b=="foreignObject"?"http://www.w3.org/1999/xhtml":r,a,l,a?a[0]:i.__k&&Qe(i,0),s,d),a!=null)for(u=a.length;u--;)Kn(a[u]);s||(u="value",b=="progress"&&g==null?e.removeAttribute("value"):g!=null&&(g!==e[u]||b=="progress"&&!g||b=="option"&&g!=v[u])&&Ut(e,u,g,v[u],r),u="checked",y!=null&&y!=e[u]&&Ut(e,u,y,v[u],r))}return e}function Jn(e,n,i){try{if(typeof e=="function"){var o=typeof e.__u=="function";o&&e.__u(),o&&n==null||(e.__u=e(n))}else e.current=n}catch(r){M.__e(r,i)}}function Ui(e,n,i){var o,r;if(M.unmount&&M.unmount(e),(o=e.ref)&&(o.current&&o.current!=e.__e||Jn(o,null,n)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(a){M.__e(a,n)}o.base=o.__P=null}if(o=e.__k)for(r=0;r<o.length;r++)o[r]&&Ui(o[r],n,i||typeof e.type!="function");i||Kn(e.__e),e.__c=e.__=e.__e=void 0}function $o(e,n,i){return this.constructor(e,i)}function zo(e,n,i){var o,r,a,l;n==document&&(n=document.documentElement),M.__&&M.__(e,n),r=(o=!1)?null:n.__k,a=[],l=[],qn(n,e=n.__k=_o(D,null,[e]),r||kt,kt,n.namespaceURI,r?null:n.firstChild?gn.call(n.childNodes):null,a,r?r.__e:n.firstChild,o,l),Wi(a,e,l)}gn=Li.slice,M={__e:function(e,n,i,o){for(var r,a,l;n=n.__;)if((r=n.__c)&&!r.__)try{if((a=r.constructor)&&a.getDerivedStateFromError!=null&&(r.setState(a.getDerivedStateFromError(e)),l=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,o||{}),l=r.__d),l)return r.__E=r}catch(s){e=s}throw e}},Ti=0,Pi=function(e){return e!=null&&e.constructor==null},yt.prototype.setState=function(e,n){var i;i=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ye({},this.state),typeof e=="function"&&(e=e(ye({},i),this.props)),e&&ye(i,e),e!=null&&this.__v&&(n&&this._sb.push(n),ci(this))},yt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ci(this))},yt.prototype.render=D,Pe=[],Ei=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Fi=function(e,n){return e.__v.__b-n.__v.__b},an.__r=0,Ni=/(PointerCapture)$|Capture$/i,Yn=0,Fn=ui(!1),Nn=ui(!0);var Ao=0;function t(e,n,i,o,r,a){n||(n={});var l,s,d=n;if("ref"in d)for(s in d={},n)s=="ref"?l=n[s]:d[s]=n[s];var u={type:e,props:d,key:i,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Ao,__i:-1,__u:0,__source:r,__self:a};if(typeof e=="function"&&(l=e.defaultProps))for(s in l)d[s]===void 0&&(d[s]=l[s]);return M.vnode&&M.vnode(u),u}var Ct,F,kn,pi,ln=0,Gi=[],N=M,hi=N.__b,fi=N.__r,gi=N.diffed,mi=N.__c,vi=N.unmount,yi=N.__;function Zn(e,n){N.__h&&N.__h(F,e,ln||n),ln=0;var i=F.__H||(F.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function fe(e){return ln=1,Io(Ki,e)}function Io(e,n,i){var o=Zn(Ct++,2);if(o.t=e,!o.__c&&(o.__=[Ki(void 0,n),function(s){var d=o.__N?o.__N[0]:o.__[0],u=o.t(d,s);d!==u&&(o.__N=[u,o.__[1]],o.__c.setState({}))}],o.__c=F,!F.__f)){var r=function(s,d,u){if(!o.__c.__H)return!0;var f=o.__c.__H.__.filter(function(h){return!!h.__c});if(f.every(function(h){return!h.__N}))return!a||a.call(this,s,d,u);var p=o.__c.props!==s;return f.forEach(function(h){if(h.__N){var c=h.__[0];h.__=h.__N,h.__N=void 0,c!==h.__[0]&&(p=!0)}}),a&&a.call(this,s,d,u)||p};F.__f=!0;var a=F.shouldComponentUpdate,l=F.componentWillUpdate;F.componentWillUpdate=function(s,d,u){if(this.__e){var f=a;a=void 0,r(s,d,u),a=f}l&&l.call(this,s,d,u)},F.shouldComponentUpdate=r}return o.__N||o.__}function B(e,n){var i=Zn(Ct++,3);!N.__s&&Yi(i.__H,n)&&(i.__=e,i.u=n,F.__H.__h.push(i))}function Mo(e){return ln=5,Vi(function(){return{current:e}},[])}function Vi(e,n){var i=Zn(Ct++,7);return Yi(i.__H,n)&&(i.__=e(),i.__H=n,i.__h=e),i.__}function Do(){for(var e;e=Gi.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(on),e.__H.__h.forEach(Bn),e.__H.__h=[]}catch(n){e.__H.__h=[],N.__e(n,e.__v)}}N.__b=function(e){F=null,hi&&hi(e)},N.__=function(e,n){e&&n.__k&&n.__k.__m&&(e.__m=n.__k.__m),yi&&yi(e,n)},N.__r=function(e){fi&&fi(e),Ct=0;var n=(F=e.__c).__H;n&&(kn===F?(n.__h=[],F.__h=[],n.__.forEach(function(i){i.__N&&(i.__=i.__N),i.u=i.__N=void 0})):(n.__h.forEach(on),n.__h.forEach(Bn),n.__h=[],Ct=0)),kn=F},N.diffed=function(e){gi&&gi(e);var n=e.__c;n&&n.__H&&(n.__H.__h.length&&(Gi.push(n)!==1&&pi===N.requestAnimationFrame||((pi=N.requestAnimationFrame)||Ro)(Do)),n.__H.__.forEach(function(i){i.u&&(i.__H=i.u),i.u=void 0})),kn=F=null},N.__c=function(e,n){n.some(function(i){try{i.__h.forEach(on),i.__h=i.__h.filter(function(o){return!o.__||Bn(o)})}catch(o){n.some(function(r){r.__h&&(r.__h=[])}),n=[],N.__e(o,i.__v)}}),mi&&mi(e,n)},N.unmount=function(e){vi&&vi(e);var n,i=e.__c;i&&i.__H&&(i.__H.__.forEach(function(o){try{on(o)}catch(r){n=r}}),i.__H=void 0,n&&N.__e(n,i.__v))};var xi=typeof requestAnimationFrame=="function";function Ro(e){var n,i=function(){clearTimeout(o),xi&&cancelAnimationFrame(n),setTimeout(e)},o=setTimeout(i,35);xi&&(n=requestAnimationFrame(i))}function on(e){var n=F,i=e.__c;typeof i=="function"&&(e.__c=void 0,i()),F=n}function Bn(e){var n=F;e.__c=e.__(),F=n}function Yi(e,n){return!e||e.length!==n.length||n.some(function(i,o){return i!==e[o]})}function Ki(e,n){return typeof n=="function"?n(e):n}var To=Symbol.for("preact-signals");function vn(){if(ze>1)ze--;else{for(var e,n=!1;xt!==void 0;){var i=xt;for(xt=void 0,On++;i!==void 0;){var o=i.o;if(i.o=void 0,i.f&=-3,!(8&i.f)&&Zi(i))try{i.c()}catch(r){n||(e=r,n=!0)}i=o}}if(On=0,ze--,n)throw e}}function Po(e){if(ze>0)return e();ze++;try{return e()}finally{vn()}}var I=void 0;function qi(e){var n=I;I=void 0;try{return e()}finally{I=n}}var xt=void 0,ze=0,On=0,sn=0;function Ji(e){if(I!==void 0){var n=e.n;if(n===void 0||n.t!==I)return n={i:0,S:e,p:I.s,n:void 0,t:I,e:void 0,x:void 0,r:n},I.s!==void 0&&(I.s.n=n),I.s=n,e.n=n,32&I.f&&e.S(n),n;if(n.i===-1)return n.i=0,n.n!==void 0&&(n.n.p=n.p,n.p!==void 0&&(n.p.n=n.n),n.p=I.s,n.n=void 0,I.s.n=n,I.s=n),n}}function W(e,n){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=n?.watched,this.Z=n?.unwatched,this.name=n?.name}W.prototype.brand=To;W.prototype.h=function(){return!0};W.prototype.S=function(e){var n=this,i=this.t;i!==e&&e.e===void 0&&(e.x=i,this.t=e,i!==void 0?i.e=e:qi(function(){var o;(o=n.W)==null||o.call(n)}))};W.prototype.U=function(e){var n=this;if(this.t!==void 0){var i=e.e,o=e.x;i!==void 0&&(i.x=o,e.e=void 0),o!==void 0&&(o.e=i,e.x=void 0),e===this.t&&(this.t=o,o===void 0&&qi(function(){var r;(r=n.Z)==null||r.call(n)}))}};W.prototype.subscribe=function(e){var n=this;return de(function(){var i=n.value,o=I;I=void 0;try{e(i)}finally{I=o}},{name:"sub"})};W.prototype.valueOf=function(){return this.value};W.prototype.toString=function(){return this.value+""};W.prototype.toJSON=function(){return this.value};W.prototype.peek=function(){var e=I;I=void 0;try{return this.value}finally{I=e}};Object.defineProperty(W.prototype,"value",{get:function(){var e=Ji(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(On>100)throw new Error("Cycle detected");this.v=e,this.i++,sn++,ze++;try{for(var n=this.t;n!==void 0;n=n.x)n.t.N()}finally{vn()}}}});function m(e,n){return new W(e,n)}function Zi(e){for(var n=e.s;n!==void 0;n=n.n)if(n.S.i!==n.i||!n.S.h()||n.S.i!==n.i)return!0;return!1}function Qi(e){for(var n=e.s;n!==void 0;n=n.n){var i=n.S.n;if(i!==void 0&&(n.r=i),n.S.n=n,n.i=-1,n.n===void 0){e.s=n;break}}}function Xi(e){for(var n=e.s,i=void 0;n!==void 0;){var o=n.p;n.i===-1?(n.S.U(n),o!==void 0&&(o.n=n.n),n.n!==void 0&&(n.n.p=o)):i=n,n.S.n=n.r,n.r!==void 0&&(n.r=void 0),n=o}e.s=i}function Ne(e,n){W.call(this,void 0),this.x=e,this.s=void 0,this.g=sn-1,this.f=4,this.W=n?.watched,this.Z=n?.unwatched,this.name=n?.name}Ne.prototype=new W;Ne.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===sn))return!0;if(this.g=sn,this.f|=1,this.i>0&&!Zi(this))return this.f&=-2,!0;var e=I;try{Qi(this),I=this;var n=this.x();(16&this.f||this.v!==n||this.i===0)&&(this.v=n,this.f&=-17,this.i++)}catch(i){this.v=i,this.f|=16,this.i++}return I=e,Xi(this),this.f&=-2,!0};Ne.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var n=this.s;n!==void 0;n=n.n)n.S.S(n)}W.prototype.S.call(this,e)};Ne.prototype.U=function(e){if(this.t!==void 0&&(W.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var n=this.s;n!==void 0;n=n.n)n.S.U(n)}};Ne.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};Object.defineProperty(Ne.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=Ji(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function Xe(e,n){return new Ne(e,n)}function eo(e){var n=e.u;if(e.u=void 0,typeof n=="function"){ze++;var i=I;I=void 0;try{n()}catch(o){throw e.f&=-2,e.f|=8,Qn(e),o}finally{I=i,vn()}}}function Qn(e){for(var n=e.s;n!==void 0;n=n.n)n.S.U(n);e.x=void 0,e.s=void 0,eo(e)}function Eo(e){if(I!==this)throw new Error("Out-of-order effect");Xi(this),I=e,this.f&=-2,8&this.f&&Qn(this),vn()}function ot(e,n){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=n?.name}ot.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var n=this.x();typeof n=="function"&&(this.u=n)}finally{e()}};ot.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,eo(this),Qi(this),ze++;var e=I;return I=this,Eo.bind(this,e)};ot.prototype.N=function(){2&this.f||(this.f|=2,this.o=xt,xt=this)};ot.prototype.d=function(){this.f|=8,1&this.f||Qn(this)};ot.prototype.dispose=function(){this.d()};function de(e,n){var i=new ot(e,n);try{i.c()}catch(r){throw i.d(),r}var o=i.d.bind(i);return o[Symbol.dispose]=o,o}var to,Cn,yn=typeof window<"u"&&!!window.__PREACT_SIGNALS_DEVTOOLS__,no=[];de(function(){to=this.N})();function rt(e,n){M[e]=n.bind(null,M[e]||function(){})}function cn(e){Cn&&Cn(),Cn=e&&e.S()}function io(e){var n=this,i=e.data,o=No(i);o.value=i;var r=Vi(function(){for(var s=n,d=n.__v;d=d.__;)if(d.__c){d.__c.__$f|=4;break}var u=Xe(function(){var c=o.value.value;return c===0?0:c===!0?"":c||""}),f=Xe(function(){return!Array.isArray(u.value)&&!Pi(u.value)}),p=de(function(){if(this.N=oo,f.value){var c=u.value;s.__v&&s.__v.__e&&s.__v.__e.nodeType===3&&(s.__v.__e.data=c)}}),h=n.__$u.d;return n.__$u.d=function(){p(),h.call(this)},[f,u]},[]),a=r[0],l=r[1];return a.value?l.peek():l.value}io.displayName="ReactiveTextNode";Object.defineProperties(W.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:io},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});rt("__b",function(e,n){if(yn&&typeof n.type=="function"&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),typeof n.type=="string"){var i,o=n.props;for(var r in o)if(r!=="children"){var a=o[r];a instanceof W&&(i||(n.__np=i={}),i[r]=a,o[r]=a.peek())}}e(n)});rt("__r",function(e,n){if(yn&&typeof n.type=="function"&&window.__PREACT_SIGNALS_DEVTOOLS__.enterComponent(n),n.type!==D){cn();var i,o=n.__c;o&&(o.__$f&=-2,(i=o.__$u)===void 0&&(o.__$u=i=(function(r){var a;return de(function(){a=this}),a.c=function(){o.__$f|=1,o.setState({})},a})())),cn(i)}e(n)});rt("__e",function(e,n,i,o){yn&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),cn(),e(n,i,o)});rt("diffed",function(e,n){yn&&typeof n.type=="function"&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),cn();var i;if(typeof n.type=="string"&&(i=n.__e)){var o=n.__np,r=n.props;if(o){var a=i.U;if(a)for(var l in a){var s=a[l];s!==void 0&&!(l in o)&&(s.d(),a[l]=void 0)}else a={},i.U=a;for(var d in o){var u=a[d],f=o[d];u===void 0?(u=Fo(i,d,f,r),a[d]=u):u.o(f,r)}}}e(n)});function Fo(e,n,i,o){var r=n in e&&e.ownerSVGElement===void 0,a=m(i);return{o:function(l,s){a.value=l,o=s},d:de(function(){this.N=oo;var l=a.value.value;o[n]!==l&&(o[n]=l,r?e[n]=l:l!=null&&(l!==!1||n[4]==="-")?e.setAttribute(n,l):e.removeAttribute(n))})}}rt("unmount",function(e,n){if(typeof n.type=="string"){var i=n.__e;if(i){var o=i.U;if(o){i.U=void 0;for(var r in o){var a=o[r];a&&a.d()}}}}else{var l=n.__c;if(l){var s=l.__$u;s&&(l.__$u=void 0,s.d())}}e(n)});rt("__h",function(e,n,i,o){(o<3||o===9)&&(n.__$f|=2),e(n,i,o)});yt.prototype.shouldComponentUpdate=function(e,n){var i=this.__$u,o=i&&i.s!==void 0;for(var r in n)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var a=2&this.__$f;if(!(o||a||4&this.__$f)||1&this.__$f)return!0}else if(!(o||4&this.__$f)||3&this.__$f)return!0;for(var l in e)if(l!=="__source"&&e[l]!==this.props[l])return!0;for(var s in this.props)if(!(s in e))return!0;return!1};function No(e,n){return fe(function(){return m(e,n)})[0]}var Lo=function(e){queueMicrotask(function(){queueMicrotask(e)})};function Bo(){Po(function(){for(var e;e=no.shift();)to.call(e)})}function oo(){no.push(this)===1&&(M.requestAnimationFrame||Lo)(Bo)}const Oo={apiKey:"AIzaSyCr-Ej5jeuV3kdvquu2W_R0ffSrUW0OUcQ",authDomain:"tennis-coordinator-43f53.firebaseapp.com",databaseURL:"https://tennis-coordinator-43f53-default-rtdb.firebaseio.com",projectId:"tennis-coordinator-43f53",storageBucket:"tennis-coordinator-43f53.firebasestorage.app",messagingSenderId:"665148711646",appId:"1:665148711646:web:66d14722800a12f5a3184f",measurementId:"G-J0KVB2Q93W"};let Ue=null;function ro(){if(Ue)return Ue;try{return window.firebase.initializeApp(Oo),Ue=window.firebase.database(),console.log("Firebase initialized successfully"),Ue}catch(e){throw console.error("Firebase initialization error:",e),e}}function T(){return Ue||ro()}function jo(){return t("div",{class:"landing-page",children:t("div",{class:"landing-container",children:[t("h1",{children:"ðŸŽ¾ Tennis Coordinator"}),t("p",{class:"landing-tagline",children:"Turn your love for tennis into more games."}),t("p",{class:"landing-subtitle",children:"A simple tool that helps tennis groups self-organize matches with minimal frictionâ€”so you spend less time coordinating and more time on the court."}),t("div",{class:"landing-section",children:[t("h2",{children:"Why It Works"}),t("div",{class:"landing-features",children:[t("div",{class:"feature-item",children:[t("span",{class:"feature-icon",children:"â™¦"}),t("div",{children:[t("strong",{children:"Frictionless"}),t("span",{children:"Check in with a few taps. No accounts, no apps to download."})]})]}),t("div",{class:"feature-item",children:[t("span",{class:"feature-icon",children:"â™¦"}),t("div",{children:[t("strong",{children:"Flexible"}),t("span",{children:"Handles doubles, singles, odd numbers, guests, and preferences."})]})]}),t("div",{class:"feature-item",children:[t("span",{class:"feature-icon",children:"â™¦"}),t("div",{children:[t("strong",{children:"Adaptable"}),t("span",{children:"Works for tight-knit groups of 20 or club communities of 50+."})]})]}),t("div",{class:"feature-item",children:[t("span",{class:"feature-icon",children:"â™¦"}),t("div",{children:[t("strong",{children:"Real-Time"}),t("span",{children:"Everyone sees who's playing instantly."})]})]})]})]}),t("div",{class:"landing-section landing-section-alt",children:[t("h2",{children:"How It Works"}),t("div",{class:"landing-steps",children:[t("div",{class:"step-item",children:[t("span",{class:"step-number",children:"1"}),t("div",{children:[t("strong",{children:"Check In"}),t("span",{children:"Select your name, play style, and when you're available"})]})]}),t("div",{class:"step-item",children:[t("span",{class:"step-number",children:"2"}),t("div",{children:[t("strong",{children:"Auto-Match"}),t("span",{children:"System organizes matches based on who's playing"})]})]}),t("div",{class:"step-item",children:[t("span",{class:"step-number",children:"3"}),t("div",{children:[t("strong",{children:"Play"}),t("span",{children:"Show up and enjoy the game"})]})]})]})]}),t("div",{class:"landing-cta",children:t("p",{children:"To access your tennis group, visit your group's unique URL or contact your group admin for the link."})}),t("div",{class:"landing-footer",children:t("a",{href:"#admin",class:"admin-link",onClick:e=>{e.preventDefault(),window.location.hash="admin",window.location.reload()},children:"Site Administrator? Access Site Admin â†’"})})]})})}function jn(e){return e.toLowerCase().trim().replace(/\s+/g," ")}function Gt(e){if(!e)return"";const[n,i]=e.split(":"),o=parseInt(n),r=o>=12?"PM":"AM";return`${o%12||12}:${i}${r}`}function re(e,n){return!e&&!n?"":e&&n?`${Gt(e)}-${Gt(n)}`:e?`from ${Gt(e)}`:n?`until ${Gt(n)}`:""}function G(e){return new Date(e+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}function bi(e){return new Date(e+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}function ao(e){const n=new Date(e),i=new Date,o=n.toDateString()===i.toDateString(),r=n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"});return o?r:`${n.toLocaleDateString("en-US",{month:"short",day:"numeric"})} ${r}`}function Wn(e){const n=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return`${n}-${i}-${o}`}function Wo(){return Wn(new Date)}function Ho(e,n){let i=null;return function(...o){i&&clearTimeout(i),i=setTimeout(()=>{e.apply(this,o)},n)}}function wi(e,n){return n[jn(e)]||{include:[],exclude:[]}}function Uo(e,n,i){const o=wi(e,i),r=wi(n,i),a=jn(e),l=jn(n);return!o.exclude.includes(l)&&!r.exclude.includes(a)}function Go(e,n){if(!e||!n||!e.start&&!e.end&&!n.start&&!n.end)return!0;const i=c=>{if(!c)return null;const[g,y]=c.split(":").map(Number);return g*60+y},o=i(e.start),r=i(e.end),a=i(n.start),l=i(n.end),s=360,d=1260,u=o??s,f=r??d,p=a??s;return u<(l??d)&&p<f}function lt(e,n,i){return Uo(e.name,n.name,i)?Go(e.timeRange,n.timeRange):!1}function xn(e,n={}){const i=[],o=[];let r=e.map((h,c)=>({...h,originalIndex:c}));r.sort((h,c)=>h.timestamp-c.timestamp);const a=r.filter(h=>h.playStyle==="doubles"),l=r.filter(h=>h.playStyle==="singles"),s=r.filter(h=>h.playStyle==="both"||!h.playStyle);let d=[...a,...s].sort((h,c)=>h.timestamp-c.timestamp);for(;d.length>=4;){const h=d.slice(0,4);i.push({type:"doubles",number:i.filter(c=>c.type==="doubles").length+1,players:h}),d.splice(0,4)}let u=[...l].sort((h,c)=>h.timestamp-c.timestamp);for(;u.length>=2;){let h=null;for(let c=0;c<u.length-1;c++){for(let g=c+1;g<u.length;g++)if(lt(u[c],u[g],n)){h=[u[c],u[g]];break}if(h)break}if(h)i.push({type:"singles",players:h}),h.forEach(c=>{const g=u.findIndex(y=>y.originalIndex===c.originalIndex);g>-1&&u.splice(g,1)});else break}const f=d,p=u;if(f.length>0){const h=4-f.length,c=f.filter(w=>w.playStyle==="both"||!w.playStyle),g=c.length,y=f.every(w=>w.playStyle==="both"||!w.playStyle),v=f.every(w=>w.allowRotation!==!1),x=f.length===3&&lt(f[0],f[1],n)&&lt(f[0],f[2],n)&&lt(f[1],f[2],n);let b=!1;g>=2&&(b=lt(c[0],c[1],n)),i.push({type:"doubles-forming",players:f,needed:h,canRotate:f.length===3&&y&&v&&x,eitherCount:g,canPlaySingles:b})}return p.length>0&&p.forEach(h=>{i.push({type:"singles-forming",players:[h],needed:1})}),{matches:i,warnings:o}}const E=m({groupPin:"",adminPin:""}),V=m({}),_i={};function O(e){return T().ref(e)}function Vo(){B(()=>{const e=de(()=>{const n=S.value;if(!n||n==="admin")return;O(`groups/${n}/settings`).once("value").then(o=>{const r=o.val()||{};H.value=r.groupName||"Unknown Group",Y.value=r.members||[],L.value=r.memberDetails||{};const a=r.renamedMembers||{};if(k.value&&a[k.value]){const l=a[k.value];k.value=l,localStorage.setItem(`sessionUser_${n}`,l)}E.value={groupPin:r.groupPin||"",adminPin:r.adminPin||"",shortCode:r.shortCode,location:r.location,groupDescription:r.groupDescription,groupRules:r.groupRules},document.title=`${r.groupName||"Tennis"} - Tennis Coordinator`}).catch(o=>{console.error("Error loading group settings:",o),_("Failed to load group data","error")})});return()=>{e()}},[])}function Yo(){B(()=>{let e=null,n=null;const i=de(()=>{const o=S.value;e&&n&&e.off("value",n),!(!o||o==="admin")&&(e=O(`groups/${o}/checkins`),n=e.on("value",r=>{const a=r.val()||{};Q.value=a}))});return()=>{i(),e&&n&&e.off("value",n)}},[])}function Ko(){B(()=>{let e=null,n=null;const i=de(()=>{const o=S.value,r=R.value;if(e&&n&&e.off("value",n),!o||o==="admin"||!r){V.value={};return}e=O(`groups/${o}/matchNotes/${r}`),n=e.on("value",a=>{V.value=a.val()||{}})});return()=>{i(),e&&n&&e.off("value",n)}},[])}function z(e){return e.toLowerCase().replace(/\s+/g,"")}async function qo(e){const n=S.value,i=R.value;if(!n||!i)return;const o=O(`groups/${n}/checkins/${i}`),r=Q.value[i]||[],a=z(e.name);if(r.some(d=>d.name&&z(d.name)===a)){_(`${e.name} is already checked in for this date!`,"error");return}const s={name:e.name,playStyle:e.playStyle,isGuest:e.isGuest,addedBy:e.addedBy,allowRotation:e.allowRotation,timestamp:Date.now()};e.timeRange&&(s.timeRange=e.timeRange);try{await o.set([...r,s]),await ce(n,i,"checkin",e.name,e.addedBy),await nr(n,e.name,i,e.addedBy,{playStyle:e.playStyle,timeRange:e.timeRange,allowRotation:e.allowRotation}),setTimeout(()=>lo(n,i),500)}catch(d){console.error("Error adding check-in:",d),_("Failed to check in","error")}}async function Jo(e,n,i){const o=S.value,r=R.value;if(!o||!r)return;const a=Q.value[r]||[],l=a[e];if(!l)return;const s=l.name||"this person",d=i&&z(i)===z(s),u=l.addedBy&&i&&z(i)===z(l.addedBy),f=sessionStorage.getItem(`adminAuth_${o}`)==="true";if(!d&&!u&&!f){_("You can only edit check-ins you added","error");return}const p=O(`groups/${o}/checkins/${r}`),h=[...a];h[e]={...h[e],...n};try{await p.set(h),_(`${s}'s preferences updated`,"success")}catch(c){console.error("Error updating check-in:",c),_("Failed to update check-in","error")}}async function Zo(e,n,i){const o=P.value;if(!o||!o.matches)return;const r={};for(const[s,d]of Object.entries(o.matches)){const u=(d.players||[]).filter(f=>z(f)!==z(i));u.length>0&&(r[s]={...d,players:u})}const a=(o.unassigned||[]).filter(s=>z(s)!==z(i));if(Object.keys(r).length===0&&a.length===0){try{await O(`groups/${e}/matchArrangements/${n}`).remove(),P.value=null}catch(s){console.error("Error clearing arrangement after removal:",s)}return}const l={...o,matches:r,unassigned:a};try{await O(`groups/${e}/matchArrangements/${n}`).set(l),P.value=l}catch(s){console.error("Error updating arrangement after removal:",s)}}function Qo(e,n){const i=S.value,o=R.value;if(!i||!o)return null;const a=(Q.value[o]||[])[e],l=a?.name||"this person",s=!!(n&&z(n)===z(l)),d=!!(a?.addedBy&&n&&z(n)===z(a.addedBy)),u=sessionStorage.getItem(`adminAuth_${i}`)==="true";return!s&&!d&&!u?(_("You can only remove check-ins you added","error"),null):{personName:l,isOwner:s}}async function Xo(e,n){const i=S.value,o=R.value;if(!i||!o)return;const r=Q.value[o]||[],l=r[e]?.name||"this person",s=n&&z(n)===z(l),d=O(`groups/${i}/checkins/${o}`),u=r.filter((f,p)=>p!==e);try{await d.set(u.length>0?u:null),P.value&&l&&await Zo(i,o,l),s&&n&&(ve.value=n,X.value=!0),await ce(i,o,"removal",l,n),await er(i,l,o,n),setTimeout(()=>lo(i,o),500)}catch(f){console.error("Error removing check-in:",f),_("Failed to remove check-in","error")}}async function ce(e,n,i,o,r,a={}){const l={timestamp:Date.now(),action:i,player:o,by:r||o,...a};Object.keys(l).forEach(s=>{l[s]===void 0&&delete l[s]});try{await T().ref(`groups/${e}/activity/${n}`).push(l)}catch(s){console.error("Error logging activity:",s)}}async function er(e,n,i,o){const a=z(n)===z(o)?`ðŸŽ¾ ${n} removed themselves from ${i}`:`ðŸŽ¾ ${n} was removed from ${i} by ${o}`;try{const l=T(),d=(await l.ref(`groups/${e}/userNotifications`).once("value")).val()||{};for(const[u,f]of Object.entries(d)){const p=f.preferences||{};if(p.activityAlerts){if(u===z(o))continue;const h=p.unwatchedMembers||p.mutedMembers||[];if(h.includes(n)||h.includes(o))continue;await l.ref(`groups/${e}/userNotifications/${u}/items`).push().set({message:a,timestamp:Date.now(),read:!1,date:i})}}}catch(l){console.error("Error sending removal notifications:",l)}}function tr(e){switch(e){case"singles":return"Singles";case"doubles":return"Doubles";default:return"Either"}}async function nr(e,n,i,o,r){const a=z(n)===z(o),l=[];if(r.playStyle&&l.push(tr(r.playStyle)),r.timeRange){const u=re(r.timeRange.start,r.timeRange.end);u&&l.push(u)}r.playStyle==="singles"&&r.allowRotation===!1&&l.push("No 3s");const s=l.length>0?` (${l.join(", ")})`:"",d=a?`ðŸŽ¾ ${n} checked in for ${i}${s}`:`ðŸŽ¾ ${n} was added for ${i} by ${o}${s}`;console.log("[notifyCheckinAlert] Starting notification for:",{playerName:n,date:i,addedBy:o});try{const u=T(),p=(await u.ref(`groups/${e}/userNotifications`).once("value")).val()||{};console.log("[notifyCheckinAlert] Found userNotifications entries:",Object.keys(p));for(const[h,c]of Object.entries(p)){const g=c.preferences||{};if(console.log(`[notifyCheckinAlert] User ${h}:`,{activityAlerts:g.activityAlerts,unwatchedMembers:g.unwatchedMembers||g.mutedMembers}),g.activityAlerts){if(h===z(o)){console.log(`[notifyCheckinAlert] Skipping ${h} - is addedBy`);continue}if(h===z(n)){console.log(`[notifyCheckinAlert] Skipping ${h} - is player`);continue}const y=g.unwatchedMembers||g.mutedMembers||[];if(y.includes(n)||y.includes(o)){console.log(`[notifyCheckinAlert] Skipping ${h} - player/adder is unwatched`);continue}console.log(`[notifyCheckinAlert] Sending notification to ${h}`),await u.ref(`groups/${e}/userNotifications/${h}/items`).push().set({message:d,timestamp:Date.now(),read:!1,date:i}),console.log(`[notifyCheckinAlert] Notification sent to ${h}`)}}}catch(u){console.error("Error sending check-in notifications:",u)}}async function lo(e,n){const i=Q.value[n]||[];if(i.length===0)return;const{matches:o}=xn(i),r={};o.forEach(l=>{if(l.type==="doubles"||l.type==="singles"){const s=l.players.map(d=>z(d.name)).sort().join(",");r[s]={type:l.type,players:l.players.map(d=>d.name)}}});const a=_i[n]||{};for(const[l,s]of Object.entries(r))if(!a[l]){const d=bi(n),u=s.type==="doubles"?"Doubles":"Singles";for(const f of s.players){const p=s.players.filter(c=>z(c)!==z(f)),h=`âœ… You're in ${u} for ${d} with ${p.join(", ")}`;try{const c=T();((await c.ref(`groups/${e}/userNotifications/${z(f)}/preferences`).once("value")).val()||{}).matchConfirmations!==!1&&(await c.ref(`groups/${e}/userNotifications/${z(f)}/items`).push().set({message:h,timestamp:Date.now(),read:!1,date:n,type:"match_formed",matchType:u}),console.log(`[checkAndNotifyMatchFormations] Sent notification to ${f}`))}catch(c){console.error(`Error sending match notification to ${f}:`,c)}}}for(const[l,s]of Object.entries(a))if(!r[l]){const d=bi(n),u=s.type==="doubles"?"Doubles":"Singles",f=i.map(c=>z(c.name)),p=s.players.filter(c=>f.includes(z(c))),h=s.players.filter(c=>!f.includes(z(c)));if(h.length>0&&p.length>0){const c=h.join(", "),g=u==="Doubles"?4-p.length:2-p.length,y=g===1?"Need 1 more player":`Need ${g} more players`,v=`âš ï¸ Your ${u} for ${d} is no longer confirmed - ${c} dropped out. ${y}.`;for(const x of p)try{const b=T();((await b.ref(`groups/${e}/userNotifications/${z(x)}/preferences`).once("value")).val()||{}).matchConfirmations!==!1&&(await b.ref(`groups/${e}/userNotifications/${z(x)}/items`).push().set({message:v,timestamp:Date.now(),read:!1,date:n,type:"match_dissolved",matchType:u}),console.log(`[checkAndNotifyMatchFormations] Sent dissolved notification to ${x}`))}catch(b){console.error(`Error sending dissolved match notification to ${x}:`,b)}}}_i[n]=r}async function Sn(e,n,i,o,r,a){const l=o.replace(/-/g," ").replace(/\b\w/g,d=>d.toUpperCase()).replace("Forming 1","(forming)");let s;if(r==="added"){const d=a&&a.length>30?a.substring(0,30)+"...":a;s=`ðŸ“ ${i} added note to ${l}: "${d}"`}else if(r==="updated"){const d=a&&a.length>30?a.substring(0,30)+"...":a;s=`ðŸ“ ${i} updated note on ${l}: "${d}"`}else s=`ðŸ“ ${i} removed note from ${l}`;try{const d=T(),f=(await d.ref(`groups/${e}/userNotifications`).once("value")).val()||{};for(const[p,h]of Object.entries(f)){const c=h.preferences||{};if(c.activityAlerts){if(p===z(i)||(c.unwatchedMembers||c.mutedMembers||[]).includes(i))continue;await d.ref(`groups/${e}/userNotifications/${p}/items`).push().set({message:s,timestamp:Date.now(),read:!1,date:n})}}}catch(d){console.error("Error sending note notifications:",d)}}async function ir(){const e=S.value,n=R.value;if(!(!e||!n))try{await O(`groups/${e}/checkins/${n}`).remove(),await O(`groups/${e}/matchNotes/${n}`).remove(),_("Day reset","success")}catch(i){console.error("Error resetting day:",i),_("Failed to reset day","error")}}const Vt={};async function or(e,n){const i=S.value,o=R.value;if(!(!i||!o))try{const r=`${i}:${o}:${e}`,a=Vt[r]??V.value[e]??"",l=k.value||"Unknown";await O(`groups/${i}/matchNotes/${o}/${e}`).set(n||null),n&&!a?(await ce(i,o,"note_added",l,l,{matchKey:e,noteContent:n}),await Sn(i,o,l,e,"added",n),Vt[r]=n,_("Note added","success")):n&&a&&n!==a?(await ce(i,o,"note_updated",l,l,{matchKey:e,noteContent:n,previousNote:a}),await Sn(i,o,l,e,"updated",n),Vt[r]=n,_("Note updated","success")):!n&&a&&(await ce(i,o,"note_removed",l,l,{matchKey:e,previousNote:a}),await Sn(i,o,l,e,"removed"),delete Vt[r],_("Note removed","info"))}catch(r){console.error("Error saving match note:",r),_("Failed to save note","error")}}async function so(e){const n=S.value;if(!n)return;const i=O(`groups/${n}/settings`);try{const r=(await i.once("value")).val()||{},a=r.members||[],l=r.memberDetails||{};if(a.includes(e.name)){_("Member already exists","error");return}const s=[...a,e.name].sort(),d={...l,[e.name]:{addedBy:e.addedBy,addedDate:new Date().toISOString(),phone:e.phone||"",email:e.email||"",notes:e.notes||""}};await i.update({members:s,memberDetails:d}),Y.value=s,L.value=d;const u=R.value||new Date().toISOString().split("T")[0];await ce(n,u,"member_added",e.name,e.addedBy,{contact:e.phone||e.email||void 0,notes:e.notes||void 0});const f=`${window.location.origin}${window.location.pathname}?group=${n}`;me.value={action:"invite",name:e.name,date:u,groupName:H.value||"Tennis Group",groupUrl:f,groupPin:E.value.groupPin||""},oe.value=!0}catch(o){console.error("Error adding member:",o),_("Failed to add member","error")}}async function rr(e){const n=S.value;if(!n)return;const i=O(`groups/${n}/settings`);try{const r=(await i.once("value")).val()||{},a=r.members||[],l=r.memberDetails||{},s=a.filter(p=>p!==e),d={...l};delete d[e],await i.update({members:s,memberDetails:d}),Y.value=s,L.value=d;const u=R.value||new Date().toISOString().split("T")[0],f=k.value||"Admin";await ce(n,u,"member_removed",e,f),_(`${e} removed from members`,"info")}catch(o){console.error("Error removing member:",o),_("Failed to remove member","error")}}async function ki(e,n){const i=S.value;if(!i)return!1;const o=O(`groups/${i}/settings`);try{const l=((await o.once("value")).val()||{}).memberDetails||{},s=l[e]||{},d={...l,[e]:{...s,phone:n.phone??s.phone??"",email:n.email??s.email??"",notes:n.notes??s.notes??""}};return await o.update({memberDetails:d}),L.value=d,_("Profile updated","success"),!0}catch(r){return console.error("Error updating member details:",r),_("Failed to update profile","error"),!1}}async function co(e,n){const i=S.value;if(!i)return!1;const o=n.trim();if(!o)return _("Name cannot be empty","error"),!1;if(o===e)return!0;const r=O(`groups/${i}/settings`);try{const l=(await r.once("value")).val()||{},s=l.members||[],d=l.memberDetails||{};if(s.some(b=>b.toLowerCase()===o.toLowerCase()&&b!==e))return _("A member with this name already exists","error"),!1;const u=s.map(b=>b===e?o:b).sort(),f={...d};f[e]&&(f[o]=f[e],delete f[e]);const h={...l.renamedMembers||{},[e]:o};await r.update({members:u,memberDetails:f,renamedMembers:h}),Y.value=u,L.value=f,k.value===e&&(k.value=o,localStorage.setItem(`sessionUser_${i}`,o));const c=T(),y=(await c.ref(`groups/${i}/checkins`).once("value")).val()||{};for(const[b,w]of Object.entries(y))if(w&&typeof w=="object"){const C=Object.values(w);let $=!1;const A=C.map(j=>j&&j.name===e?($=!0,{...j,name:o}):j);$&&await c.ref(`groups/${i}/checkins/${b}`).set(A)}const v=R.value||new Date().toISOString().split("T")[0],x=k.value||"Admin";return await ce(i,v,"member_renamed",o,x,{oldName:e}),_(`${e} renamed to ${o}`,"success"),!0}catch(a){return console.error("Error renaming member:",a),_("Failed to rename member","error"),!1}}const P=m(null);async function ar(e){const n=S.value,i=R.value;if(!n||!i)return;const o=k.value||"Admin",r={...e,arrangedBy:o,arrangedAt:Date.now()};try{await O(`groups/${n}/matchArrangements/${i}`).set(r),P.value=r;const a=Object.keys(e.matches).length,l=Object.values(e.matches).reduce((f,p)=>f+(p.players?.length||0),0)+(e.unassigned?.length||0),s=[],d=Object.keys(e.matches).sort();for(const f of d){const h=e.matches[f]?.players||[];if(h.length>0){const c=f.replace("-"," ").replace(/\b\w/g,y=>y.toUpperCase()),g=f.startsWith("singles")&&h.length===2?`${h[0]} vs ${h[1]}`:h.join(", ");s.push(`${c}: ${g}`)}}e.unassigned?.length>0&&s.push(`Unassigned: ${e.unassigned.join(", ")}`);const u=s.join(" | ");await ce(n,i,"arrangement_saved",o,o,{matchCount:a,playerCount:l,arrangementDetails:u}),_("Match arrangement saved","success")}catch(a){console.error("Error saving match arrangement:",a),_("Failed to save arrangement","error")}}async function lr(){const e=S.value,n=R.value;if(!e||!n)return;const i=k.value||"Admin";try{await O(`groups/${e}/matchArrangements/${n}`).remove(),P.value=null,await ce(e,n,"arrangement_cleared",i,i),_("Arrangement cleared - using auto-organization","info")}catch(o){console.error("Error clearing match arrangement:",o),_("Failed to clear arrangement","error")}}function sr(){B(()=>{let e=null,n=null;const i=de(()=>{const o=S.value,r=R.value;if(e&&n&&e.off("value",n),!o||o==="admin"||!r){P.value=null;return}e=O(`groups/${o}/matchArrangements/${r}`),n=e.on("value",a=>{P.value=a.val()||null})});return()=>{i(),e&&n&&e.off("value",n)}},[])}function Ae({isOpen:e,onClose:n,title:i,subtitle:o,children:r,showCloseButton:a=!0}){return e?t("div",{class:"modal active",onClick:l=>{l.target===l.currentTarget&&n&&n()},children:t("div",{class:"modal-content",onClick:l=>l.stopPropagation(),children:[t("div",{class:"modal-header",children:[t("div",{children:[t("h2",{children:i}),o&&t("p",{style:"font-size: 12px; color: #666; margin: 4px 0 0 0;",children:o})]}),a&&n&&t("button",{class:"close-btn",onClick:n,children:"Ã—"})]}),r]})}):null}m(!1);function bn(e){return e.toLowerCase().replace(/\s+/g,"")}m(!1);m(!1);m([]);m(!1);const wn=m([]);m(!1);let Ye=null;function cr(){const e=S.value,n=k.value;if(!(!e||!n)){Ye&&Ye();try{const o=T().ref(`groups/${e}/userNotifications/${bn(n)}/items`),r=o.on("value",a=>{const l=a.val()||{},s=Object.entries(l).map(([d,u])=>({id:d,...u}));wn.value=s.sort((d,u)=>u.timestamp-d.timestamp)});Ye=()=>{o.off("value",r)}}catch(i){console.error("Error subscribing to notifications:",i)}}}async function dr(e){const n=S.value,i=k.value;if(!(!n||!i))try{await T().ref(`groups/${n}/userNotifications/${bn(i)}/items/${e}/read`).set(!0)}catch(o){console.error("Error marking notification as read:",o)}}function ur(){B(()=>{const e=S.value,n=k.value;return e&&n&&cr(),()=>{Ye&&(Ye(),Ye=null)}},[S.value,k.value])}async function pr(e){const n=S.value,i=k.value;if(!(!n||!i))try{await T().ref(`groups/${n}/userNotifications/${bn(i)}/items/${e}`).remove()}catch(o){console.error("Error clearing notification:",o)}}async function hr(){const e=S.value,n=k.value;if(!(!e||!n))try{const i=T(),o={};wn.value.forEach(r=>{r.read||(o[`${r.id}/read`]=!0)}),Object.keys(o).length>0&&await i.ref(`groups/${e}/userNotifications/${bn(n)}/items`).update(o)}catch(i){console.error("Error marking all as read:",i)}}const ae=m("checkin");function fr(){ae.value="profile"}const $n=Xe(()=>wn.value.filter(e=>!e.read).length),gr=[{id:"checkin",label:"Check-in",icon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>',activeIcon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>'},{id:"matches",label:"My Games",icon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>',activeIcon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>'},{id:"notifications",label:"Alerts",icon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>',activeIcon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>'},{id:"help",label:"Help",icon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></svg>',activeIcon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></svg>'}];function mr(){return t("nav",{style:{position:"fixed",bottom:0,left:"50%",transform:"translateX(-50%)",width:"100%",maxWidth:"480px",height:"calc(64px + env(safe-area-inset-bottom))",background:"#fff",borderTop:"1px solid #e0e0e0",display:"flex",justifyContent:"space-around",alignItems:"flex-start",paddingTop:"8px",zIndex:1e3,paddingBottom:"env(safe-area-inset-bottom)",boxShadow:"0 -2px 10px rgba(0,0,0,0.1)"},children:gr.map(e=>{const n=ae.value===e.id,i=e.id==="notifications"&&$n.value>0;return t("button",{onClick:()=>{ae.value=e.id},style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"2px",background:"none",border:"none",padding:"8px 12px",cursor:"pointer",color:n?"#4CAF50":"#666",position:"relative",minWidth:"60px"},children:[t("div",{style:{position:"relative"},dangerouslySetInnerHTML:{__html:n?e.activeIcon:e.icon}}),i&&t("span",{style:{position:"absolute",top:"2px",right:"8px",background:"#f44336",color:"white",fontSize:"10px",padding:"1px 5px",borderRadius:"10px",minWidth:"16px",textAlign:"center"},children:$n.value>9?"9+":$n.value}),t("span",{style:{fontSize:"10px",fontWeight:n?"600":"400"},children:e.label})]},e.id)})})}const Ke=m(!1),$e=m(!1);function Ci(){const e=S.value;return e?sessionStorage.getItem(`adminAuth_${e}`)==="true":!1}function vr(){const[e,n]=fe(Ci());return B(()=>{const i=setInterval(()=>{n(Ci())},1e3);return()=>clearInterval(i)},[]),t("h1",{style:"display: flex; justify-content: space-between; align-items: center;",children:[t("span",{children:[t("span",{id:"groupNameDisplay",children:["ðŸŽ¾ ",H.value||"Tennis Coordinator"]}),H.value&&t(D,{children:[t("br",{}),t("small",{style:"font-size: 12px; font-weight: 400; opacity: 0.8;",children:"Tennis Coordinator"})]})]}),k.value&&t("button",{onClick:fr,style:{display:"flex",alignItems:"center",gap:"6px",background:e?"#FFF3E0":"#f5f5f5",border:e?"2px solid #FF9800":"1px solid #e0e0e0",borderRadius:"20px",padding:"6px 12px",fontSize:"14px",fontWeight:"500",color:"#333",cursor:"pointer"},children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",style:"opacity: 0.7;",children:t("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),t("span",{children:k.value}),e&&t("span",{style:{background:"#FF9800",color:"white",fontSize:"10px",padding:"2px 6px",borderRadius:"10px",fontWeight:"600"},children:"ADMIN"})]})]})}const Yt=m(""),st=m("");function yr({isOpen:e,groupName:n,correctPin:i,onSuccess:o}){const r=l=>{l.preventDefault(),Yt.value===i?(st.value="",Yt.value="",o()):(st.value="Invalid PIN. Please try again.",_("Invalid PIN","error"))},a=l=>{Yt.value=l.target.value,st.value=""};return t(Ae,{isOpen:e,title:`Welcome to ${n||"Tennis Coordinator"}`,showCloseButton:!1,children:t("div",{style:"text-align: center; padding: 20px 0;",children:[t("p",{style:"font-size: 48px; margin-bottom: 16px;",children:"ðŸŽ¾"}),t("p",{style:"color: #666; margin-bottom: 24px;",children:"Enter the group PIN to access check-ins"}),t("form",{onSubmit:r,children:[t("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Enter PIN",value:Yt.value,onInput:a,style:`
              width: 100%;
              padding: 16px;
              font-size: 24px;
              text-align: center;
              border: 2px solid #e0e0e0;
              border-radius: 12px;
              margin-bottom: 16px;
              letter-spacing: 8px;
            `,autoFocus:!0}),st.value&&t("p",{style:"color: #f44336; font-size: 14px; margin-bottom: 16px;",children:st.value}),t("button",{type:"submit",style:`
              width: 100%;
              padding: 16px;
              background: #4CAF50;
              color: white;
              border: none;
              border-radius: 12px;
              font-size: 18px;
              font-weight: 600;
              cursor: pointer;
            `,children:"Enter"})]}),t("p",{style:"font-size: 12px; color: #999; margin-top: 16px;",children:"Don't know the PIN? Ask your group admin."})]})})}const Xn=m(!1),ei=m(""),ti=m(""),ni=m("");function ii(e){const n=H.value||"our tennis group",i=S.value,o=window.location.href.split("?")[0]+"?group="+i,r=E.value.groupPin||"";return`Hi ${e}! You've been added to ${n} tennis coordination.

Check in for upcoming matches here:
${o}

PIN: ${r}

Just select your name and check in when you can play!`}function xr(e,n){const i=e.replace(/[\s\-\(\)]/g,""),o=navigator.userAgent||"";return/iPad|iPhone|iPod/.test(o)?`sms:${i}&body=${encodeURIComponent(n)}`:`sms:${i}?body=${encodeURIComponent(n)}`}function br(e,n,i){return`mailto:${e}?subject=${encodeURIComponent(n)}&body=${encodeURIComponent(i)}`}async function wr(e){const n=ii(e),i=H.value||"Tennis Group";try{await navigator.share({title:`Join ${i}`,text:n}),Ee(),_("Shared successfully!","success")}catch(o){o.name!=="AbortError"&&(console.error("Share failed:",o),uo(e))}}async function uo(e){const n=ii(e);try{await navigator.clipboard.writeText(n),Ee(),_("Message copied! Paste in SMS or email.","success")}catch{const o=document.createElement("textarea");o.value=n,o.style.position="fixed",o.style.left="-9999px",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),Ee(),_("Message copied! Paste in SMS or email.","success")}}function Ee(){Xn.value=!1,ei.value="",ti.value="",ni.value=""}function _r(e,n,i){ei.value=e,ti.value=n||"",ni.value=i||"",Xn.value=!0}function kr(){const e=ei.value,n=ti.value,i=ni.value,o=ii(e),r=H.value||"Tennis Group",a=typeof navigator<"u"&&navigator.share!==void 0;return t(Ae,{isOpen:Xn.value,onClose:Ee,title:"",showCloseButton:!1,children:t("div",{style:{textAlign:"center",padding:"10px 0"},children:[t("h3",{style:{margin:"0 0 12px 0",fontSize:"16px"},children:["Invite ",e,"?"]}),t("p",{style:{margin:"0 0 16px 0",color:"#666",fontSize:"14px"},children:"Send them an invite with the group link and PIN"}),t("div",{style:{display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[n&&t("a",{href:xr(n,o),onClick:()=>setTimeout(Ee,500),style:{background:"#25D366",color:"white",padding:"12px 20px",border:"none",borderRadius:"8px",fontSize:"14px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"8px",textDecoration:"none"},children:[t("span",{children:"ðŸ“±"})," Text ",n]}),i&&t("a",{href:br(i,`You're invited to ${r}`,o),onClick:()=>setTimeout(Ee,500),style:{background:"#4285F4",color:"white",padding:"12px 20px",border:"none",borderRadius:"8px",fontSize:"14px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"8px",textDecoration:"none"},children:[t("span",{children:"ðŸ“§"})," Email"]}),a&&t("button",{onClick:()=>wr(e),style:{background:"#9C27B0",color:"white",padding:"12px 20px",border:"none",borderRadius:"8px",fontSize:"14px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"8px"},children:[t("span",{children:"ðŸ“¤"})," Other"]}),t("button",{onClick:()=>uo(e),style:{background:"#607D8B",color:"white",padding:"12px 20px",border:"none",borderRadius:"8px",fontSize:"14px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"8px"},children:[t("span",{children:"ðŸ“‹"})," Copy"]})]}),t("button",{onClick:Ee,style:{marginTop:"12px",background:"none",border:"none",color:"#999",fontSize:"14px",cursor:"pointer"},children:"Skip"})]})})}const _n=m(!1),et=m(null),dn=m(""),St=m(""),$t=m(""),zt=m(""),Te=m(""),un=m(!1),At=m(""),It=m(""),Mt=m(""),Dt=m("");async function Cr(){const e=At.value.trim();if(!e){_("Please enter member name","error");return}const n=It.value.trim(),i=Mt.value.trim();await so({name:e,phone:n,email:i,notes:Dt.value.trim(),addedBy:k.value||"Admin"}),At.value="",It.value="",Mt.value="",Dt.value="",un.value=!1}function po(){At.value="",It.value="",Mt.value="",Dt.value="",un.value=!1}function Sr(e){confirm(`Remove ${e} from the group?`)&&rr(e)}function $r(e){et.value=e,dn.value=e;const n=L.value[e]||{};St.value=n.phone||"",$t.value=n.email||"",zt.value=n.notes||""}async function zr(){const e=et.value;if(!e)return;const n=S.value;if(!n)return;const i=dn.value.trim();try{if(i!==e&&!await co(e,i))return;const o=i!==e?i:e;await T().ref(`groups/${n}/settings/memberDetails/${o}`).update({phone:St.value,email:$t.value,notes:zt.value}),L.value={...L.value,[o]:{...L.value[o]||{},phone:St.value,email:$t.value,notes:zt.value}},et.value=null,i===e&&_("Member updated","success")}catch(o){console.error("Error updating member:",o),_("Failed to update member","error")}}function Ar(){_n.value=!1,et.value=null,Te.value="",po()}function Ir(){const e=Y.value,n=L.value,i=e.filter(o=>o.toLowerCase().includes(Te.value.toLowerCase())).sort((o,r)=>o.localeCompare(r));return t(Ae,{isOpen:_n.value,onClose:Ar,title:"Manage Members",subtitle:`${e.length} members in group`,children:[et.value&&t("div",{style:"position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1001;",children:t("div",{style:"background: white; padding: 24px; border-radius: 12px; max-width: 400px; width: 90%;",children:[t("h3",{style:"margin-top: 0;",children:"Edit Member"}),t("div",{style:"margin-bottom: 12px;",children:[t("label",{style:"font-size: 12px; color: #666; display: block; margin-bottom: 4px;",children:"Name"}),t("input",{type:"text",placeholder:"Member name",value:dn.value,onInput:o=>{dn.value=o.target.value},style:"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; box-sizing: border-box;"})]}),t("div",{style:"margin-bottom: 12px;",children:[t("label",{style:"font-size: 12px; color: #666; display: block; margin-bottom: 4px;",children:"Phone"}),t("input",{type:"tel",placeholder:"Phone number",value:St.value,onInput:o=>{St.value=o.target.value},style:"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; box-sizing: border-box;"})]}),t("div",{style:"margin-bottom: 12px;",children:[t("label",{style:"font-size: 12px; color: #666; display: block; margin-bottom: 4px;",children:"Email"}),t("input",{type:"email",placeholder:"Email address",value:$t.value,onInput:o=>{$t.value=o.target.value},style:"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; box-sizing: border-box;"})]}),t("div",{style:"margin-bottom: 16px;",children:[t("label",{style:"font-size: 12px; color: #666; display: block; margin-bottom: 4px;",children:"Notes"}),t("textarea",{placeholder:"Notes (skill level, etc.)",rows:2,value:zt.value,onInput:o=>{zt.value=o.target.value},style:"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; resize: vertical; box-sizing: border-box;"})]}),t("div",{style:"display: flex; gap: 8px;",children:[t("button",{onClick:()=>{et.value=null},style:"flex: 1; background: #ccc; color: #333;",children:"Cancel"}),t("button",{onClick:zr,style:"flex: 1; background: #4CAF50; color: white;",children:"Save"})]})]})}),t("div",{style:"margin-bottom: 16px;",children:t("div",{style:"position: relative;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#999",style:"position: absolute; left: 12px; top: 50%; transform: translateY(-50%);",children:t("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),t("input",{type:"text",placeholder:"Search members...",value:Te.value,onInput:o=>{Te.value=o.target.value},style:"width: 100%; padding: 12px 12px 12px 40px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; box-sizing: border-box;"}),Te.value&&t("button",{onClick:()=>{Te.value=""},style:"position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; padding: 0;",children:t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#999",children:t("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]})}),t("div",{style:"max-height: 400px; overflow-y: auto; margin-bottom: 16px;",children:i.length===0?t("div",{style:"text-align: center; padding: 20px; color: #888;",children:Te.value?"No members found":"No members yet"}):i.map(o=>{const r=n[o],a=r&&(r.phone||r.email||r.addedBy),l=r&&(r.phone||r.email),s=r?.addedDate?new Date(r.addedDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):null;return t("div",{style:"flex-direction: column; align-items: flex-start; padding: 12px; background: #f9f9f9; border-radius: 8px; margin-bottom: 8px;",children:[t("div",{style:"display: flex; justify-content: space-between; width: 100%; align-items: center;",children:[t("span",{style:"font-weight: 500;",children:o}),t("div",{style:"display: flex; gap: 4px;",children:[t("button",{onClick:()=>$r(o),style:{background:"rgba(76, 175, 80, 0.1)",color:"#4CAF50",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0"},title:"Edit",children:t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})}),l&&t("button",{onClick:()=>_r(o,r?.phone,r?.email),style:{background:"rgba(33, 150, 243, 0.1)",color:"#2196F3",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0"},title:"Invite",children:t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})})}),t("button",{onClick:()=>Sr(o),style:{background:"rgba(255, 82, 82, 0.1)",color:"#e57373",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0"},title:"Remove",children:t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]})]}),a&&t("div",{style:"font-size: 12px; color: #666; margin-top: 8px; padding-left: 12px; border-left: 3px solid #4CAF50;",children:[r?.addedBy&&t("div",{children:["Added by: ",t("strong",{children:r.addedBy}),s&&` on ${s}`]}),r?.phone&&t("div",{children:["ðŸ“± ",r.phone]}),r?.email&&t("div",{children:["ðŸ“§ ",r.email]}),r?.notes&&t("div",{children:["Notes: ",r.notes]})]})]},o)})}),t("div",{style:"padding-top: 12px; border-top: 1px solid #e0e0e0;",children:un.value?t("div",{style:"background: #f9f9f9; padding: 16px; border-radius: 8px;",children:[t("h4",{style:"margin: 0 0 12px 0; font-size: 14px; color: #333;",children:"Add New Member"}),t("input",{type:"text",placeholder:"Member's full name",value:At.value,onInput:o=>{At.value=o.target.value},style:"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; margin-bottom: 8px; box-sizing: border-box;"}),t("div",{style:"display: flex; gap: 8px; margin-bottom: 8px;",children:[t("input",{type:"tel",placeholder:"Phone (optional)",value:It.value,onInput:o=>{It.value=o.target.value},style:"flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; box-sizing: border-box;"}),t("input",{type:"email",placeholder:"Email (optional)",value:Mt.value,onInput:o=>{Mt.value=o.target.value},style:"flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; box-sizing: border-box;"})]}),t("textarea",{placeholder:"Notes (skill level, how you know them, etc.) - optional",rows:2,value:Dt.value,onInput:o=>{Dt.value=o.target.value},style:"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; resize: vertical; margin-bottom: 12px; box-sizing: border-box; font-family: inherit;"}),t("div",{style:"font-size: 12px; color: #666; margin-bottom: 12px;",children:["Added by: ",t("strong",{children:k.value||"Admin"})]}),t("div",{style:"display: flex; gap: 8px;",children:[t("button",{onClick:po,style:"flex: 1; padding: 10px; background: #ccc; color: #333; border: none; border-radius: 8px; cursor: pointer; font-weight: 500;",children:"Cancel"}),t("button",{onClick:Cr,style:"flex: 2; padding: 10px; background: #4CAF50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 500;",children:"Add Member"})]})]}):t("button",{onClick:()=>{un.value=!0},style:"width: 100%; padding: 12px; background: #4CAF50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 500; display: flex; align-items: center; justify-content: center; gap: 8px;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add New Member"]})})]})}const qe=m(""),Rt=m(""),Tt=m(""),Fe=m(""),Je=m(""),Ze=m(""),Pt=m(""),Et=m(""),oi=m(!0),Ft=m(""),Hn=m(!1);function Mr(){const e=S.value;if(!e)return!1;const n=`adminAuth_${e}`;return sessionStorage.getItem(n)==="true"}function Dr(){const e=S.value;e&&(sessionStorage.setItem(`adminAuth_${e}`,"true"),Hn.value=!0)}function Rr(){qe.value=H.value||"",Rt.value=E.value.adminPin||"",Tt.value=E.value.groupPin||"",Fe.value=E.value.location?.name||"",Je.value=E.value.location?.lat?.toString()||"",Ze.value=E.value.location?.lon?.toString()||"",Pt.value=E.value.groupDescription||"",Et.value=E.value.groupRules||"",Hn.value=Mr(),oi.value=!Hn.value&&!!E.value.adminPin,Ft.value=""}async function Tr(e=!1){const n=S.value;if(n)try{const o=T().ref(`groups/${n}/settings`),r={groupName:qe.value,adminPin:Rt.value,groupPin:Tt.value,groupDescription:Pt.value||null,groupRules:Et.value||null};Fe.value&&Je.value&&Ze.value&&(r.location={name:Fe.value,lat:parseFloat(Je.value),lon:parseFloat(Ze.value)}),await o.update(r),H.value=qe.value,E.value={...E.value,adminPin:Rt.value,groupPin:Tt.value,location:Fe.value?{name:Fe.value,lat:parseFloat(Je.value),lon:parseFloat(Ze.value)}:void 0,groupDescription:Pt.value||void 0,groupRules:Et.value||void 0},_("Settings saved","success"),e&&Un()}catch(i){console.error("Error saving settings:",i),_("Failed to save settings","error")}}function Si(){Ft.value===E.value.adminPin?(Dr(),oi.value=!1,$e.value=!1,_("Admin mode enabled","success")):(_("Incorrect PIN","error"),Ft.value="")}function Un(){$e.value=!1}function Pr(){return $e.value&&qe.value===""&&H.value&&Rr(),t(Ae,{isOpen:$e.value,onClose:Un,title:"Admin Settings",subtitle:`Managing: ${H.value}`,children:oi.value?t("div",{style:"padding: 20px; text-align: center;",children:[t("p",{style:"margin-bottom: 16px; color: #666;",children:"Enter admin PIN to access settings"}),t("input",{type:"password",placeholder:"Admin PIN",value:Ft.value,onInput:e=>{Ft.value=e.target.value},onKeyPress:e=>{e.key==="Enter"&&Si()},style:"width: 100%; max-width: 200px; padding: 12px; text-align: center; font-size: 18px; border: 2px solid #e0e0e0; border-radius: 8px; margin-bottom: 16px;"}),t("br",{}),t("button",{onClick:Si,style:"padding: 12px 32px; background: #4CAF50; color: white;",children:"Submit"})]}):t(D,{children:[t("div",{style:"margin-bottom: 16px;",children:t("button",{onClick:()=>{Ke.value=!0,$e.value=!1},style:"width: 100%; padding: 12px 16px; background: #f5f5f5; border: 1px solid #e0e0e0; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 10px; font-size: 14px; color: #333;",children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",style:"color: #666;",children:t("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"})}),t("div",{style:"flex: 1; text-align: left;",children:[t("div",{style:"font-weight: 500;",children:"Activity History"}),t("div",{style:"font-size: 12px; color: #666;",children:"View all check-ins, changes, and match updates"})]}),t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",style:"color: #999;",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]})}),t("div",{style:"margin-bottom: 16px;",children:t("button",{onClick:()=>{_n.value=!0,$e.value=!1},style:"width: 100%; padding: 12px 16px; background: #f5f5f5; border: 1px solid #e0e0e0; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 10px; font-size: 14px; color: #333;",children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",style:"color: #4CAF50;",children:t("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})}),t("div",{style:"flex: 1; text-align: left;",children:[t("div",{style:"font-weight: 500;",children:"Manage Members"}),t("div",{style:"font-size: 12px; color: #666;",children:"Add, edit, or remove group members"})]}),t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",style:"color: #999;",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]})}),t("div",{style:"margin-bottom: 16px; padding-top: 16px; border-top: 1px solid #e0e0e0;",children:t("div",{style:"display: flex; justify-content: space-between; align-items: center;",children:[t("h3",{style:"margin: 0; color: #333;",children:"Group Settings"}),t("span",{style:"font-size: 11px; color: #666; background: #f5f5f5; padding: 2px 8px; border-radius: 10px;",children:"Click Save to apply"})]})}),t("div",{class:"pref-section",children:[t("h3",{children:"Group Name"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"Display name for this tennis group"}),t("input",{type:"text",placeholder:"e.g., Tue/Thu Midday Doubles",value:qe.value,onInput:e=>{qe.value=e.target.value},style:"width: 100%; margin-bottom: 12px;"})]}),t("div",{class:"pref-section",children:[t("h3",{children:"Group Story"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"Tell your group's story - when/where you play, how it started, etc."}),t("textarea",{placeholder:"e.g., We're a group of friends who play doubles every Tuesday and Thursday at noon at Los Gatos High School courts...",value:Pt.value,onInput:e=>{Pt.value=e.target.value},rows:3,style:"width: 100%; margin-bottom: 12px; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; resize: vertical; font-family: inherit; box-sizing: border-box;"})]}),t("div",{class:"pref-section",children:[t("h3",{children:"Rules & Tips"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"House rules, etiquette, and tips for new members (one per line)"}),t("textarea",{placeholder:`e.g.,
Check in by 10am on game days
Bring water and sunscreen
New balls provided by rotating member...`,value:Et.value,onInput:e=>{Et.value=e.target.value},rows:4,style:"width: 100%; margin-bottom: 12px; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; resize: vertical; font-family: inherit; box-sizing: border-box;"})]}),t("div",{class:"pref-section",children:[t("h3",{children:"Admin PIN"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"Required to access admin settings"}),t("input",{type:"text",value:Rt.value,onInput:e=>{Rt.value=e.target.value},style:"width: 100%; margin-bottom: 12px;"})]}),t("div",{class:"pref-section",children:[t("h3",{children:"Group PIN"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"Share this PIN with all group members to access the app"}),t("input",{type:"text",value:Tt.value,onInput:e=>{Tt.value=e.target.value},style:"width: 100%; margin-bottom: 12px;"})]}),t("div",{class:"pref-section",children:[t("h3",{children:"Weather Location"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"Set the location for weather forecasts"}),t("input",{type:"text",placeholder:"Location name (e.g., Los Gatos, CA)",value:Fe.value,onInput:e=>{Fe.value=e.target.value},style:"width: 100%; margin-bottom: 8px;"}),t("div",{style:"display: flex; gap: 8px; margin-bottom: 12px;",children:[t("input",{type:"number",step:"0.0001",placeholder:"Latitude",value:Je.value,onInput:e=>{Je.value=e.target.value},style:"flex: 1;"}),t("input",{type:"number",step:"0.0001",placeholder:"Longitude",value:Ze.value,onInput:e=>{Ze.value=e.target.value},style:"flex: 1;"})]}),t("p",{style:"font-size: 11px; color: #999; margin-bottom: 12px;",children:["Tip: Use ",t("a",{href:"https://www.latlong.net/",target:"_blank",style:"color: #4CAF50;",children:"latlong.net"})," to find coordinates"]})]}),t("div",{style:"display: flex; gap: 8px; margin-top: 16px;",children:[t("button",{onClick:Un,style:"flex: 1; background: #e0e0e0; color: #333;",children:"Close"}),t("button",{onClick:()=>Tr(!0),style:"flex: 1; background: #4CAF50; color: white;",children:"Save & Close"})]})]})})}const ho={login:{label:"Logins",actions:["user_login"]},checkin:{label:"Check-ins",actions:["check-in","checkin"]},removal:{label:"Removals",actions:["removal"]},shared:{label:"Shared",actions:["whatsapp_share"]},notes:{label:"Notes",actions:["notes_saved","note_added","note_updated","note_removed"]},members:{label:"Members",actions:["member_added","member_removed","member_renamed"]},arrangements:{label:"Arrangements",actions:["arrangement_saved","arrangement_cleared"]}},He=m(!1),Nt=m([]),Gn=m(!1),le=m(new Set);async function Er(){const e=S.value;if(e){Gn.value=!0;try{const n=T();let i=[];const r=(await n.ref(`groups/${e}/activity`).once("value")).val();if(r){for(const[a,l]of Object.entries(r))if(l)for(const[s,d]of Object.entries(l))i.push({...d,date:a,firebaseKey:s})}i.sort((a,l)=>l.timestamp-a.timestamp),Nt.value=i}catch(n){console.error("Error loading activity:",n)}finally{Gn.value=!1}}}async function Fr(e){const n=S.value;if(!(!n||!e.firebaseKey||!e.date)&&confirm("Remove this activity entry?"))try{await T().ref(`groups/${n}/activity/${e.date}/${e.firebaseKey}`).remove(),Nt.value=Nt.value.filter(o=>!(o.date===e.date&&o.firebaseKey===e.firebaseKey))}catch(i){console.error("Error deleting activity:",i),alert("Failed to delete activity")}}function Nr(e){switch(e){case"singles":return"Singles";case"doubles":return"Doubles";default:return"Either"}}function Lr(e){return ao(e)}function Br(e){switch(e){case"check-in":case"checkin":return"âœ…";case"removal":return"âŒ";case"member_added":return"ðŸ‘¤";case"member_removed":return"ðŸš«";case"member_renamed":return"âœï¸";case"whatsapp_share":return"ðŸ“¤";case"notes_saved":case"note_added":return"ðŸ“";case"note_updated":return"âœï¸";case"note_removed":return"ðŸ—‘ï¸";case"user_login":return"ðŸ”“";case"arrangement_saved":return"ðŸ”€";case"arrangement_cleared":return"â†©ï¸";default:return"ðŸ“‹"}}function Or(e){const{action:n,player:i,by:o,playStyle:r,timeRange:a,matchKey:l,type:s}=e;switch(n){case"check-in":case"checkin":{let d=`${i} checked in`;return o&&o!==i&&(d+=` (by ${o})`),r&&(d+=` - ${Nr(r)}`,(a?.start||a?.end)&&(d+=` (${a.start||"anytime"}â€“${a.end||"anytime"})`)),d}case"removal":return o&&o!==i?`${o} removed ${i}`:`${i} removed themselves`;case"member_added":return`${o} added ${i} as member`;case"member_removed":return`${o} removed ${i} from members`;case"member_renamed":return`${o} renamed ${e.oldName} to ${i}`;case"whatsapp_share":{let u=`${o} shared ${s==="matches"?"matches":s==="checkin"?"check-in":"removal"} to WhatsApp`;return i&&i!==o&&(u+=` (for ${i})`),u}case"notes_saved":case"note_added":{const d=l?l.replace("-"," #").replace("forming 1","forming"):"match",u=e.noteContent?`: "${e.noteContent.length>30?e.noteContent.substring(0,30)+"...":e.noteContent}"`:"";return`${o} added note to ${d}${u}`}case"note_updated":{const d=l?l.replace("-"," #").replace("forming 1","forming"):"match",u=e.noteContent?`: "${e.noteContent.length>30?e.noteContent.substring(0,30)+"...":e.noteContent}"`:"";return`${o} updated note on ${d}${u}`}case"note_removed":{const d=l?l.replace("-"," #").replace("forming 1","forming"):"match";return`${o} removed note from ${d}`}case"user_login":return`${i} logged in`;case"arrangement_saved":{const{matchCount:d}=e;let u=`${o} arranged matches`;return d&&(u+=` (${d} match${d>1?"es":""})`),u}case"arrangement_cleared":return`${o} cleared arrangement (back to auto)`;default:return`${i} - ${n}`}}function jr(e){const n=new Set(le.value);n.has(e)?n.delete(e):n.add(e),le.value=n}function Wr(){if(le.value.size===0)return Nt.value;const e=new Set;return le.value.forEach(n=>{ho[n].actions.forEach(i=>e.add(i))}),Nt.value.filter(n=>e.has(n.action))}function Hr(){Ke.value=!1,He.value=!1,le.value=new Set}function Ur(){B(()=>{Ke.value&&Er()},[Ke.value]);const e=Wr(),n={};return He.value?e.forEach(i=>{n[i.date]||(n[i.date]=[]),n[i.date].push(i)}):e.forEach(i=>{const o=new Date(i.timestamp).toISOString().split("T")[0];n[o]||(n[o]=[]),n[o].push(i)}),t(Ae,{isOpen:Ke.value,onClose:Hr,title:"Activity History",children:[t("div",{style:"display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 12px;",children:[Object.entries(ho).map(([i,o])=>{const r=le.value.has(i);return t("button",{onClick:()=>jr(i),style:{padding:"4px 10px",fontSize:"12px",border:r?"1px solid #4CAF50":"1px solid #ddd",borderRadius:"16px",background:r?"#E8F5E9":"#fff",color:r?"#2E7D32":"#666",cursor:"pointer",fontWeight:r?"500":"400"},children:o.label},i)}),le.value.size>0&&t("button",{onClick:()=>{le.value=new Set},style:{padding:"4px 10px",fontSize:"12px",border:"1px solid #f44336",borderRadius:"16px",background:"#fff",color:"#f44336",cursor:"pointer"},children:"Clear"})]}),t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;",children:[t("p",{style:"font-size: 13px; color: #666; margin: 0;",children:[He.value?"Grouped by play date":"Grouped by when changes were made",le.value.size>0&&` (${e.length} filtered)`]}),t("label",{style:"font-size: 13px; color: #666; cursor: pointer; display: flex; align-items: center; gap: 4px;",children:[t("input",{type:"checkbox",checked:He.value,onChange:i=>{He.value=i.target.checked}}),"Group by Play Date"]})]}),t("div",{style:"max-height: 400px; overflow-y: auto;",children:Gn.value?t("p",{style:"color: #999; text-align: center; padding: 24px;",children:"Loading..."}):e.length===0?t("p",{style:"color: #999; text-align: center; padding: 24px;",children:le.value.size>0?"No matching activities":"No activity recorded yet"}):Object.entries(n).sort(([i],[o])=>o.localeCompare(i)).map(([i,o])=>t("div",{children:[t("div",{style:"font-weight: bold; color: #666; margin-top: 12px; padding-bottom: 4px; border-bottom: 1px solid #ddd;",children:G(i)}),o.map((r,a)=>t("div",{style:"padding: 10px; background: #f9f9f9; border-radius: 6px; font-size: 14px; margin-top: 8px; position: relative;",children:t("div",{style:"display: flex; align-items: flex-start; gap: 6px;",children:[t("span",{children:Br(r.action)}),t("div",{style:"flex: 1;",children:[t("div",{style:"white-space: pre-wrap;",children:Or(r)}),r.arrangementDetails&&t("div",{style:"font-size: 12px; color: #666; margin-top: 4px; background: #fff; padding: 6px 8px; border-radius: 4px; border: 1px solid #e0e0e0;",children:r.arrangementDetails}),t("div",{style:"font-size: 12px; color: #999; margin-top: 4px; display: flex; gap: 8px; flex-wrap: wrap;",children:[t("span",{children:Lr(r.timestamp)}),He.value?t("span",{style:"color: #666;",children:["changed on ",G(new Date(r.timestamp).toISOString().split("T")[0])]}):t("span",{style:"color: #4CAF50;",children:["for ",G(r.date)]})]})]}),t("button",{onClick:()=>Fr(r),title:"Remove this activity",style:{background:"none",border:"none",padding:"4px",cursor:"pointer",color:"#999",fontSize:"16px",lineHeight:"1",borderRadius:"4px",transition:"color 0.2s, background 0.2s"},onMouseOver:l=>{l.target.style.color="#f44336",l.target.style.background="#ffebee"},onMouseOut:l=>{l.target.style.color="#999",l.target.style.background="none"},children:t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]})},a))]},i))})]})}const Lt=m(!1);async function Gr(e,n){try{const i=T(),o=new Date().toISOString().split("T")[0];await i.ref(`groups/${e}/activity/${o}`).push({timestamp:Date.now(),action:"user_login",player:n,by:n})}catch(i){console.error("Error logging login activity:",i)}}function Vr(e){const n=e.target.value;if(!n)return;k.value=n;const i=S.value;i&&(localStorage.setItem(`sessionUser_${i}`,n),Gr(i,n)),ve.value=n,X.value=!0,Lt.value=!1,window.scrollTo(0,0),_(`Welcome, ${n}!`,"success")}function Yr(){const e=[...Y.value].sort((n,i)=>n.localeCompare(i));return t(Ae,{isOpen:Lt.value,title:"",showCloseButton:!1,children:t("div",{style:"text-align: center; padding: 10px 0;",children:[t("h2",{style:"margin-top: 0; font-size: 24px;",children:"Welcome!"}),t("p",{style:"color: #4CAF50; font-weight: 500; margin-bottom: 16px; font-size: 16px;",children:H.value}),t("p",{style:"color: #666; margin-bottom: 20px;",children:"Select your name to start"}),t("select",{onChange:Vr,style:"width: 100%; padding: 12px; font-size: 16px; border: 2px solid #e0e0e0; border-radius: 8px;",children:[t("option",{value:"",children:"Select your name..."}),e.map(n=>t("option",{value:n,children:n},n))]})]})})}function Kr(e){if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function qr(e){return`https://wa.me/?text=${encodeURIComponent(e)}`}function fo(e){const n=new Date(e+"T12:00:00"),i=n.toLocaleDateString("en-US",{weekday:"long"}),o=n.toLocaleDateString("en-US",{month:"long"}),r=n.getDate(),a=Kr(r);return`${i}, ${o} ${r}${a}`}function Jr(e,n,i){const o=fo(n),r=[];r.push(`I'm checking in for tennis on ${o}!`),r.push("");const a=i.playStyle==="singles"?"Singles only":i.playStyle==="doubles"?"Doubles only":"Either singles or doubles";if(r.push(`Preference: ${a}`),i.timeRange){const l=re(i.timeRange.start,i.timeRange.end);l&&r.push(`Available: ${l}`)}return r.join(`
`)}function Zr(e,n){return`I'm no longer available for tennis on ${fo(n)}.`}async function Qr(e){try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(e),!0;const n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.left="-999999px",n.style.top="-999999px",document.body.appendChild(n),n.focus(),n.select();const i=document.execCommand("copy");return document.body.removeChild(n),i}catch{return!1}}function Xr(e,n,i,o){return`Hi ${e}! You've been added to ${n} tennis coordination.

Check in for upcoming matches here:
${i}

PIN: ${o}

Just select your name and check in when you can play!`}function ea(){if(B(()=>{if(oe.value){const p=setTimeout(()=>{oe.value=!1,me.value=null},8e3);return()=>clearTimeout(p)}},[oe.value]),!oe.value||!me.value)return null;const e=me.value,n=e.action==="removal",i=e.action==="invite",o=()=>i?Xr(e.name,e.groupName||"",e.groupUrl||"",e.groupPin||""):n?Zr(e.name,e.date):Jr(e.name,e.date,{playStyle:e.playStyle||"both",timeRange:e.timeRange}),r=()=>{const p=o(),h=qr(p);window.open(h,"_blank"),oe.value=!1,me.value=null},a=async()=>{const p=o();await Qr(p)?_("Copied to clipboard","success"):_("Failed to copy","error"),oe.value=!1,me.value=null},l=()=>{oe.value=!1,me.value=null},s=i?"#E3F2FD":n?"#FFF3E0":"#E8F5E9",d=i?"#1565C0":n?"#E65100":"#2E7D32",u=i?"Added!":n?"Removed!":"Checked in!",f=i?`Invite ${e.name}?`:n?"Let others know?":"Share with the group?";return t("div",{style:{position:"fixed",bottom:"70px",left:"50%",transform:"translateX(-50%)",width:"calc(100% - 24px)",maxWidth:"456px",background:s,borderRadius:"12px",padding:"12px 16px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",gap:"12px",zIndex:1e3,animation:"slideUp 0.3s ease-out"},children:[t("div",{style:{flex:1,fontSize:"14px",color:d},children:[t("strong",{children:u})," ",f]}),t("div",{style:{display:"flex",gap:"8px"},children:[t("button",{onClick:r,style:{background:"#25D366",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",fontSize:"13px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"white",children:t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp"]}),t("button",{onClick:a,style:{background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:"8px",padding:"8px 12px",fontSize:"13px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"#666",children:t("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),"Copy"]}),t("button",{onClick:l,style:{background:"transparent",border:"none",padding:"4px",cursor:"pointer",color:"#666",fontSize:"18px",lineHeight:1},title:"Dismiss",children:"Ã—"})]}),t("style",{children:`
        @keyframes slideUp {
          from {
            transform: translate(-50%, 100%);
            opacity: 0;
          }
          to {
            transform: translate(-50%, 0);
            opacity: 1;
          }
        }
      `})]})}function $i(e){return e.toLowerCase().replace(/\s+/g,"")}function ta(e){const n=k.value;return n?(Q.value[e]||[]).some(o=>o.name&&$i(o.name)===$i(n)):!0}function na(e){R.value=e,k.value&&!ta(e)?(ve.value=k.value,X.value=!0):(ve.value="",X.value=!1)}function ia(){const e=Mo(null);B(()=>{const r=e.current;if(!r)return;const a=setTimeout(()=>{const l=r.querySelector('[data-today="true"]');l&&l.scrollIntoView({behavior:"instant",inline:"start",block:"nearest"})},50);return()=>clearTimeout(a)},[]);const n=[],i=new Date,o=Wn(i);for(let r=-14;r<=14;r++){const a=new Date(i);a.setDate(i.getDate()+r);const l=Wn(a),s=a.toLocaleDateString("en-US",{weekday:"short"}),d=a.getDate(),u=a.toLocaleDateString("en-US",{month:"short"}),p=(Q.value[l]||[]).length,h=l===o,c=r<0;n.push({value:l,dayName:s,dayNum:d,monthName:u,isToday:h,isPast:c,checkinCount:p})}return t("div",{class:"date-selector",children:t("div",{class:"date-scroll",ref:e,children:n.map(r=>t("button",{class:`date-btn ${R.value===r.value?"selected":""} ${r.isPast?"past":""}`,onClick:()=>na(r.value),"data-date":r.value,"data-today":r.isToday?"true":void 0,children:[t("span",{class:"day-name",children:r.dayName}),t("span",{class:"day-num",children:r.dayNum}),t("span",{class:"month-name",children:r.monthName}),r.isToday&&t("span",{class:"today-badge",children:"Today"}),r.checkinCount>0&&t("span",{class:"checkin-badge",children:r.checkinCount})]},r.value))})})}function oa(){const e=l=>{const s=l.target.value;if(ve.value=s,s==="__guest__")_e.value=!0,Ie.value=!1,X.value=!0;else if(s==="__new_member__")Ie.value=!0,_e.value=!1,X.value=!0;else if(s){if(_e.value=!1,Ie.value=!1,X.value=!0,!k.value){k.value=s;const d=S.value;d&&localStorage.setItem(`sessionUser_${d}`,s)}}else X.value=!1},n=async()=>{let l=ve.value,s="";if(_e.value){if(!dt.value.trim()){_("Please enter guest name","error");return}if(!ft.value){_("Please select who is adding the guest","error");return}l=dt.value.trim(),s=ft.value}if(!l||l==="__guest__"||l==="__new_member__"){_("Please select a name","error");return}const d=we.value,u=Me.value&&De.value?{start:Me.value,end:De.value}:void 0;await qo({name:l,playStyle:d,isGuest:_e.value,addedBy:_e.value?s:k.value,allowRotation:Zt.value,timeRange:u}),me.value={action:"checkin",name:l,playStyle:d,timeRange:u,date:R.value||""},oe.value=!0,r()},i=async()=>{if(!Oe.value.trim()){_("Please enter member name","error");return}if(!k.value){_("Please select your name first","error");return}const l=Oe.value.trim(),s=ut.value.trim(),d=pt.value.trim();await so({name:l,phone:s,email:d,notes:ht.value.trim(),addedBy:k.value}),Oe.value="",ut.value="",pt.value="",ht.value="",Ie.value=!1,ve.value="",X.value=!1},o=()=>{r()},r=()=>{ve.value="",_e.value=!1,Ie.value=!1,dt.value="",Oe.value="",ut.value="",pt.value="",ht.value="",ft.value="",we.value="both",Zt.value=!0,Me.value="",De.value="",X.value=!1},a=(l,s)=>{Me.value=l,De.value=s};return t(D,{children:[t("div",{class:"input-group",children:t("select",{id:"nameSelect",value:ve.value,onChange:e,children:[t("option",{value:"",children:k.value?"Check-in another player...":"Select your name..."}),[...Y.value].sort((l,s)=>l.localeCompare(s)).map(l=>t("option",{value:l,children:l},l)),t("option",{disabled:!0,children:"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"}),t("option",{value:"__guest__",children:"+ Add Guest"}),t("option",{value:"__new_member__",children:"+ Add New Member"})]})}),X.value&&t("div",{class:"collapsible-form expanded",id:"checkInFormFields",children:[_e.value&&t("div",{class:"guest-form active",children:[t("input",{type:"text",placeholder:"Guest's name",value:dt.value,onInput:l=>{dt.value=l.target.value}}),t("select",{value:ft.value,onChange:l=>{ft.value=l.target.value},children:[t("option",{value:"",children:"Who is adding this guest?"}),[...Y.value].sort((l,s)=>l.localeCompare(s)).map(l=>t("option",{value:l,children:l},l))]})]}),Ie.value&&t("div",{class:"member-form",children:[t("h3",{style:"font-size: 14px; margin-bottom: 12px; color: #333;",children:"Add New Member"}),t("input",{type:"text",placeholder:"Member's full name",value:Oe.value,onInput:l=>{Oe.value=l.target.value},style:"margin-bottom: 8px;"}),t("div",{style:"display: flex; gap: 8px; margin-bottom: 8px;",children:[t("input",{type:"tel",placeholder:"Phone (optional)",value:ut.value,onInput:l=>{ut.value=l.target.value},style:"flex: 1;"}),t("input",{type:"email",placeholder:"Email (optional)",value:pt.value,onInput:l=>{pt.value=l.target.value},style:"flex: 1;"})]}),t("textarea",{placeholder:"Notes (skill level, how you know them, etc.) - optional",rows:3,value:ht.value,onInput:l=>{ht.value=l.target.value},style:"width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 14px; resize: vertical; margin-bottom: 12px;"}),t("div",{style:"font-size: 12px; color: #666; margin-bottom: 12px;",children:["Added by: ",t("strong",{children:k.value||"(select your name first)"})]}),t("div",{style:"display: flex; gap: 8px;",children:[t("button",{onClick:o,style:"flex: 1; background: #ccc; color: #333;",children:"Cancel"}),t("button",{onClick:i,style:"flex: 2; background: #4CAF50; color: white;",children:"Add Member"})]})]}),!Ie.value&&t(D,{children:[t("div",{class:"preference-group",children:[t("button",{class:`preference-btn singles ${we.value==="singles"?"selected":""}`,onClick:()=>{we.value="singles"},children:"Singles Only"}),t("button",{class:`preference-btn ${we.value==="both"?"selected":""}`,onClick:()=>{we.value="both"},children:"Either"}),t("button",{class:`preference-btn doubles ${we.value==="doubles"?"selected":""}`,onClick:()=>{we.value="doubles"},children:"Doubles Only"})]}),t("div",{class:"time-slots",children:[t("h3",{children:"Available Time (optional)"}),t("div",{style:"display: flex; gap: 6px; margin-bottom: 12px; flex-wrap: wrap;",children:[t("button",{class:"time-preset-btn",onClick:()=>a("08:00","12:00"),children:["Morning",t("br",{}),t("small",{children:"8am-12pm"})]}),t("button",{class:"time-preset-btn",onClick:()=>a("12:00","15:00"),children:["Midday",t("br",{}),t("small",{children:"12-3pm"})]}),t("button",{class:"time-preset-btn",onClick:()=>a("15:00","18:00"),children:["Afternoon",t("br",{}),t("small",{children:"3-6pm"})]}),t("button",{class:"time-preset-btn",onClick:()=>a("18:00","21:00"),children:["Evening",t("br",{}),t("small",{children:"6-9pm"})]})]}),t("div",{style:"display: flex; gap: 8px; align-items: center; flex-wrap: wrap;",children:[t("input",{type:"time",value:Me.value,onInput:l=>{Me.value=l.target.value},style:"flex: 1; min-width: 120px; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;"}),t("span",{style:"color: #666;",children:"to"}),t("input",{type:"time",value:De.value,onInput:l=>{De.value=l.target.value},style:"flex: 1; min-width: 120px; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;"}),t("button",{onClick:()=>{Me.value="",De.value=""},style:"padding: 10px 12px; background: #f5f5f5; color: #666; font-size: 13px;",children:"Clear"})]})]}),t("div",{class:"rotation-option",style:"margin-bottom: 16px; padding: 12px; background: #f9f9f9; border-radius: 8px;",children:[t("label",{style:"display: flex; align-items: center; gap: 4px; cursor: pointer; font-size: 14px;",children:[t("input",{type:"checkbox",checked:Zt.value,onChange:l=>{Zt.value=l.target.checked},style:"width: 18px; height: 18px; cursor: pointer; margin-right: 4px;"}),t("span",{children:"Willing to play 3-player rotation (1v1 or 1v2 format)"})]}),t("div",{style:"font-size: 12px; color: #666; margin-top: 4px; margin-left: 26px;",children:"If unchecked, you'll only be placed in doubles or singles matches"})]}),t("div",{style:"display: flex; gap: 10px; margin-top: 16px;",children:[t("button",{onClick:o,style:"flex: 1; background: #f5f5f5; color: #666;",children:"Cancel"}),t("button",{onClick:n,style:"flex: 2; background: #4CAF50; color: white;",children:"Check In"})]})]})]})]})}const mt=m({}),Kt=m(null),zn=m(!1);function go(e){return{0:"â˜€ï¸ Clear sky",1:"ðŸŒ¤ï¸ Mainly clear",2:"â›… Partly cloudy",3:"â˜ï¸ Overcast",45:"ðŸŒ«ï¸ Foggy",48:"ðŸŒ«ï¸ Foggy",51:"ðŸŒ¦ï¸ Light drizzle",53:"ðŸŒ¦ï¸ Drizzle",55:"ðŸŒ§ï¸ Heavy drizzle",61:"ðŸŒ§ï¸ Light rain",63:"ðŸŒ§ï¸ Rain",65:"ðŸŒ§ï¸ Heavy rain",71:"ðŸŒ¨ï¸ Light snow",73:"ðŸŒ¨ï¸ Snow",75:"ðŸŒ¨ï¸ Heavy snow",77:"ðŸŒ¨ï¸ Snow grains",80:"ðŸŒ¦ï¸ Rain showers",81:"ðŸŒ§ï¸ Rain showers",82:"â›ˆï¸ Heavy rain showers",85:"ðŸŒ¨ï¸ Snow showers",86:"ðŸŒ¨ï¸ Heavy snow showers",95:"â›ˆï¸ Thunderstorm",96:"â›ˆï¸ Thunderstorm with hail",99:"â›ˆï¸ Severe thunderstorm"}[e]||"ðŸŒ¡ï¸ Weather"}async function ra(e,n,i){const o=`${e},${n},${i}`;if(mt.value[o])return mt.value[o];try{const r=`https://api.open-meteo.com/v1/forecast?latitude=${e}&longitude=${n}&daily=temperature_2m_max,temperature_2m_min,precipitation_probability_max,weathercode&temperature_unit=fahrenheit&timezone=America/Los_Angeles&forecast_days=14`,a=await fetch(r);if(!a.ok)throw new Error("Weather API error");const l=await a.json();if(!l.daily||!l.daily.time||!Array.isArray(l.daily.time))throw new Error("Invalid weather data format");const s=l.daily.time.indexOf(i);if(s===-1)throw new Error("Weather data not available for this date");const d={tempMax:Math.round(l.daily.temperature_2m_max[s]),tempMin:Math.round(l.daily.temperature_2m_min[s]),precipProb:l.daily.precipitation_probability_max[s]||0,weatherCode:l.daily.weathercode[s]};return mt.value={...mt.value,[o]:d},d}catch(r){console.error("Weather fetch error:",r)}return null}function aa(){if(B(()=>{const i=de(()=>{const o=R.value,r=E.value.location;if(!o)return;const a=new Date;a.setHours(0,0,0,0);const l=new Date(o+"T00:00:00"),s=Math.floor((l.getTime()-a.getTime())/(1e3*60*60*24));if(s<0||s>=14){Kt.value=null;return}const d=r?.lat??37.2358,u=r?.lon??-121.9623;zn.value=!0,ra(d,u,o).then(f=>{Kt.value=f,zn.value=!1})});return()=>i()},[]),zn.value)return t("div",{id:"weatherWidget",style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px 14px",background:"linear-gradient(135deg, #e3f2fd 0%, #f0f4ff 100%)",borderRadius:"10px",marginBottom:"16px",fontSize:"13px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)",color:"#666"},children:"Loading weather..."});if(!Kt.value)return null;const e=Kt.value,n=E.value.location?.name||"Los Gatos, CA";return t("div",{id:"weatherWidget",style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 14px",background:"linear-gradient(135deg, #e3f2fd 0%, #f0f4ff 100%)",borderRadius:"10px",marginBottom:"16px",fontSize:"13px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[t("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t("span",{style:{fontWeight:600,color:"#1976d2"},children:n}),t("span",{style:{color:"#666"},children:"â€¢"}),t("span",{style:{color:"#666"},children:go(e.weatherCode)})]}),t("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[t("span",{style:{fontWeight:600,color:"#333"},children:[e.tempMin,"Â°-",e.tempMax,"Â°F"]}),e.precipProb>0&&t("span",{style:{color:"#1976d2"},children:["ðŸ’§",e.precipProb,"%"]})]})]})}function se(e){return e.toLowerCase().replace(/\s+/g,"")}function la(e){switch(e){case"singles":return"Singles";case"doubles":return"Doubles";default:return"Either"}}const ri=m(!1),tt=m(null),Se=m("both"),Bt=m(""),Ot=m(""),pn=m(!0),ai=m(!1),hn=m(null),ge=m(""),ie=m(!1),bt=m("confirm"),Z=m(""),li=m(""),jt=m(null),nt=m(!1),q=m(null),J=m(null);typeof document<"u"&&document.addEventListener("click",e=>{if(jt.value){const n=e.target;!n.closest(".share-dropdown")&&!n.closest("[data-share-button]")&&(jt.value=null)}});function sa(e){const n=Qo(e,k.value);n&&(hn.value=e,ge.value=n.personName,ie.value=n.isOwner,bt.value="confirm",Z.value=R.value||"",li.value=H.value,ai.value=!0)}function rn(){ai.value=!1,hn.value=null,ge.value="",ie.value=!1,bt.value="confirm",Z.value="",li.value=""}async function ca(){const e=hn.value;if(e===null)return;const n=ge.value,i=ie.value,o=Z.value;hn.value=null,await Xo(e,k.value),rn(),me.value={action:"removal",name:n,date:o,isOwner:i},oe.value=!0}function da(e){const n=xo.value[e];n&&(tt.value=e,Se.value=n.playStyle||"both",Bt.value=n.timeRange?.start||"",Ot.value=n.timeRange?.end||"",pn.value=n.allowRotation!==!1,ri.value=!0)}function mo(){ri.value=!1,tt.value=null}async function ua(){if(tt.value===null)return;const e={playStyle:Se.value,allowRotation:pn.value};(Bt.value||Ot.value)&&(e.timeRange={start:Bt.value,end:Ot.value}),await Jo(tt.value,e,k.value),mo()}function pa(e){const n=S.value,i=e.name||"",o=k.value&&se(k.value)===se(i),r=e.addedBy&&k.value&&se(k.value)===se(e.addedBy),a=n&&sessionStorage.getItem(`adminAuth_${n}`)==="true";return!!(o||r||a)}const ha=Ho((...e)=>{const[n,i]=e;or(n,i)},500);function ct({matchKey:e}){const n=V.value[e]||"";return t("div",{style:"padding: 8px 12px;",children:t("input",{type:"text",placeholder:"Add note (court, time, etc.)",value:n,onInput:i=>{const o=i.target.value;ha(e,o)},style:{width:"100%",padding:"8px 12px",border:"1px solid #e0e0e0",borderRadius:"6px",fontSize:"14px",background:"#fafafa"}})})}function xe({checkin:e,globalIndex:n}){const i=k.value&&se(e.name)===se(k.value),o=pa(e);let r="";e.isGuest?r=`guest of ${e.addedBy}`:e.addedBy&&se(e.addedBy)!==se(e.name)&&(r=`added by ${e.addedBy}`);const a=e.timeRange?re(e.timeRange.start,e.timeRange.end):"";return t("div",{class:i?"checkin-item current-user":"checkin-item",children:[t("span",{children:[t("span",{class:"checkin-name",children:[n+1,". ",e.name,i&&t("span",{class:"current-user-badge",children:"YOU"}),r&&t("span",{class:"guest-indicator",children:[" ",r]}),a&&t("span",{class:"time-badge",children:a}),e.allowRotation===!1&&t("span",{class:"time-badge",style:"background: #fff3e0; color: #e65100;",children:"No 3s"})]}),t("span",{class:`preference-badge ${e.playStyle||"both"}`,children:la(e.playStyle||"both")}),t("span",{class:"checkin-time",children:ao(e.timestamp)})]}),o&&t("div",{style:"display: flex; gap: 4px;",children:[t("button",{class:"edit-btn",onClick:()=>da(n),title:"Edit preferences",style:{background:"rgba(76, 175, 80, 0.1)",color:"#4CAF50",border:"none",borderRadius:"50%",padding:"0",width:"28px",height:"28px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:"âœï¸"}),t("button",{class:"remove-btn",onClick:()=>sa(n),title:"Remove check-in",style:{background:"rgba(255, 82, 82, 0.1)",color:"#e57373",border:"none",borderRadius:"50%",padding:"0",width:"28px",height:"28px",fontSize:"18px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:"Ã—"})]})]})}function fa(e,n){const o=new Date(n+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"}),r=e.players.map(s=>s.name).join(" & "),a=S.value,l=`${window.location.origin}${window.location.pathname}#${a}`;if(e.type==="doubles-forming"){const s=e.needed||4-e.players.length;let u=`ðŸŽ¾ ${s===1?"1 more player needed":`${s} more players needed`} for doubles!
`;return u+=`ðŸ“… ${o}
`,u+=`ðŸ‘¥ ${r} ${e.players.length===1?"is":"are"} in

`,u+=`Can you make it? ${l}`,u}else if(e.type==="singles-forming"){const s=e.players[0];let d=`ðŸŽ¾ 1 more player needed for singles!
`;return d+=`ðŸ“… ${o}
`,d+=`ðŸ‘¤ ${s.name} is in`,s.timeRange&&(d+=` (${re(s.timeRange.start,s.timeRange.end)})`),d+=`

Can you make it? ${l}`,d}return""}function An(e,n,i){const o=fa(e,n);if(i==="whatsapp"){const r=encodeURIComponent(o);window.open(`https://wa.me/?text=${r}`,"_blank")}else if(i==="sms"){const r=encodeURIComponent(o);window.open(`sms:?body=${r}`,"_blank")}else i==="copy"&&navigator.clipboard.writeText(o).then(()=>{_("Message copied!","success")}).catch(()=>{_("Failed to copy","error")});jt.value=null}function zi({match:e,matchKey:n}){const i=R.value||"",o=jt.value===n;return t("div",{style:"position: relative; display: inline-block;",children:[t("button",{"data-share-button":!0,onClick:r=>{r.stopPropagation(),jt.value=o?null:n},style:{background:o?"#e65100":"#ff9800",border:"none",borderRadius:"16px",padding:"6px 14px",fontSize:"13px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:"white",transition:"all 0.2s",boxShadow:"0 2px 6px rgba(255, 152, 0, 0.4)"},children:[t("span",{children:"Invite"}),t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",style:{transform:o?"rotate(180deg)":"none",transition:"transform 0.2s"},children:t("path",{d:"M7 10l5 5 5-5z"})})]}),o&&t("div",{class:"share-dropdown",style:{position:"absolute",top:"100%",right:"0",marginTop:"4px",background:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:100,overflow:"hidden",minWidth:"140px"},children:[t("button",{onClick:()=>An(e,i,"whatsapp"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#25D366"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp"]}),t("button",{onClick:()=>An(e,i,"sms"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#2196F3",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"})}),"SMS"]}),t("button",{onClick:()=>An(e,i,"copy"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#666",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),"Copy"]})]})]})}function ga(e,n,i){let a=`${new Date(i+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}
`,l=0,s=0;e.forEach(g=>{if(g.type==="doubles"){const y=g.players.map(b=>b.name);a+=`Doubles: ${y.join(", ")}
`;const v=g.players.filter(b=>b.timeRange).map(b=>re(b.timeRange.start,b.timeRange.end));v.length>0&&(a+=`${v[0]}
`);const x=`doubles-${g.number}`;V.value[x]&&(a+=`ðŸ“ ${V.value[x]}
`),a+=`
`}else if(g.type==="singles"){l++;const y=g.players.map(C=>C.name);a+=`Singles: ${y.join(", ")}
`;const v=g.players.every(C=>(C.playStyle||"both")==="both"),x=g.players.some(C=>C.allowRotation===!0);v&&x&&(a+=`Open to more players
`);const b=g.players.filter(C=>C.timeRange).map(C=>re(C.timeRange.start,C.timeRange.end));b.length>0&&(a+=`${b[0]}
`);const w=`singles-${l}`;V.value[w]&&(a+=`ðŸ“ ${V.value[w]}
`),a+=`
`}else if(g.type==="singles-or-practice"){s++,a+=`Rotation: ${g.players.map(x=>x.name).join(", ")}
`;const y=g.players.filter(x=>x.timeRange).map(x=>re(x.timeRange.start,x.timeRange.end));y.length>0&&(a+=`${y[0]}
`);const v=`rotation-${s}`;V.value[v]&&(a+=`ðŸ“ ${V.value[v]}
`),a+=`
`}else if(g.type==="doubles-forming"){const y=g.players.map(w=>w.name),v=g.needed===1?"need 1 more":`need ${g.needed} more`;a+=`Doubles (forming): ${y.join(", ")}
`,a+=`${v}
`,g.canRotate?a+=`Can rotate if no 4th
`:g.canPlaySingles&&(g.eitherCount||0)>=2?a+=`Will play singles if no more join
`:(g.eitherCount||0)===1&&g.players.length===1&&(a+=`Can play singles if 1 more joins
`);const x=g.players.filter(w=>w.timeRange).map(w=>re(w.timeRange.start,w.timeRange.end));x.length>0&&(a+=`${x[0]}
`);const b="doubles-forming-1";V.value[b]&&(a+=`ðŸ“ ${V.value[b]}
`),a+=`
`}else if(g.type==="singles-forming"){const y=g.players[0];a+=`Singles (forming): ${y.name}
`,a+=`need 1 more
`,y.timeRange&&(a+=`${re(y.timeRange.start,y.timeRange.end)}
`),a+=`
`}});const d=e.filter(g=>g.type==="waiting");if(d.length>0){const g=d.flatMap(y=>y.players.map(v=>v.name));g.length>0&&(a+=`Standby: ${g.join(", ")}
`)}const u=E.value.location,f=u?.lat??37.2358,p=u?.lon??-121.9623,h=`${f},${p},${i}`,c=mt.value[h];if(c){const g=go(c.weatherCode);a+=`${g}, ${c.tempMax}Â°F`}return a.trim()}function ma(e,n,i){const o=ga(e,n,i),r=encodeURIComponent(o);window.open(`https://wa.me/?text=${r}`,"_blank")}function va(){const e=R.value;e&&confirm(`Are you sure you want to reset all check-ins for ${G(e)}?

This cannot be undone.`)&&ir()}function be(e,n){return e.findIndex(i=>se(i.name)===se(n.name)&&i.timestamp===n.timestamp)}function ya(e,n){const i={matches:{},unassigned:[]};let o=0,r=0;return e.forEach(a=>{const l=a.players.map(s=>s.name);if(a.type==="doubles"||a.type==="doubles-forming"){o++;const s=`doubles-${o}`;i.matches[s]={players:l,note:V.value[s]||""}}else if(a.type==="singles"||a.type==="singles-forming"||a.type==="singles-or-practice"){r++;const s=`singles-${r}`;i.matches[s]={players:l,note:V.value[s]||""}}else a.type==="waiting"&&i.unassigned.push(...l)}),i}function Ai(e,n){if(!nt.value||!J.value)return;const i=q.value;if(!i)q.value={name:e,matchKey:n};else if(i.name===e&&i.matchKey===n)q.value=null;else{const o=J.value,r={...o.matches},a=[...o.unassigned];if(i.matchKey==="unassigned"){const l=a.indexOf(i.name);l>-1&&a.splice(l,1)}else{const l=r[i.matchKey];l&&(l.players=l.players.filter(s=>s!==i.name))}if(n==="unassigned"){const l=a.indexOf(e);l>-1&&a.splice(l,1)}else{const l=r[n];l&&(l.players=l.players.filter(s=>s!==e))}n==="unassigned"?a.push(i.name):r[n].players.push(i.name),i.matchKey==="unassigned"?a.push(e):r[i.matchKey].players.push(e),J.value={matches:r,unassigned:a},q.value=null,_(`Swapped ${i.name} and ${e}`,"info")}}function xa(e,n){try{P.value&&P.value.matches&&typeof P.value.matches=="object"?J.value={matches:{...P.value.matches},unassigned:Array.isArray(P.value.unassigned)?[...P.value.unassigned]:[]}:J.value=ya(e,n),q.value=null,nt.value=!0}catch(i){console.error("Error starting arrange mode:",i),J.value={matches:{},unassigned:n.map(o=>o.name)},q.value=null,nt.value=!0}}function vo(){nt.value=!1,q.value=null,J.value=null}async function ba(){J.value&&(await ar(J.value),nt.value=!1,q.value=null,J.value=null)}async function wa(){await lr(),vo()}function _a(){sr();const e=xo.value,n=R.value||"",i=tt.value!==null?e[tt.value]:null,o=S.value,r=o&&sessionStorage.getItem(`adminAuth_${o}`)==="true",a=nt.value,l=!!(P.value&&P.value.matches&&Object.keys(P.value.matches).length>0),s=t(D,{children:[t(Ae,{isOpen:ri.value,onClose:mo,title:`Edit ${i?.name||""}'s Preferences`,children:t("div",{style:"display: flex; flex-direction: column; gap: 16px;",children:[t("div",{children:[t("label",{style:"display: block; font-weight: 500; margin-bottom: 8px;",children:"Play Style"}),t("div",{style:"display: flex; gap: 8px;",children:["singles","doubles","both"].map(c=>t("button",{onClick:()=>{Se.value=c},style:{flex:1,padding:"10px",border:Se.value===c?"2px solid #4CAF50":"2px solid #e0e0e0",borderRadius:"8px",background:Se.value===c?"#E8F5E9":"#fff",color:Se.value===c?"#2E7D32":"#666",cursor:"pointer",fontWeight:Se.value===c?"600":"400"},children:c==="singles"?"Singles":c==="doubles"?"Doubles":"Either"},c))})]}),t("div",{children:[t("label",{style:"display: block; font-weight: 500; margin-bottom: 8px;",children:"Available Time (optional)"}),t("div",{style:"display: flex; gap: 8px; align-items: center;",children:[t("input",{type:"time",value:Bt.value,onInput:c=>{Bt.value=c.target.value},style:"flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 6px;"}),t("span",{children:"to"}),t("input",{type:"time",value:Ot.value,onInput:c=>{Ot.value=c.target.value},style:"flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 6px;"})]})]}),Se.value==="singles"&&t("div",{children:[t("label",{style:"display: flex; align-items: center; gap: 8px; cursor: pointer;",children:[t("input",{type:"checkbox",checked:pn.value,onChange:c=>{pn.value=c.target.checked}}),t("span",{children:"Open to 3-player rotation"})]}),t("p",{style:"font-size: 12px; color: #666; margin: 4px 0 0 24px;",children:"If unchecked, you'll only be matched for 2-player singles"})]}),t("button",{onClick:ua,style:{padding:"12px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:"pointer",marginTop:"8px"},children:"Save Changes"})]})}),t(Ae,{isOpen:ai.value,onClose:rn,title:bt.value==="done"?"":ie.value?"Remove Your Check-in?":`Remove ${ge.value}?`,showCloseButton:bt.value!=="done",children:t("div",{style:"display: flex; flex-direction: column; gap: 16px;",children:bt.value==="confirm"?t(D,{children:[ie.value?t(D,{children:[t("p",{style:"color: #666; margin: 0; line-height: 1.5;",children:"Are you sure you want to remove yourself from this date?"}),t("div",{style:"background: #FFF8E1; border-radius: 8px; padding: 12px; border-left: 4px solid #FFB74D;",children:[t("p",{style:"margin: 0 0 8px 0; font-weight: 500; color: #E65100;",children:"Things to consider:"}),t("ul",{style:"margin: 0; padding-left: 20px; color: #666; font-size: 14px;",children:[t("li",{children:"You'll lose your current spot in the check-in order"}),t("li",{children:["If you want to change your preferences, you can ",t("strong",{children:"edit"})," instead"]}),t("li",{children:"You can always check in again after removing"})]})]})]}):t(D,{children:[t("p",{style:"color: #666; margin: 0; line-height: 1.5;",children:["Are you sure you want to remove ",t("strong",{children:ge.value})," from this date?"]}),t("div",{style:"background: #FFF8E1; border-radius: 8px; padding: 12px; border-left: 4px solid #FFB74D;",children:t("p",{style:"margin: 0; color: #666; font-size: 14px;",children:["They will lose their spot in the check-in order. Consider using ",t("strong",{children:"edit"})," to update their preferences instead."]})})]}),t("div",{style:"display: flex; gap: 12px; margin-top: 8px;",children:[t("button",{onClick:rn,style:{flex:1,padding:"12px",background:"#f5f5f5",color:"#666",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),t("button",{onClick:ca,style:{flex:1,padding:"12px",background:"#ef5350",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:"Yes, Remove"})]})]}):t(D,{children:[t("div",{style:"text-align: center; padding: 8px 0;",children:[t("div",{style:"font-size: 48px; margin-bottom: 8px;",children:"âœ“"}),t("p",{style:"color: #666; margin: 0;",children:ie.value?`You've been removed from ${G(Z.value)}`:`${ge.value} has been removed from ${G(Z.value)}`})]}),t("div",{children:[t("p",{style:"margin: 0 0 8px 0; font-size: 13px; color: #666; text-align: center;",children:"Let others know:"}),t("div",{style:"display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;",children:[t("a",{href:`https://wa.me/?text=${encodeURIComponent(ie.value?`I'm out on ${G(Z.value)}.`:`Hi ${ge.value}, I removed you from ${G(Z.value)}. Let me know if you have questions!`)}`,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 16px",background:"#25D366",color:"white",borderRadius:"6px",fontSize:"14px",textDecoration:"none"},children:"WhatsApp"}),t("a",{href:`sms:?body=${encodeURIComponent(ie.value?`I'm out on ${G(Z.value)}.`:`Hi ${ge.value}, I removed you from ${G(Z.value)}. Let me know if you have questions!`)}`,style:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 16px",background:"#007AFF",color:"white",borderRadius:"6px",fontSize:"14px",textDecoration:"none"},children:"Text"}),t("a",{href:`mailto:?subject=${encodeURIComponent(ie.value?`I'm Out on ${G(Z.value)}`:`${li.value} - Check-in Removed`)}&body=${encodeURIComponent(ie.value?`I'm out on ${G(Z.value)}.`:`Hi ${ge.value},

I removed you from ${G(Z.value)}.

Let me know if you have questions!`)}`,style:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 16px",background:"#EA4335",color:"white",borderRadius:"6px",fontSize:"14px",textDecoration:"none"},children:"Email"})]})]}),t("button",{onClick:rn,style:{width:"100%",padding:"12px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:"pointer",marginTop:"8px"},children:"Done"})]})})})]});if(e.length===0)return t(D,{children:[t("div",{class:"empty-state",children:"No check-ins yet"}),s]});const{matches:d,warnings:u}=xn(e),f=d.some(c=>c.type!=="waiting"||c.players.length>0);if(!f&&u.length===0)return t(D,{children:[t("div",{class:"empty-state",children:"No check-ins yet"}),s]});let p=0,h=0;return t(D,{children:[t("div",{class:"games-list",style:"margin-top: 24px; padding-top: 24px; border-top: 2px solid #f0f0f0;",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;",children:[t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("h2",{style:"margin: 0;",children:["Games (",e.length," checked in)"]}),l&&!a&&t("span",{style:{fontSize:"11px",background:"#9C27B0",color:"white",padding:"2px 6px",borderRadius:"4px",fontWeight:"600"},children:"Arranged"})]}),t("div",{style:"display: flex; gap: 8px; align-items: center;",children:a?t(D,{children:[t("button",{onClick:ba,style:{background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"13px",fontWeight:"600",cursor:"pointer"},children:"Save"}),t("button",{onClick:vo,style:{background:"#f5f5f5",color:"#666",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"13px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),l&&t("button",{onClick:wa,style:{background:"rgba(255, 82, 82, 0.1)",color:"#e57373",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"13px",fontWeight:"500",cursor:"pointer"},children:"Reset"})]}):t(D,{children:[f&&t("button",{onClick:()=>ma(d,e,n),title:"Share to WhatsApp",style:{background:"#25D366",color:"white",border:"none",borderRadius:"50%",padding:"0",width:"36px",height:"36px",fontSize:"16px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})})}),r&&e.length>=2&&t("button",{onClick:()=>xa(d,e),title:"Arrange Players",style:{background:"#9C27B0",color:"white",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"13px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",children:t("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})}),"Arrange"]}),r&&e.length>0&&!f&&t("button",{class:"reset-day-btn",onClick:va,title:"Reset This Day",style:{background:"rgba(255, 82, 82, 0.1)",color:"#e57373",border:"none",borderRadius:"50%",padding:"0",width:"36px",height:"36px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]})})]}),a&&t("div",{style:{background:"#F3E5F5",borderRadius:"8px",padding:"12px",marginBottom:"16px",color:"#7B1FA2",fontSize:"14px"},children:[t("strong",{children:"Arrange Mode:"})," Tap a player to select, then tap another player to swap their positions.",q.value&&t("span",{style:{display:"block",marginTop:"4px"},children:["Selected: ",t("strong",{children:q.value.name})," - tap another player to swap"]})]}),a&&J.value&&t(D,{children:[Object.entries(J.value.matches||{}).map(([c,g])=>{const y=c.startsWith("doubles"),v=c.split("-")[1],x=g?.players||[];return x.length===0?null:t("div",{class:"match-group",style:{marginBottom:"16px",border:"2px dashed #9C27B0",borderRadius:"8px",padding:"8px"},children:[t("h3",{style:"margin: 0 0 8px 0;",children:[y?`Doubles ${v}`:`Singles ${v}`,t("span",{style:{fontSize:"12px",color:"#666",marginLeft:"8px"},children:["(",x.length,"/",y?4:2,")"]})]}),t("div",{style:"display: flex; flex-direction: column; gap: 4px;",children:x.map(b=>{const w=q.value?.name===b&&q.value?.matchKey===c;return t("div",{onClick:()=>Ai(b,c),style:{padding:"10px 12px",background:w?"#9C27B0":"#f5f5f5",color:w?"white":"#333",borderRadius:"6px",cursor:"pointer",fontWeight:"500",transition:"all 0.15s",border:w?"2px solid #7B1FA2":"2px solid transparent"},children:b},b)})})]},c)}),J.value.unassigned.length>0&&t("div",{class:"match-group",style:{marginBottom:"16px",border:"2px dashed #9e9e9e",borderRadius:"8px",padding:"8px",background:"#fafafa"},children:[t("h3",{style:"margin: 0 0 8px 0; color: #666;",children:"Unassigned"}),t("div",{style:"display: flex; flex-direction: column; gap: 4px;",children:J.value.unassigned.map(c=>{const g=q.value?.name===c&&q.value?.matchKey==="unassigned";return t("div",{onClick:()=>Ai(c,"unassigned"),style:{padding:"10px 12px",background:g?"#9C27B0":"#fff",color:g?"white":"#333",borderRadius:"6px",cursor:"pointer",fontWeight:"500",transition:"all 0.15s",border:g?"2px solid #7B1FA2":"2px solid #e0e0e0"},children:c},c)})})]})]}),!a&&!l&&u.length>0&&t("div",{class:"warning-box",children:u.map((c,g)=>t("div",{children:c},g))}),!a&&l&&P.value&&P.value.matches&&t(D,{children:[Object.entries(P.value.matches).map(([c,g])=>{const y=c.startsWith("doubles"),v=c.split("-")[1],x=y?4:2,b=g?.players||[],w=b.length>=x,C=b.map($=>e.find(j=>j.name===$)||{name:$,timestamp:0});return t("div",{class:`match-group ${w?"":"forming-group"}`,style:"margin-bottom: 16px;",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;",children:[t("h3",{style:"margin: 0;",children:[y?"Doubles":"Singles"," ",v]}),w?t("span",{style:"display: flex; align-items: center; gap: 4px; color: #4CAF50; font-size: 13px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),"Ready"]}):t("span",{style:"display: flex; align-items: center; gap: 4px; color: #F57C00; font-size: 12px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",children:t("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),"Need ",x-b.length]})]}),t("div",{id:"checkinList",children:C.map($=>{const A=be(e,$);return t(xe,{checkin:$,globalIndex:A>=0?A:-1},A>=0?A:$.name)})}),t(ct,{matchKey:c})]},c)}),P.value.unassigned&&P.value.unassigned.length>0&&t("div",{class:"match-group waiting-group",style:"margin-bottom: 16px;",children:[t("h3",{style:"margin: 0 0 8px 0;",children:"Unassigned"}),t("div",{id:"checkinList",children:P.value.unassigned.map(c=>{const g=e.find(x=>x.name===c),y=g||{name:c,timestamp:0},v=g?be(e,y):-1;return t(xe,{checkin:y,globalIndex:v>=0?v:-1},v>=0?v:c)})})]})]}),!a&&!l&&d.map((c,g)=>{if(c.type==="doubles"){const y=`doubles-${c.number}`;return t("div",{class:"match-group",style:"margin-bottom: 16px;",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;",children:[t("h3",{style:"margin: 0;",children:["Doubles ",c.number]}),t("span",{style:"display: flex; align-items: center; gap: 4px; color: #4CAF50; font-size: 13px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),"Ready"]})]}),t("div",{id:"checkinList",children:c.players.map(v=>{const x=be(e,v);return t(xe,{checkin:v,globalIndex:x},x)})}),t(ct,{matchKey:y})]},g)}if(c.type==="singles"){p++;const y=`singles-${p}`,v=c.players.every(w=>(w.playStyle||"both")==="both"),x=c.players.some(w=>w.allowRotation===!0),b=v&&x;return t("div",{class:"match-group singles-group",style:"margin-bottom: 16px;",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;",children:[t("h3",{style:"margin: 0;",children:["Singles",p>1?` ${p}`:""]}),t("span",{style:"display: flex; align-items: center; gap: 4px; color: #4CAF50; font-size: 13px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),"Ready"]})]}),t("div",{id:"checkinList",children:c.players.map(w=>{const C=be(e,w);return t(xe,{checkin:w,globalIndex:C},C)})}),b&&t("p",{style:"color: #666; font-size: 13px; margin: 8px 0 4px 0; font-style: italic; padding: 0 12px;",children:"Open to more players"}),t(ct,{matchKey:y})]},g)}if(c.type==="singles-or-practice"){h++;const y=`rotation-${h}`;return t("div",{class:"match-group singles-group",style:"margin-bottom: 16px;",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;",children:[t("h3",{style:"margin: 0;",children:"Rotation (3 players)"}),t("span",{style:"display: flex; align-items: center; gap: 4px; color: #4CAF50; font-size: 13px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),"Ready"]})]}),t("div",{id:"checkinList",children:c.players.map(v=>{const x=be(e,v);return t(xe,{checkin:v,globalIndex:x},x)})}),t(ct,{matchKey:y})]},g)}if(c.type==="doubles-forming"){const y="doubles-forming-1",v=c.needed||4-c.players.length;let x="";return c.canRotate?x="Can rotate if no 4th":c.canPlaySingles&&(c.eitherCount||0)>=2?x="Will play singles if no more join":(c.eitherCount||0)===1&&c.players.length===1&&(x="Can play singles if 1 more joins"),t("div",{class:"match-group forming-group",style:"margin-bottom: 16px;",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;",children:[t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("h3",{style:"margin: 0;",children:"Doubles"}),t("span",{style:"display: flex; align-items: center; gap: 4px; color: #F57C00; font-size: 12px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",children:t("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),"Need ",v]})]}),t(zi,{match:c,matchKey:y,needed:v})]}),t("div",{id:"checkinList",children:c.players.map(b=>{const w=be(e,b);return t(xe,{checkin:b,globalIndex:w},w)})}),x&&t("p",{style:"color: #666; font-size: 13px; margin: 8px 0 4px 0; font-style: italic; padding: 0 12px;",children:x}),t(ct,{matchKey:y})]},g)}return c.type==="singles-forming"?t("div",{class:"match-group forming-group",style:"margin-bottom: 16px;",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;",children:[t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("h3",{style:"margin: 0;",children:"Singles"}),t("span",{style:"display: flex; align-items: center; gap: 4px; color: #F57C00; font-size: 12px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",children:t("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),"Need 1"]})]}),t(zi,{match:c,matchKey:"singles-forming-1",needed:1})]}),t("div",{id:"checkinList",children:c.players.map(v=>{const x=be(e,v);return t(xe,{checkin:v,globalIndex:x},x)})})]},g):c.type==="waiting"?t("div",{class:"match-group waiting-group",style:"margin-bottom: 16px;",children:[t("h3",{style:"margin: 0 0 8px 0;",children:"Waiting for Match"}),t("div",{id:"checkinList",children:c.players.map(y=>{const v=be(e,y);return t(xe,{checkin:y,globalIndex:v},v)})})]},g):null})]}),s]})}function ka(){return t("div",{children:[t(ia,{}),t(aa,{}),t(oa,{}),t(_a,{})]})}function Be(e,n){const i=e.replace(/-/g,"");if(n){const o=n.replace(":","")+"00";return`${i}T${o}`}return i}function In(e){return e.replace(/\\/g,"\\\\").replace(/;/g,"\\;").replace(/,/g,"\\,").replace(/\n/g,"\\n")}function Ca(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}@tenniscoordinator`}function Sa(e){const{date:n,title:i,description:o,location:r,startTime:a,endTime:l}=e,s=Ca(),u=new Date().toISOString().replace(/[-:]/g,"").split(".")[0]+"Z";let f=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Tennis Coordinator//EN","CALSCALE:GREGORIAN","METHOD:PUBLISH","BEGIN:VEVENT",`UID:${s}`,`DTSTAMP:${u}`];if(a&&l)f.push(`DTSTART:${Be(n,a)}`),f.push(`DTEND:${Be(n,l)}`);else if(a){f.push(`DTSTART:${Be(n,a)}`);const[p,h]=a.split(":").map(Number),g=`${((p+2)%24).toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`;f.push(`DTEND:${Be(n,g)}`)}else{f.push(`DTSTART;VALUE=DATE:${Be(n)}`);const p=new Date(n+"T00:00:00");p.setDate(p.getDate()+1);const h=p.toISOString().split("T")[0];f.push(`DTEND;VALUE=DATE:${Be(h)}`)}return f.push(`SUMMARY:${In(i)}`),f.push(`DESCRIPTION:${In(o)}`),r&&f.push(`LOCATION:${In(r)}`),f.push("END:VEVENT"),f.push("END:VCALENDAR"),f.join(`\r
`)}function $a(){return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)}function za(e){const{date:n,title:i,description:o,location:r,startTime:a,endTime:l}=e;let s;if(a&&l){const f=`${n.replace(/-/g,"")}T${a.replace(":","")}00`,p=`${n.replace(/-/g,"")}T${l.replace(":","")}00`;s=`${f}/${p}`}else if(a){const[f,p]=a.split(":").map(Number),c=`${((f+2)%24).toString().padStart(2,"0")}${p.toString().padStart(2,"0")}00`,g=`${n.replace(/-/g,"")}T${a.replace(":","")}00`,y=`${n.replace(/-/g,"")}T${c}`;s=`${g}/${y}`}else{const f=n.replace(/-/g,""),p=new Date(n+"T00:00:00");p.setDate(p.getDate()+1);const h=p.toISOString().split("T")[0].replace(/-/g,"");s=`${f}/${h}`}const d="https://calendar.google.com/calendar/render",u=new URLSearchParams({action:"TEMPLATE",text:i,dates:s,details:o});return r&&u.set("location",r),`${d}?${u.toString()}`}function Aa(e,n){if($a()){const i=za(e);window.open(i,"_blank")}else{const i=Sa(e),o=new Blob([i],{type:"text/calendar;charset=utf-8"}),r=URL.createObjectURL(o),a=document.createElement("a");a.href=r,a.download=`tennis-${e.date}.ics`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}}function Ia(e){const{date:n,matchType:i,players:o,groupName:r,location:a,notes:l}=e,d=`${i.includes("doubles")?"Doubles":i.includes("singles")?"Singles":"Tennis"} - ${r}`;let u=`Players: ${o.map(c=>c.name).join(", ")}`;l&&(u+=`

Notes: ${l}`);let f,p;const h=o.filter(c=>c.timeRange);if(h.length>0){const c=h.map(y=>y.timeRange.start).sort(),g=h.map(y=>y.timeRange.end).sort();f=c[c.length-1],p=g[0],f>=p&&(f=h[0].timeRange.start,p=h[0].timeRange.end)}return{date:n,title:d,description:u,location:a,startTime:f,endTime:p}}const Wt=m(null),Ce=m(null),fn=m(!1),it=m(new Set),wt=m(!1);function Ma(){const e=S.value;return e?sessionStorage.getItem(`adminAuth_${e}`)==="true":!1}typeof document<"u"&&document.addEventListener("click",e=>{if(Wt.value){const n=e.target;!n.closest(".share-dropdown")&&!n.closest("[data-share-button]")&&(Wt.value=null)}});function _t(e){return e.toLowerCase().replace(/\s+/g,"")}const Da=Xe(()=>{const e=Ce.value||k.value;if(!e)return[];const n=_t(e),i=[],o=new Date;o.setHours(0,0,0,0);const r=Object.keys(Q.value).sort();for(const a of r){if(new Date(a+"T00:00:00")<o)continue;const s=Q.value[a]||[];if(s.length===0)continue;const d={},u=L.value||{};for(const[p,h]of Object.entries(u))h&&typeof h=="object"&&(d[_t(p)]={include:h.include||[],exclude:h.exclude||[]});const f=xn(s,d);for(const p of f.matches)if(p.players.map(c=>_t(c.name)).includes(n)){const c=p.type==="doubles-forming"||p.type==="singles-forming";i.push({date:a,type:p.type,matchNumber:p.number||1,players:p.players.map(g=>({name:g.name,timeRange:g.timeRange})),isForming:c,needed:p.needed})}}return i});function Vn(e){switch(e){case"doubles":case"doubles-forming":return"Doubles";case"singles":case"singles-forming":return"Singles";case"rotation":case"singles-or-practice":return"Rotation";default:return e}}function Ra(e){const i=new Date(e.date+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"}),o=e.players.map(l=>l.name).join(" & "),r=S.value,a=`${window.location.origin}${window.location.pathname}#${r}`;if(e.type==="doubles-forming"){const l=e.needed||4-e.players.length;let d=`ðŸŽ¾ ${l===1?"1 more player needed":`${l} more players needed`} for doubles!
`;return d+=`ðŸ“… ${i}
`,d+=`ðŸ‘¥ ${o} ${e.players.length===1?"is":"are"} in

`,d+=`Can you make it? ${a}`,d}else if(e.type==="singles-forming"){const l=e.players[0];let s=`ðŸŽ¾ 1 more player needed for singles!
`;return s+=`ðŸ“… ${i}
`,s+=`ðŸ‘¤ ${l.name} is in`,l.timeRange&&(s+=` (${re(l.timeRange.start,l.timeRange.end)})`),s+=`

Can you make it? ${a}`,s}return""}function Mn(e,n){const i=Ra(e);if(n==="whatsapp"){const o=encodeURIComponent(i);window.open(`https://wa.me/?text=${o}`,"_blank")}else if(n==="sms"){const o=encodeURIComponent(i);window.open(`sms:?body=${o}`,"_blank")}else n==="copy"&&navigator.clipboard.writeText(i).then(()=>{_("Message copied!","success")}).catch(()=>{_("Failed to copy","error")});Wt.value=null}function Ii(e){fn.value||(R.value=e,ae.value="checkin")}function Ta(e){const n=`${e.type.replace("-forming","")}-${e.matchNumber}`,i=V.value[n]||"",o=Ia({date:e.date,matchType:e.type,players:e.players,groupName:H.value||"Tennis",location:E.value.location?.name,notes:i});Aa(o),_("Calendar event downloaded","success")}function Pa(e){const n=new Set(it.value);n.has(e)?n.delete(e):n.add(e),it.value=n}function Ea(){fn.value=!1,it.value=new Set,wt.value=!1}function Fa(e,n){const i=S.value,o=`${window.location.origin}${window.location.pathname}#${i}`,r=e.filter((d,u)=>{const f=`mygames-${d.date}-${d.type}-${u}`;return n.has(f)});if(r.length===0)return"";const a=r.filter(d=>!d.isForming),l=r.filter(d=>d.isForming);let s=`ðŸŽ¾ Tennis Update

`;if(a.length>0){s+=`âœ… Ready to Play:
`;for(const d of a){const f=new Date(d.date+"T00:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),p=Vn(d.type),h=d.players.map(c=>c.name).join(", ");s+=`â€¢ ${f} - ${p}
  ${h}
`}s+=`
`}if(l.length>0){s+=`ðŸŸ¡ Need Players:
`;for(const d of l){const f=new Date(d.date+"T00:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),p=Vn(d.type),h=d.needed||1,c=d.players.map(g=>g.name).join(", ");s+=`â€¢ ${f} - ${p} needs ${h}
  ${c}
`}s+=`
`}return s+=`Check in: ${o}`,s}function qt(e,n){const i=Fa(n,it.value);if(!i){_("No games selected","error");return}if(e==="native"&&navigator.share)navigator.share({title:"Tennis Update",text:i}).catch(()=>{navigator.clipboard.writeText(i).then(()=>{_("Copied to clipboard","success")})});else if(e==="whatsapp"){const o=encodeURIComponent(i);window.open(`https://wa.me/?text=${o}`,"_blank")}else if(e==="sms"){const o=encodeURIComponent(i);window.open(`sms:?body=${o}`,"_blank")}else navigator.clipboard.writeText(i).then(()=>{_("Copied to clipboard","success")}).catch(()=>{_("Failed to copy","error")});wt.value=!1}function Na(){const e=Da.value,n=Ma(),i=Ce.value||k.value,o=Ce.value&&Ce.value!==k.value,r=it.value.size,a=fn.value;return t("div",{style:"padding: 16px 0;",children:[a&&t("div",{style:{position:"fixed",bottom:"70px",left:"50%",transform:"translateX(-50%)",width:"calc(100% - 32px)",maxWidth:"400px",background:"white",borderRadius:"16px",padding:"12px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px",zIndex:100,boxShadow:"0 4px 16px rgba(0,0,0,0.15)"},children:[t("button",{onClick:Ea,style:{background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",cursor:"pointer",color:"#666"},children:"Cancel"}),t("span",{style:{fontSize:"14px",color:"#666"},children:[r," selected"]}),t("div",{style:{position:"relative"},children:[t("button",{onClick:()=>{wt.value=!wt.value},disabled:r===0,style:{background:r>0?"#4CAF50":"#ccc",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",fontWeight:"600",cursor:r>0?"pointer":"default",color:"white",display:"flex",alignItems:"center",gap:"6px"},children:["Share",t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"})})]}),wt.value&&r>0&&t("div",{style:{position:"absolute",bottom:"100%",right:"0",marginBottom:"8px",background:"white",borderRadius:"12px",boxShadow:"0 4px 16px rgba(0,0,0,0.2)",overflow:"hidden",minWidth:"160px"},children:[typeof navigator.share=="function"&&t("button",{onClick:()=>qt("native",e),style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 16px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#333"},children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#4CAF50",children:t("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"})}),"Share..."]}),t("button",{onClick:()=>qt("whatsapp",e),style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 16px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#25D366",borderTop:typeof navigator.share=="function"?"1px solid #f0f0f0":"none"},children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",children:t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp"]}),t("button",{onClick:()=>qt("sms",e),style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 16px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#2196F3",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",children:t("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"})}),"SMS"]}),t("button",{onClick:()=>qt("copy",e),style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 16px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#666",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",children:t("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),"Copy text"]})]})]})]}),t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;",children:[t("h2",{style:"margin: 0; font-size: 20px;",children:o?`${Ce.value}'s Games`:"My Upcoming Games"}),t("div",{style:"display: flex; gap: 8px; align-items: center;",children:[o&&t("button",{onClick:()=>{Ce.value=null},style:{background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"16px",padding:"4px 12px",fontSize:"12px",cursor:"pointer",color:"#666"},children:"Back to mine"}),!o&&e.length>0&&!a&&t("button",{onClick:()=>{fn.value=!0},style:{background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"16px",padding:"6px 12px",fontSize:"13px",cursor:"pointer",color:"#666",display:"flex",alignItems:"center",gap:"6px"},children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"})}),"Share"]})]})]}),n&&!o&&t("div",{style:{background:"#f5f5f5",borderRadius:"8px",padding:"12px",marginBottom:"16px"},children:[t("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"6px",fontWeight:"500"},children:"View another member's games"}),t("select",{value:"",onChange:l=>{const s=l.target.value;s&&(Ce.value=s)},style:{marginBottom:0},children:[t("option",{value:"",children:"Select a member..."}),Y.value.filter(l=>l!==k.value).sort((l,s)=>l.localeCompare(s)).map(l=>t("option",{value:l,children:l},l))]})]}),e.length===0?t("div",{style:"text-align: center; padding: 48px 24px; background: #f9f9f9; border-radius: 12px;",children:[t("div",{style:"font-size: 48px; margin-bottom: 16px;",children:"ðŸ“…"}),t("p",{style:"font-size: 18px; margin: 0 0 8px 0; color: #333;",children:"No upcoming games"}),t("p",{style:"font-size: 14px; color: #666; margin: 0;",children:o?`${Ce.value} has no upcoming games.`:"Check in for a date to get matched with other players!"})]}):t("div",{style:"display: flex; flex-direction: column; gap: 12px;",children:e.map((l,s)=>{const d=l.players.filter(c=>_t(c.name)!==_t(i)),u=`mygames-${l.date}-${l.type}-${s}`,f=Wt.value===u,p=l.needed||1,h=it.value.has(u);return t("div",{onClick:()=>{a&&Pa(u)},style:{padding:"16px",background:l.isForming?"#FFF8E1":"#E8F5E9",borderRadius:"12px",border:a&&h?"2px solid #4CAF50":l.isForming?"1px solid #FFE082":"1px solid #A5D6A7",cursor:a?"pointer":"default",position:"relative"},children:[a&&t("div",{style:{position:"absolute",top:"12px",right:"12px",width:"24px",height:"24px",borderRadius:"6px",border:h?"none":"2px solid #ccc",background:h?"#4CAF50":"white",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"16px",fontWeight:"bold"},children:h&&"âœ“"}),t("div",{onClick:c=>{a||(c.stopPropagation(),Ii(l.date))},style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer",paddingRight:a?"32px":"0"},children:[t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("span",{style:"font-weight: 600; color: #333; font-size: 16px;",children:G(l.date)}),t("span",{style:{fontSize:"12px",padding:"2px 8px",borderRadius:"10px",background:"#f0f0f0",color:"#666",fontWeight:"500"},children:Vn(l.type)})]}),t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[l.isForming?t("span",{style:"display: flex; align-items: center; gap: 4px; color: #F57C00; font-size: 12px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",children:t("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),"Need ",p]}):t("span",{style:"display: flex; align-items: center; gap: 4px; color: #4CAF50; font-size: 12px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",children:t("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),"Ready"]}),!a&&t("button",{onClick:c=>{c.stopPropagation(),Ta(l)},title:"Add to Calendar",style:{background:"transparent",border:"none",padding:"4px",cursor:"pointer",color:"#888",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",transition:"color 0.2s"},onMouseOver:c=>{c.currentTarget.style.color="#4CAF50"},onMouseOut:c=>{c.currentTarget.style.color="#888"},children:t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"})})})]})]}),t("div",{onClick:c=>{a||(c.stopPropagation(),Ii(l.date))},style:{fontSize:"15px",color:"#555",cursor:"pointer",paddingRight:a?"32px":"0"},children:d.length>0?t(D,{children:[t("span",{style:"color: #888;",children:"Playing with "}),t("span",{style:"font-weight: 500;",children:d.map(c=>c.name).join(", ")})]}):t("span",{style:"color: #888; font-style: italic;",children:["Waiting for ",p," more player",p>1?"s":""]})}),!a&&l.isForming&&t("div",{style:"margin-top: 12px; display: flex; gap: 8px; align-items: center; position: relative;",children:[t("button",{"data-share-button":!0,onClick:c=>{c.stopPropagation(),Wt.value=f?null:u},style:{background:f?"#e65100":"#ff9800",border:"none",borderRadius:"16px",padding:"6px 14px",fontSize:"13px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:"white",transition:"all 0.2s",boxShadow:"0 2px 6px rgba(255, 152, 0, 0.4)"},children:[t("span",{children:"Invite"}),t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",style:{transform:f?"rotate(180deg)":"none",transition:"transform 0.2s"},children:t("path",{d:"M7 10l5 5 5-5z"})})]}),f&&t("div",{class:"share-dropdown",style:{position:"absolute",bottom:"100%",left:"0",marginBottom:"4px",background:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:100,overflow:"hidden",minWidth:"140px"},children:[t("button",{onClick:c=>{c.stopPropagation(),Mn(l,"whatsapp")},style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#25D366"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp"]}),t("button",{onClick:c=>{c.stopPropagation(),Mn(l,"sms")},style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#2196F3",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"})}),"SMS"]}),t("button",{onClick:c=>{c.stopPropagation(),Mn(l,"copy")},style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#666",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),"Copy"]})]})]})]},s)})}),e.length>0&&t("p",{style:"font-size: 13px; color: #888; text-align: center; margin-top: 16px;",children:"Tap a game to view that day's details"})]})}const Jt=m(!1),Dn=m(!1),Ge=m(!1),Ve=m(!1),ee=m([]);function yo(e){return e.toLowerCase().replace(/\s+/g,"")}async function La(){const e=S.value,n=k.value;if(!(!e||!n))try{const a=(await T().ref(`groups/${e}/userNotifications/${yo(n)}/preferences`).once("value")).val()||{};Ge.value=a.activityAlerts===!0,Ve.value=a.matchConfirmations!==!1,ee.value=a.unwatchedMembers||a.mutedMembers||[]}catch(i){console.error("Error loading notification prefs from Firebase:",i)}}async function Ht(){const e=S.value,n=k.value;if(!e||!n)return;const i={activityAlerts:Ge.value,matchConfirmations:Ve.value,unwatchedMembers:ee.value};try{await T().ref(`groups/${e}/userNotifications/${yo(n)}/preferences`).set(i),_("Preferences saved","success")}catch(o){console.error("Error saving notification prefs:",o),_("Failed to save preferences","error")}}function Ba(e){ee.value.includes(e)?ee.value=ee.value.filter(n=>n!==e):ee.value=[...ee.value,e],Ht()}function Oa(){ee.value=[],Ht()}function ja(){ee.value=Y.value.filter(e=>e!==k.value),Ht()}function Wa(e){return!ee.value.includes(e)}function Ha(e){e.read||dr(e.id),e.date&&(R.value=e.date,ae.value="checkin")}function Ua(e){const n=new Date(e),o=new Date().getTime()-e;return o<6e4?"Just now":o<36e5?`${Math.floor(o/6e4)}m ago`:o<864e5?`${Math.floor(o/36e5)}h ago`:n.toLocaleDateString([],{month:"short",day:"numeric"})}function Ga(){const e=wn.value,n=e.filter(i=>!i.read).length;return B(()=>{La()},[]),t("div",{style:"padding: 16px 0;",children:[Dn.value&&t("div",{style:"position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1002;",children:t("div",{style:"background: white; padding: 20px; border-radius: 12px; max-width: 350px; width: 90%;",children:[t("h3",{style:"margin-top: 0; margin-bottom: 8px; color: #333;",children:"Watched Members"}),t("p",{style:"margin: 0 0 12px 0; font-size: 13px; color: #666;",children:"Get activity alerts from these members"}),t("div",{style:"display: flex; gap: 8px; margin-bottom: 12px;",children:[t("button",{onClick:Oa,style:"flex: 1; padding: 8px; background: #E8F5E9; color: #2E7D32; border: 1px solid #A5D6A7; border-radius: 6px; font-size: 13px; cursor: pointer; font-weight: 500;",children:"Select All"}),t("button",{onClick:ja,style:"flex: 1; padding: 8px; background: #f5f5f5; color: #666; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; cursor: pointer; font-weight: 500;",children:"Deselect All"})]}),t("div",{style:"max-height: 300px; overflow-y: auto;",children:Y.value.filter(i=>i!==k.value).map(i=>{const o=Wa(i);return t("button",{onClick:()=>Ba(i),style:{display:"flex",alignItems:"center",gap:"10px",width:"100%",textAlign:"left",padding:"12px",marginBottom:"4px",border:o?"1px solid #A5D6A7":"1px solid #e0e0e0",borderRadius:"8px",background:o?"#E8F5E9":"white",color:"#333",cursor:"pointer",fontSize:"14px",fontWeight:"normal"},children:[t("span",{style:{width:"20px",height:"20px",borderRadius:"4px",border:o?"none":"2px solid #ccc",background:o?"#4CAF50":"white",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"14px",flexShrink:0},children:o&&"âœ“"}),i]},i)})}),t("button",{onClick:()=>{Dn.value=!1},style:"width: 100%; margin-top: 12px; background: #4CAF50; color: white;",children:"Done"})]})}),t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;",children:[t("h2",{style:"margin: 0; font-size: 20px;",children:["Notifications",n>0&&t("span",{style:"margin-left: 8px; font-size: 14px; color: #666; font-weight: 400;",children:["(",n," unread)"]})]}),n>0&&t("button",{onClick:hr,style:{background:"none",border:"none",color:"#4CAF50",fontSize:"14px",cursor:"pointer",padding:"4px 8px"},children:"Mark all read"})]}),t("div",{style:"margin-bottom: 16px; border: 1px solid #e0e0e0; border-radius: 12px; overflow: hidden;",children:[t("button",{onClick:()=>{Jt.value=!Jt.value},style:"width: 100%; padding: 14px 16px; background: #f9f9f9; border: none; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-size: 15px; font-weight: 500;",children:[t("span",{style:"display: flex; align-items: center; gap: 8px; color: #333;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#666",children:t("path",{d:"M19.14,12.94c0.04-0.31,0.06-0.63,0.06-0.94c0-0.31-0.02-0.63-0.06-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.37,4.82,11.69,4.82,12s0.02,0.63,0.06,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"})}),"Alert Settings"]}),t("span",{style:{color:"#999",transform:Jt.value?"rotate(180deg)":"none",transition:"transform 0.2s"},children:"â–¼"})]}),Jt.value&&t("div",{style:"padding: 16px; background: #fff; border-top: 1px solid #e0e0e0;",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px;",children:[t("div",{children:[t("div",{style:"font-weight: 500; font-size: 14px; color: #333;",children:"Activity alerts"}),t("div",{style:"font-size: 12px; color: #666;",children:"Check-ins, cancellations, notes"})]}),t("label",{style:"position: relative; display: inline-block; width: 48px; height: 26px;",children:[t("input",{type:"checkbox",checked:Ge.value,onChange:i=>{Ge.value=i.target.checked,Ht()},style:"opacity: 0; width: 0; height: 0;"}),t("span",{style:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:Ge.value?"#4CAF50":"#ccc",transition:"0.3s",borderRadius:"26px"},children:t("span",{style:{position:"absolute",height:"20px",width:"20px",left:Ge.value?"25px":"3px",bottom:"3px",backgroundColor:"white",transition:"0.3s",borderRadius:"50%"}})})]})]}),t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;",children:[t("div",{children:[t("div",{style:"font-weight: 500; font-size: 14px; color: #333;",children:"Game confirmations"}),t("div",{style:"font-size: 12px; color: #666;",children:"When placed in or removed from a confirmed game"})]}),t("label",{style:"position: relative; display: inline-block; width: 48px; height: 26px;",children:[t("input",{type:"checkbox",checked:Ve.value,onChange:i=>{Ve.value=i.target.checked,Ht()},style:"opacity: 0; width: 0; height: 0;"}),t("span",{style:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:Ve.value?"#4CAF50":"#ccc",transition:"0.3s",borderRadius:"26px"},children:t("span",{style:{position:"absolute",height:"20px",width:"20px",left:Ve.value?"25px":"3px",bottom:"3px",backgroundColor:"white",transition:"0.3s",borderRadius:"50%"}})})]})]}),t("div",{style:"padding-top: 12px; border-top: 1px solid #e0e0e0;",children:t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;",children:[t("div",{children:[t("div",{style:"font-weight: 500; font-size: 14px; color: #333;",children:"Watched members"}),t("div",{style:"font-size: 12px; color: #666;",children:(()=>{const i=Y.value.filter(r=>r!==k.value);return`Watching ${i.length-ee.value.length} of ${i.length} members`})()})]}),t("button",{onClick:()=>{Dn.value=!0},style:"background: #E8F5E9; color: #2E7D32; border: 1px solid #A5D6A7; padding: 6px 12px; border-radius: 6px; font-size: 13px; cursor: pointer; font-weight: 500;",children:"Edit"})]})})]})]}),e.length===0?t("div",{style:"text-align: center; padding: 48px 24px; background: #f9f9f9; border-radius: 12px;",children:[t("div",{style:"font-size: 48px; margin-bottom: 16px;",children:"ðŸ””"}),t("p",{style:"font-size: 18px; margin: 0 0 8px 0; color: #333;",children:"No notifications"}),t("p",{style:"font-size: 14px; color: #666; margin: 0;",children:"You'll see updates about matches and check-ins here"})]}):t("div",{style:"display: flex; flex-direction: column; gap: 8px;",children:e.map(i=>t("div",{onClick:()=>Ha(i),style:{padding:"14px 16px",background:i.read?"#f9f9f9":"#E8F5E9",borderRadius:"10px",cursor:i.date?"pointer":"default",border:i.read?"1px solid #e0e0e0":"1px solid #A5D6A7",position:"relative"},children:t("div",{style:"display: flex; justify-content: space-between; align-items: flex-start;",children:[t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 15px; color: #333; margin-bottom: 6px;",children:[!i.read&&t("span",{style:"display: inline-block; width: 8px; height: 8px; background: #4CAF50; border-radius: 50%; margin-right: 8px;"}),i.message]}),t("div",{style:"font-size: 12px; color: #888; display: flex; align-items: center; gap: 8px; flex-wrap: wrap;",children:[t("span",{children:Ua(i.timestamp)}),i.date&&t("span",{style:"color: #4CAF50; font-weight: 500; display: flex; align-items: center; gap: 2px;",children:[G(i.date)," â†’"]})]})]}),t("button",{onClick:o=>{o.stopPropagation(),pr(i.id)},style:{background:"none",border:"none",color:"#999",fontSize:"18px",cursor:"pointer",padding:"0 4px",marginLeft:"8px"},children:"Ã—"})]})},i.id))})]})}function Va(){const e=E.value.groupDescription,n=E.value.groupRules,i=e||n,o=[{title:"Getting Started",icon:"ðŸŽ¾",content:["When you first open the app, you'll be asked to select your name from the member list.","Use the date selector to pick the day you want to play.","Check in by selecting your game preference and optionally setting your available times."]},{title:"Check-in Options",icon:"âœ…",content:["Doubles - You want to play doubles games (4 players).","Singles - You want to play singles games (2 players).","Both - You're flexible and happy to play either format.","Rotation - Enable this option to join 3-player rotation games where players take turns.","Time Range - Set your earliest and latest available times to help coordinate."]},{title:"Game Types",icon:"ðŸ‘¥",content:["Doubles (green) - A confirmed 4-player doubles game.","Singles (green) - A confirmed 2-player singles game.","Rotation (green) - A confirmed 3-player game with rotating play.","Forming (yellow) - A game that needs more players to be complete."]},{title:"My Games",icon:"ðŸ“…",content:["View all your upcoming games across all dates at a glance.","Tap any game card to jump directly to that day's check-in page.","Yellow background indicates the game is still forming and needs more players.","Green background means the game is confirmed and ready to play."]},{title:"Alerts",icon:"ðŸ””",content:["Get notified when games are formed or when players join/leave.","Unread alerts show a red badge with the count on the tab.","Tap a notification to mark it as read.","Access notification settings to configure your preferences."]},{title:"Profile",icon:"ðŸ‘¤",content:["Access your profile by tapping your name badge in the top-right corner.","Edit your display name, phone number, and email address.","Change your user session to switch to a different account.","Admin login is available for group administrators."]},{title:"Tips",icon:"ðŸ’¡",content:["Check in early to get matched with your preferred players.",`Select "Both" if you're flexible - it increases your chances of getting a game.`,"Set your time preferences to help organizers coordinate scheduling.","Enable rotation if you're open to 3-player games."]},{title:"Admin Features",icon:"âš™ï¸",content:["Access admin mode via Admin Login in your Profile page.","Manage Members - Add, edit, or remove group members.","Group Settings - Configure group name, PINs, weather location, story, and rules.","Activity History - View all check-ins and changes with option to delete test data.","Group Insights - View game stats, player activity trends, and analytics."]}],r=n?n.split(`
`).filter(a=>a.trim()):[];return t("div",{style:"padding: 16px 0;",children:[i&&t("div",{style:{marginBottom:"24px"},children:[t("h2",{style:"margin: 0 0 16px 0; font-size: 20px;",children:["About ",H.value]}),e&&t("div",{style:{background:"#E8F5E9",borderRadius:"12px",padding:"16px",border:"1px solid #C8E6C9",marginBottom:"12px"},children:[t("h3",{style:"margin: 0 0 8px 0; font-size: 15px; color: #2E7D32; display: flex; align-items: center; gap: 8px;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#4CAF50",children:t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})}),"Our Story"]}),t("p",{style:"margin: 0; color: #333; font-size: 14px; line-height: 1.6; white-space: pre-wrap;",children:e})]}),r.length>0&&t("div",{style:{background:"#FFF8E1",borderRadius:"12px",padding:"16px",border:"1px solid #FFECB3"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 15px; color: #F57C00; display: flex; align-items: center; gap: 8px;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#FF9800",children:t("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})}),"Rules & Tips"]}),t("ul",{style:"margin: 0; padding-left: 20px; color: #333; font-size: 14px; line-height: 1.6;",children:r.map((a,l)=>t("li",{style:"margin-bottom: 6px;",children:a},l))})]})]}),t("h2",{style:"margin: 0 0 16px 0; font-size: 20px;",children:"User Guide"}),t("div",{style:"display: flex; flex-direction: column; gap: 16px;",children:o.map((a,l)=>t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",border:"1px solid #e0e0e0"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px; display: flex; align-items: center; gap: 8px;",children:[t("span",{children:a.icon}),t("span",{children:a.title})]}),t("ul",{style:"margin: 0; padding-left: 20px; color: #555; font-size: 14px; line-height: 1.6;",children:a.content.map((s,d)=>t("li",{style:"margin-bottom: 4px;",children:s},d))})]},l))}),t("p",{style:"font-size: 13px; color: #888; text-align: center; margin-top: 20px;",children:"Need more help? Contact your group administrator."})]})}function Rn(e){return e.toLowerCase().replace(/\s+/g,"")}const Ya=Xe(()=>{const e=Q.value,n=new Date;n.setHours(0,0,0,0);const i=new Date(n);i.setDate(i.getDate()-30);const o=new Date(n);o.setDate(o.getDate()-7);let r=0,a=0,l=0,s=0,d=0,u=0;const f={},p={0:0,1:0,2:0,3:0,4:0,5:0,6:0},h={};let c=0,g=0;const y=Object.keys(e).sort();for(const C of y){const $=e[C]||[];if($.length===0)continue;const A=new Date(C+"T00:00:00");if(!(A<n))continue;c++,g+=$.length;const ue=A>=i,pe=A>=o,te=A.getDay(),U=new Date(A);U.setDate(U.getDate()-U.getDay());const he=U.toISOString().split("T")[0],{matches:bo}=xn($);for(const ne of bo)if(!(ne.type==="waiting"||ne.type==="doubles-forming"||ne.type==="singles-forming")){r++,p[te]++,h[he]=(h[he]||0)+1,ue&&d++,pe&&u++,ne.type==="doubles"?a++:ne.type==="singles"?l++:ne.type==="singles-or-practice"&&s++;for(const at of ne.players){const Le=Rn(at.name);f[Le]||(f[Le]={gamesPlayed:0,checkIns:0,lastPlayed:C,doublesPlayed:0,singlesPlayed:0}),f[Le].gamesPlayed++,f[Le].lastPlayed=C,ne.type==="doubles"?f[Le].doublesPlayed++:f[Le].singlesPlayed++}}for(const ne of $){const at=Rn(ne.name);f[at]||(f[at]={gamesPlayed:0,checkIns:0,lastPlayed:"",doublesPlayed:0,singlesPlayed:0}),f[at].checkIns++}}const v=Object.entries(f).map(([C,$])=>({name:Y.value.find(j=>Rn(j)===C)||C,...$,participationRate:$.checkIns>0?Math.round($.gamesPlayed/$.checkIns*100):0})).sort((C,$)=>$.gamesPlayed-C.gamesPlayed).slice(0,10),x=Object.entries(p).sort((C,$)=>$[1]-C[1])[0],b=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],w=Object.entries(h).sort((C,$)=>$[0].localeCompare(C[0])).slice(0,8).reverse();return{totalGames:r,doublesGames:a,singlesGames:l,rotationGames:s,last30DaysGames:d,last7DaysGames:u,activeDays:c,totalCheckIns:g,averagePlayersPerDay:c>0?(g/c).toFixed(1):"0",topPlayers:v,mostPopularDay:x?b[parseInt(x[0])]:"N/A",mostPopularDayCount:x?x[1]:0,dayOfWeekCounts:p,recentWeeks:w,totalMembers:Y.value.length,activeMembersLast30Days:Object.values(f).filter(C=>C.lastPlayed?new Date(C.lastPlayed+"T00:00:00")>=i:!1).length}});function Tn({label:e,value:n,subtext:i}){return t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",textAlign:"center",flex:"1",minWidth:"100px"},children:[t("div",{style:{fontSize:"24px",fontWeight:"700",color:"#4CAF50"},children:n}),t("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:e}),i&&t("div",{style:{fontSize:"11px",color:"#888",marginTop:"2px"},children:i})]})}function Pn({value:e,max:n,color:i="#4CAF50"}){const o=n>0?e/n*100:0;return t("div",{style:{background:"#e0e0e0",borderRadius:"4px",height:"8px",flex:"1",overflow:"hidden"},children:t("div",{style:{background:i,height:"100%",width:`${o}%`,borderRadius:"4px",transition:"width 0.3s ease"}})})}function Ka(){const e=Ya.value,n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i=Math.max(...Object.values(e.dayOfWeekCounts));return t("div",{style:"padding: 16px;",children:[t("h3",{style:"margin: 0 0 16px 0; font-size: 18px; color: #333;",children:"Group Insights"}),t("div",{style:{display:"flex",gap:"12px",marginBottom:"20px",flexWrap:"wrap"},children:[t(Tn,{label:"Total Games",value:e.totalGames,subtext:"all time"}),t(Tn,{label:"Last 30 Days",value:e.last30DaysGames}),t(Tn,{label:"Last 7 Days",value:e.last7DaysGames})]}),t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px;",children:"Game Types"}),t("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[t("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t("span",{style:{width:"70px",fontSize:"14px"},children:"Doubles"}),t(Pn,{value:e.doublesGames,max:e.totalGames,color:"#4CAF50"}),t("span",{style:{width:"40px",textAlign:"right",fontSize:"14px",fontWeight:"600"},children:e.doublesGames})]}),t("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t("span",{style:{width:"70px",fontSize:"14px"},children:"Singles"}),t(Pn,{value:e.singlesGames,max:e.totalGames,color:"#2196F3"}),t("span",{style:{width:"40px",textAlign:"right",fontSize:"14px",fontWeight:"600"},children:e.singlesGames})]}),t("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t("span",{style:{width:"70px",fontSize:"14px"},children:"Rotation"}),t(Pn,{value:e.rotationGames,max:e.totalGames,color:"#FF9800"}),t("span",{style:{width:"40px",textAlign:"right",fontSize:"14px",fontWeight:"600"},children:e.rotationGames})]})]})]}),t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px;",children:"Activity by Day"}),t("div",{style:{display:"flex",gap:"4px",alignItems:"flex-end",height:"80px"},children:n.map((o,r)=>{const a=e.dayOfWeekCounts[r],l=i>0?a/i*60:0;return t("div",{style:{flex:"1",textAlign:"center"},children:[t("div",{style:{background:r===Number(Object.entries(e.dayOfWeekCounts).sort((s,d)=>d[1]-s[1])[0]?.[0])?"#4CAF50":"#c8e6c9",height:`${Math.max(l,4)}px`,borderRadius:"4px 4px 0 0",marginBottom:"4px",transition:"height 0.3s ease"}}),t("span",{style:{fontSize:"10px",color:"#666"},children:o})]},o)})}),t("p",{style:{fontSize:"13px",color:"#666",margin:"12px 0 0 0",textAlign:"center"},children:["Most popular: ",t("strong",{children:e.mostPopularDay})," (",e.mostPopularDayCount," games)"]})]}),e.recentWeeks.length>0&&t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px;",children:"Weekly Trend"}),t("div",{style:{display:"flex",gap:"4px",alignItems:"flex-end",height:"60px"},children:e.recentWeeks.map(([o,r])=>{const a=Math.max(...e.recentWeeks.map(u=>u[1])),l=a>0?r/a*50:0,s=new Date(o+"T00:00:00"),d=`${s.getMonth()+1}/${s.getDate()}`;return t("div",{style:{flex:"1",textAlign:"center"},children:[t("div",{style:{background:"#4CAF50",height:`${Math.max(l,4)}px`,borderRadius:"4px 4px 0 0",marginBottom:"4px"}}),t("span",{style:{fontSize:"9px",color:"#666"},children:d})]},o)})})]}),t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px;",children:"Most Active Players"}),t("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"11px",color:"#888",marginBottom:"8px",padding:"0 4px"},children:[t("span",{children:"Player"}),t("span",{children:"Games"})]}),e.topPlayers.length===0?t("p",{style:{fontSize:"14px",color:"#666",textAlign:"center",margin:"16px 0"},children:"No game data yet"}):t("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:e.topPlayers.map((o,r)=>t("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px",background:r<3?"#E8F5E9":"white",borderRadius:"8px"},children:[t("span",{style:{width:"20px",height:"20px",borderRadius:"50%",background:r===0?"#FFD700":r===1?"#C0C0C0":r===2?"#CD7F32":"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"600",color:r<3?"#333":"#666"},children:r+1}),t("span",{style:{flex:"1",fontSize:"14px"},children:o.name}),t("span",{style:{fontSize:"14px",fontWeight:"600",color:"#4CAF50"},children:o.gamesPlayed})]},o.name))})]}),t("div",{style:{background:"#E3F2FD",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px;",children:"Group Health"}),t("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[t("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px"},children:[t("span",{style:{color:"#666"},children:"Total members"}),t("span",{style:{fontWeight:"600"},children:e.totalMembers})]}),t("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px"},children:[t("span",{style:{color:"#666"},children:"Active last 30 days"}),t("span",{style:{fontWeight:"600"},children:e.activeMembersLast30Days})]}),t("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px"},children:[t("span",{style:{color:"#666"},children:"Avg players/day"}),t("span",{style:{fontWeight:"600"},children:e.averagePlayersPerDay})]}),t("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px"},children:[t("span",{style:{color:"#666"},children:"Days with activity"}),t("span",{style:{fontWeight:"600"},children:e.activeDays})]})]})]}),t("p",{style:"font-size: 13px; color: #888; text-align: center; margin-top: 16px;",children:"Stats are based on completed games from past dates"})]})}function Mi(){const e=S.value;return e?sessionStorage.getItem(`adminAuth_${e}`)==="true":!1}function qa(){const[e,n]=fe(Mi()),[i,o]=fe(!1),[r,a]=fe(""),[l,s]=fe(""),[d,u]=fe(""),[f,p]=fe(!1),[h,c]=fe(!1);B(()=>{const w=setInterval(()=>{n(Mi())},1e3);return()=>clearInterval(w)},[]),B(()=>{const w=k.value;if(w&&(a(w),L.value)){const C=L.value[w];C&&(s(C.phone||""),u(C.email||""))}},[k.value,L.value]);const g=async()=>{const w=k.value;if(!w)return;p(!0);const C=r.trim();if(C!==w){const A=await co(w,C);if(A){k.value=C;const j=S.value;j&&localStorage.setItem(`sessionUser_${j}`,C),await ki(C,{phone:l,email:d})}p(!1),A&&o(!1)}else{const A=await ki(w,{phone:l,email:d});p(!1),A&&o(!1)}},y=()=>{const w=k.value;if(w&&(a(w),L.value)){const C=L.value[w];C&&(s(C.phone||""),u(C.email||""))}o(!1)},v=k.value&&L.value?L.value[k.value]:null,x=()=>{if(confirm("Change user? This will clear your current session.")){const w=S.value;w&&localStorage.removeItem(`sessionUser_${w}`),k.value="",_("Please select your name","info"),Lt.value=!0}},b=()=>{const w=S.value;w&&(sessionStorage.removeItem(`adminAuth_${w}`),n(!1),_("Logged out of admin mode","info"))};return t("div",{style:"padding: 16px 0;",children:[t("h2",{style:"margin: 0 0 16px 0; font-size: 20px;",children:"Profile"}),t("div",{style:{background:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"16px",border:"1px solid #e0e0e0"},children:[!i&&t("div",{style:"display: flex; justify-content: flex-end; margin-bottom: 8px;",children:t("button",{onClick:()=>o(!0),style:{background:"none",border:"none",color:"#4CAF50",cursor:"pointer",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})}),"Edit"]})}),i?t("div",{style:"display: flex; flex-direction: column; gap: 12px;",children:[t("div",{children:[t("label",{style:"display: block; font-size: 13px; color: #666; margin-bottom: 4px;",children:"Display Name"}),t("input",{type:"text",value:r,onInput:w=>a(w.target.value),placeholder:"Your name",style:{width:"100%",padding:"10px 12px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),t("div",{children:[t("label",{style:"display: block; font-size: 13px; color: #666; margin-bottom: 4px;",children:"Phone Number"}),t("input",{type:"tel",value:l,onInput:w=>s(w.target.value),placeholder:"e.g., (555) 123-4567",style:{width:"100%",padding:"10px 12px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),t("div",{children:[t("label",{style:"display: block; font-size: 13px; color: #666; margin-bottom: 4px;",children:"Email Address"}),t("input",{type:"email",value:d,onInput:w=>u(w.target.value),placeholder:"e.g., name@example.com",style:{width:"100%",padding:"10px 12px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),t("div",{style:"display: flex; gap: 8px; margin-top: 4px;",children:[t("button",{onClick:y,disabled:f,style:{flex:1,padding:"10px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"Cancel"}),t("button",{onClick:g,disabled:f,style:{flex:1,padding:"10px",background:"#4CAF50",border:"none",borderRadius:"8px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"500",opacity:f?.7:1},children:f?"Saving...":"Save"})]})]}):t("div",{style:"display: flex; flex-direction: column; gap: 8px;",children:[t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#888",children:t("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),t("span",{style:{color:"#333",fontSize:"14px"},children:k.value||"Not set"})]}),t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#888",children:t("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})}),t("span",{style:{color:v?.phone?"#333":"#aaa",fontSize:"14px"},children:v?.phone||"No phone number"})]}),t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#888",children:t("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})}),t("span",{style:{color:v?.email?"#333":"#aaa",fontSize:"14px"},children:v?.email||"No email address"})]}),!v?.phone&&!v?.email&&t("p",{style:"font-size: 13px; color: #888; margin: 8px 0 0 0;",children:"Add your contact info so organizers can reach you about matches."})]})]}),t("div",{style:"display: flex; flex-direction: column; gap: 8px;",children:[e&&t(D,{children:[t("button",{onClick:()=>{_n.value=!0},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#E8F5E9",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#4CAF50",children:t("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Manage Members"}),t("div",{style:"font-size: 13px; color: #888;",children:[Y.value.length," members in group"]})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]}),t("button",{onClick:()=>{$e.value=!0},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#666",children:t("path",{d:"M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Group Settings"}),t("div",{style:"font-size: 13px; color: #888;",children:"Name, PIN, location, and other settings"})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]}),t("button",{onClick:()=>{Ke.value=!0},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#666",children:t("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Activity History"}),t("div",{style:"font-size: 13px; color: #888;",children:"View recent check-ins and changes"})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]}),t("button",{onClick:()=>c(!h),style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:h?"#E3F2FD":"#fff",border:h?"1px solid #90CAF9":"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#E8F5E9",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#4CAF50",children:t("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Group Insights"}),t("div",{style:"font-size: 13px; color: #888;",children:"Game stats, player activity, and trends"})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",style:{transform:h?"rotate(90deg)":"none",transition:"transform 0.2s"},children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]}),h&&t("div",{style:{background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",overflow:"hidden"},children:t(Ka,{})}),t("button",{onClick:b,style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#FFF3E0",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#FF9800",children:t("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #FF9800;",children:"Exit Admin Mode"}),t("div",{style:"font-size: 13px; color: #888;",children:"Return to regular user view"})]})]})]}),!e&&t("button",{onClick:()=>{$e.value=!0},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#FFF3E0",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#FF9800",children:t("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Admin Login"}),t("div",{style:"font-size: 13px; color: #888;",children:"Access group settings and member management"})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]}),t("button",{onClick:x,style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left",marginTop:e?"8px":"0"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#666",children:t("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Change User"}),t("div",{style:"font-size: 13px; color: #888;",children:"Switch to a different account"})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]})]}),t("p",{style:"font-size: 12px; color: #aaa; text-align: center; margin-top: 32px;",children:"Tennis Coordinator v0.8.12"})]})}const X=m(!1),ve=m(""),we=m("both"),_e=m(!1),Ie=m(!1),dt=m(""),Oe=m(""),ut=m(""),pt=m(""),ht=m(""),ft=m(""),Zt=m(!0),Me=m(""),De=m("");m(!0);const je=m(!1),oe=m(!1),me=m(null);function Ja(){Vo(),Yo(),Ko(),ur(),B(()=>{const i=S.value;if(i){if(sessionStorage.getItem("siteAdminAuth")==="true"){je.value=!0;return}const r=`pinAuth_${i}`,a=sessionStorage.getItem(r)==="true";je.value=a}},[S.value]),B(()=>{R.value=Wo()},[]),B(()=>{const i=S.value;if(i){const o=localStorage.getItem(`sessionUser_${i}`);o?k.value=o:je.value&&(Lt.value=!0)}},[S.value,je.value]);const e=()=>{const i=S.value;i&&sessionStorage.setItem(`pinAuth_${i}`,"true"),je.value=!0,window.scrollTo(0,0),k.value||(Lt.value=!0)},n=!je.value&&!!E.value.groupPin;return t(D,{children:[t(yr,{isOpen:n,groupName:H.value,correctPin:E.value.groupPin,onSuccess:e}),t(Yr,{}),t(Pr,{}),t(Ur,{}),t(Ir,{}),t(kr,{}),t("div",{class:"container",id:"appContainer",style:n?"filter: blur(5px); pointer-events: none;":"",children:[t(vr,{}),t("div",{style:"padding-bottom: 80px;",children:[ae.value==="checkin"&&t(ka,{}),ae.value==="matches"&&t(Na,{}),ae.value==="notifications"&&t(Ga,{}),ae.value==="help"&&t(Va,{}),ae.value==="profile"&&t(qa,{})]})]}),t(ea,{}),t(mr,{})]})}const Qt=m(!1),K=m({}),Di=m(!0),En=m(null),Re=m(null),Xt=m(null),gt=m(""),We=m(!1),ke=m(null),en=m("");function Za(){B(()=>{e()},[]);async function e(){try{const g=(await T().ref("siteSettings").once("value")).val();En.value=g?.siteAdminPin||null,sessionStorage.getItem("siteAdminAuth")==="true"&&(Qt.value=!0,await n())}catch(h){console.error("Error initializing admin page:",h),_("Failed to initialize","error")}finally{Di.value=!1}}async function n(){try{const c=await T().ref("groups").once("value");K.value=c.val()||{}}catch(h){console.error("Error loading groups:",h),_("Failed to load groups","error")}}function i(h){h.preventDefault(),Re.value=null;const g=h.target.querySelector("input"),y=g.value.trim();if(!y){Re.value="Please enter a PIN";return}if(!En.value){Re.value="Site admin PIN not configured. Please set siteAdminPin in siteSettings in Firebase.";return}y===En.value?(sessionStorage.setItem("siteAdminAuth","true"),Qt.value=!0,Re.value=null,n()):(Re.value="Incorrect PIN. Please try again.",g.value="",g.focus())}function o(){sessionStorage.removeItem("siteAdminAuth"),Qt.value=!1,K.value={}}function r(){window.location.hash="",window.location.reload()}function a(h){Xt.value===h?Xt.value=null:(Xt.value=h,gt.value="")}async function l(h){const c=gt.value.trim();if(!c){_("Please enter a member name","error");return}We.value=!0;try{const g=T(),y=K.value[h],v=y?.settings?.members||[];if(v.some(b=>b.toLowerCase()===c.toLowerCase())){_("Member already exists","error"),We.value=!1;return}const x=[...v,c];await g.ref(`groups/${h}/settings/members`).set(x),K.value={...K.value,[h]:{...y,settings:{...y?.settings,members:x}}},gt.value="",_(`Added ${c} to the group`,"success")}catch(g){console.error("Error adding member:",g),_("Failed to add member","error")}finally{We.value=!1}}async function s(h,c){if(confirm(`Remove ${c} from this group?`))try{const g=T(),y=K.value[h],x=(y?.settings?.members||[]).filter(b=>b!==c);await g.ref(`groups/${h}/settings/members`).set(x),K.value={...K.value,[h]:{...y,settings:{...y?.settings,members:x}}},_(`Removed ${c}`,"success")}catch(g){console.error("Error removing member:",g),_("Failed to remove member","error")}}function d(h,c){ke.value={groupId:h,originalName:c},en.value=c}async function u(){const h=ke.value;if(!h)return;const c=en.value.trim();if(!c){_("Name cannot be empty","error");return}if(c===h.originalName){ke.value=null;return}const g=K.value[h.groupId],y=g?.settings?.members||[];if(y.some(v=>v.toLowerCase()===c.toLowerCase()&&v!==h.originalName)){_("A member with this name already exists","error");return}try{const v=T(),x=y.map($=>$===h.originalName?c:$);await v.ref(`groups/${h.groupId}/settings/members`).set(x);const b=g?.settings?.memberDetails||{};if(b[h.originalName]){const $=b[h.originalName];await v.ref(`groups/${h.groupId}/settings/memberDetails/${h.originalName}`).remove(),await v.ref(`groups/${h.groupId}/settings/memberDetails/${c}`).set($);const A={...b};A[c]=$,delete A[h.originalName],K.value={...K.value,[h.groupId]:{...g,settings:{...g?.settings,members:x,memberDetails:A}}}}else K.value={...K.value,[h.groupId]:{...g,settings:{...g?.settings,members:x}}};const C=(await v.ref(`groups/${h.groupId}/checkins`).once("value")).val()||{};for(const[$,A]of Object.entries(C))if(A&&typeof A=="object"){const j=Object.values(A);let ue=!1;const pe=j.map(te=>te&&te.name===h.originalName?(ue=!0,{...te,name:c}):te);ue&&await v.ref(`groups/${h.groupId}/checkins/${$}`).set(pe)}ke.value=null,_(`Renamed ${h.originalName} to ${c}`,"success")}catch(v){console.error("Error renaming member:",v),_("Failed to rename member","error")}}if(Di.value)return t("div",{class:"site-admin-page",children:t("div",{class:"site-admin-container",children:t("div",{class:"site-admin-loading",children:[t("div",{class:"loading-spinner-icon"}),t("p",{children:"Loading..."})]})})});if(!Qt.value)return t("div",{class:"site-admin-page",children:t("div",{class:"site-admin-container",children:t("div",{class:"site-admin-login-card",children:[t("div",{class:"site-admin-header",children:[t("span",{class:"site-admin-icon",children:"ðŸ”"}),t("h1",{children:"Site Administration"}),t("p",{class:"site-admin-subtitle",children:"Tennis Coordinator Platform"})]}),t("form",{onSubmit:i,class:"site-admin-form",children:[t("div",{class:"form-group",children:[t("label",{for:"admin-pin",children:"Administrator PIN"}),t("input",{id:"admin-pin",type:"password",placeholder:"Enter your PIN",class:"site-admin-input",autoFocus:!0})]}),Re.value&&t("div",{class:"site-admin-error",children:[t("span",{class:"error-icon",children:"âš ï¸"}),Re.value]}),t("button",{type:"submit",class:"site-admin-submit",children:"Sign In"})]}),t("div",{class:"site-admin-footer",children:t("button",{onClick:r,class:"back-to-home",children:"â† Back to Home"})})]})})});const f=Object.entries(K.value),p=f.reduce((h,[,c])=>h+(c.settings?.members?.length||0),0);return t("div",{class:"site-admin-page",children:t("div",{class:"site-admin-dashboard",children:[t("header",{class:"site-admin-dashboard-header",children:[t("div",{class:"header-left",children:[t("h1",{children:"ðŸŽ¾ Site Administration"}),t("p",{class:"header-subtitle",children:"Tennis Coordinator Platform"})]}),t("button",{onClick:o,class:"logout-button",children:"Sign Out"})]}),t("div",{class:"site-admin-stats",children:[t("div",{class:"stat-card",children:[t("span",{class:"stat-value",children:f.length}),t("span",{class:"stat-label",children:"Tennis Groups"})]}),t("div",{class:"stat-card",children:[t("span",{class:"stat-value",children:p}),t("span",{class:"stat-label",children:"Total Members"})]})]}),t("section",{class:"site-admin-section",children:[t("h2",{children:"All Tennis Groups"}),f.length===0?t("div",{class:"empty-state",children:t("p",{children:"No tennis groups have been created yet."})}):t("div",{class:"groups-grid",children:f.map(([h,c])=>{const g=c.settings?.members||[],y=Xt.value===h;return t("div",{class:`group-card ${y?"expanded":""}`,children:[t("div",{class:"group-card-header",children:[t("h3",{children:c.settings?.groupName||h}),t("span",{class:"group-id",children:["#",h]})]}),t("div",{class:"group-card-body",children:[t("div",{class:"group-stat",children:[t("span",{class:"group-stat-icon",children:"ðŸ‘¥"}),t("span",{children:[g.length," members"]})]}),c.settings?.location?.name&&t("div",{class:"group-stat",children:[t("span",{class:"group-stat-icon",children:"ðŸ“"}),t("span",{children:c.settings.location.name})]})]}),y&&t("div",{class:"group-members-section",children:[t("div",{class:"members-header",children:t("h4",{children:"Members"})}),t("div",{class:"add-member-form",children:[t("input",{type:"text",placeholder:"Enter member name",value:gt.value,onInput:v=>{gt.value=v.target.value},onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),l(h))},class:"member-input",disabled:We.value}),t("button",{onClick:()=>l(h),class:"add-member-btn",disabled:We.value,children:We.value?"...":"Add"})]}),t("div",{class:"members-list",children:g.length===0?t("p",{class:"no-members",children:"No members yet. Add the first member above."}):g.map(v=>{const x=ke.value?.groupId===h&&ke.value?.originalName===v;return t("div",{class:"member-item",children:x?t(D,{children:[t("input",{type:"text",value:en.value,onInput:b=>{en.value=b.target.value},onKeyDown:b=>{b.key==="Enter"?(b.preventDefault(),u()):b.key==="Escape"&&(ke.value=null)},class:"edit-member-input",autoFocus:!0}),t("button",{onClick:u,class:"save-member-btn",title:"Save",children:"âœ“"}),t("button",{onClick:()=>{ke.value=null},class:"cancel-edit-btn",title:"Cancel",children:"âœ•"})]}):t(D,{children:[t("span",{class:"member-name",children:v}),t("button",{onClick:()=>d(h,v),class:"edit-member-btn",title:"Edit name",children:"âœŽ"}),t("button",{onClick:()=>s(h,v),class:"remove-member-btn",title:"Remove member",children:"Ã—"})]})},v)})})]}),t("div",{class:"group-card-footer",children:[t("button",{onClick:()=>a(h),class:"manage-members-btn",children:y?"Hide Members":"Manage Members"}),t("a",{href:`#${h}`,class:"view-group-link",onClick:v=>{v.preventDefault(),window.location.hash=h,window.location.reload()},children:"View Group â†’"})]})]},h)})})]})]})})}function Qa({message:e,type:n}){const i=()=>{switch(n){case"success":return"âœ“";case"error":return"âœ•";default:return"â„¹"}};return t("div",{class:`toast toast-${n}`,children:[t("span",{class:"toast-icon",children:i()}),t("span",{class:"toast-message",children:e})]})}const S=m(null),H=m(""),R=m(null),k=m(""),Ri=m(!0),vt=m([]),Q=m({}),Y=m([]),L=m({}),xo=Xe(()=>R.value?Q.value[R.value]||[]:[]);let Xa=0;function _(e,n="info"){const i=++Xa;vt.value=[...vt.value,{id:i,message:e,type:n}],setTimeout(()=>{vt.value=vt.value.filter(o=>o.id!==i)},3e3)}async function tn(e){try{const o=(await T().ref("groups").once("value")).val()||{};for(const[r,a]of Object.entries(o))if(a.settings&&a.settings.shortCode===e)return console.log(`[resolveShortCode] Resolved "${e}" to group ID: ${r}`),r;return console.log(`[resolveShortCode] No match found for "${e}", using as-is`),null}catch(n){return console.error("[resolveShortCode] Error:",n),null}}async function el(){const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const s=e.replace(/^\/+|\/+$/g,"");if(s==="admin")return history.replaceState(null,"",e),"admin";if(s&&s!=="index.html"&&s!=="app.html")return history.replaceState(null,"",e),await tn(s)||s}const n=window.location.hash.replace(/^#\/?/,"");if(n&&n!=="admin")return await tn(n)||n;if(n==="admin")return"admin";const o=new URLSearchParams(window.location.search).get("group");if(o)return await tn(o)||o;const a=window.location.pathname.replace(/^\/+|\/+$/g,"");return a==="admin"?"admin":!a||a==="index.html"||a==="app.html"?null:await tn(a)||a}function tl(){return B(()=>{async function e(){try{ro();const n=await el();if(S.value=n,n&&n!=="admin"){const i=localStorage.getItem(`sessionUser_${n}`);i&&(k.value=i)}}catch(n){console.error("Initialization error:",n),_("Failed to initialize app","error")}finally{Ri.value=!1}}e()},[]),Ri.value?t("div",{class:"loading-screen",children:[t("div",{class:"loading-spinner",children:"ðŸŽ¾"}),t("p",{children:"Loading..."})]}):t(D,{children:[S.value===null&&t(jo,{}),S.value==="admin"&&t(Za,{}),S.value&&S.value!=="admin"&&t(Ja,{}),t("div",{class:"toast-container",children:vt.value.map(e=>t(Qa,{message:e.message,type:e.type},e.id))})]})}zo(t(tl,{}),document.getElementById("app"));
