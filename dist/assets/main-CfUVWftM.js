(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function i(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(r){if(r.ep)return;r.ep=!0;const l=i(r);fetch(r.href,l)}})();var an,I,ki,Si,Ie,ti,$i,zi,Ii,Bn,In,An,mt={},Ai=[],ao=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,sn=Array.isArray;function ue(e,n){for(var i in n)e[i]=n[i];return e}function On(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function so(e,n,i){var o,r,l,a={};for(l in n)l=="key"?o=n[l]:l=="ref"?r=n[l]:a[l]=n[l];if(arguments.length>2&&(a.children=arguments.length>3?an.call(arguments,2):i),typeof e=="function"&&e.defaultProps!=null)for(l in e.defaultProps)a[l]===void 0&&(a[l]=e.defaultProps[l]);return Yt(e,a,o,r,null)}function Yt(e,n,i,o,r){var l={type:e,props:n,key:i,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++ki,__i:-1,__u:0};return r==null&&I.vnode!=null&&I.vnode(l),l}function M(e){return e.children}function pt(e,n){this.props=e,this.context=n}function Ye(e,n){if(n==null)return e.__?Ye(e.__,e.__i+1):null;for(var i;n<e.__k.length;n++)if((i=e.__k[n])!=null&&i.__e!=null)return i.__e;return typeof e.type=="function"?Ye(e):null}function Ri(e){var n,i;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,n=0;n<e.__k.length;n++)if((i=e.__k[n])!=null&&i.__e!=null){e.__e=e.__c.base=i.__e;break}return Ri(e)}}function ni(e){(!e.__d&&(e.__d=!0)&&Ie.push(e)&&!Zt.__r++||ti!=I.debounceRendering)&&((ti=I.debounceRendering)||$i)(Zt)}function Zt(){for(var e,n,i,o,r,l,a,s=1;Ie.length;)Ie.length>s&&Ie.sort(zi),e=Ie.shift(),s=Ie.length,e.__d&&(i=void 0,o=void 0,r=(o=(n=e).__v).__e,l=[],a=[],n.__P&&((i=ue({},o)).__v=o.__v+1,I.vnode&&I.vnode(i),jn(n.__P,i,o,n.__n,n.__P.namespaceURI,32&o.__u?[r]:null,l,r??Ye(o),!!(32&o.__u),a),i.__v=o.__v,i.__.__k[i.__i]=i,Ti(l,i,a),o.__e=o.__=null,i.__e!=r&&Ri(i)));Zt.__r=0}function Mi(e,n,i,o,r,l,a,s,d,c,f){var u,p,h,g,x,m,b,w=o&&o.__k||Ai,_=n.length;for(d=co(i,n,w,d,_),u=0;u<_;u++)(h=i.__k[u])!=null&&(p=h.__i==-1?mt:w[h.__i]||mt,h.__i=u,m=jn(e,h,p,r,l,a,s,d,c,f),g=h.__e,h.ref&&p.ref!=h.ref&&(p.ref&&Wn(p.ref,null,h),f.push(h.ref,h.__c||g,h)),x==null&&g!=null&&(x=g),(b=!!(4&h.__u))||p.__k===h.__k?d=Di(h,d,e,b):typeof h.type=="function"&&m!==void 0?d=m:g&&(d=g.nextSibling),h.__u&=-7);return i.__e=x,d}function co(e,n,i,o,r){var l,a,s,d,c,f=i.length,u=f,p=0;for(e.__k=new Array(r),l=0;l<r;l++)(a=n[l])!=null&&typeof a!="boolean"&&typeof a!="function"?(typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?a=e.__k[l]=Yt(null,a,null,null,null):sn(a)?a=e.__k[l]=Yt(M,{children:a},null,null,null):a.constructor==null&&a.__b>0?a=e.__k[l]=Yt(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):e.__k[l]=a,d=l+p,a.__=e,a.__b=e.__b+1,(c=a.__i=uo(a,i,d,u))!=-1&&(u--,(s=i[c])&&(s.__u|=2)),s==null||s.__v==null?(c==-1&&(r>f?p--:r<f&&p++),typeof a.type!="function"&&(a.__u|=4)):c!=d&&(c==d-1?p--:c==d+1?p++:(c>d?p--:p++,a.__u|=4))):e.__k[l]=null;if(u)for(l=0;l<f;l++)(s=i[l])!=null&&(2&s.__u)==0&&(s.__e==o&&(o=Ye(s)),Pi(s,s));return o}function Di(e,n,i,o){var r,l;if(typeof e.type=="function"){for(r=e.__k,l=0;r&&l<r.length;l++)r[l]&&(r[l].__=e,n=Di(r[l],n,i,o));return n}e.__e!=n&&(o&&(n&&e.type&&!n.parentNode&&(n=Ye(e)),i.insertBefore(e.__e,n||null)),n=e.__e);do n=n&&n.nextSibling;while(n!=null&&n.nodeType==8);return n}function uo(e,n,i,o){var r,l,a,s=e.key,d=e.type,c=n[i],f=c!=null&&(2&c.__u)==0;if(c===null&&s==null||f&&s==c.key&&d==c.type)return i;if(o>(f?1:0)){for(r=i-1,l=i+1;r>=0||l<n.length;)if((c=n[a=r>=0?r--:l++])!=null&&(2&c.__u)==0&&s==c.key&&d==c.type)return a}return-1}function ii(e,n,i){n[0]=="-"?e.setProperty(n,i??""):e[n]=i==null?"":typeof i!="number"||ao.test(n)?i:i+"px"}function Et(e,n,i,o,r){var l,a;e:if(n=="style")if(typeof i=="string")e.style.cssText=i;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(n in o)i&&n in i||ii(e.style,n,"");if(i)for(n in i)o&&i[n]==o[n]||ii(e.style,n,i[n])}else if(n[0]=="o"&&n[1]=="n")l=n!=(n=n.replace(Ii,"$1")),a=n.toLowerCase(),n=a in e||n=="onFocusOut"||n=="onFocusIn"?a.slice(2):n.slice(2),e.l||(e.l={}),e.l[n+l]=i,i?o?i.u=o.u:(i.u=Bn,e.addEventListener(n,l?An:In,l)):e.removeEventListener(n,l?An:In,l);else{if(r=="http://www.w3.org/2000/svg")n=n.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(n!="width"&&n!="height"&&n!="href"&&n!="list"&&n!="form"&&n!="tabIndex"&&n!="download"&&n!="rowSpan"&&n!="colSpan"&&n!="role"&&n!="popover"&&n in e)try{e[n]=i??"";break e}catch{}typeof i=="function"||(i==null||i===!1&&n[4]!="-"?e.removeAttribute(n):e.setAttribute(n,n=="popover"&&i==1?"":i))}}function oi(e){return function(n){if(this.l){var i=this.l[n.type+e];if(n.t==null)n.t=Bn++;else if(n.t<i.u)return;return i(I.event?I.event(n):n)}}}function jn(e,n,i,o,r,l,a,s,d,c){var f,u,p,h,g,x,m,b,w,_,C,$,A,Q,oe,re,X,j=n.type;if(n.constructor!=null)return null;128&i.__u&&(d=!!(32&i.__u),l=[s=n.__e=i.__e]),(f=I.__b)&&f(n);e:if(typeof j=="function")try{if(b=n.props,w="prototype"in j&&j.prototype.render,_=(f=j.contextType)&&o[f.__c],C=f?_?_.props.value:f.__:o,i.__c?m=(u=n.__c=i.__c).__=u.__E:(w?n.__c=u=new j(b,C):(n.__c=u=new pt(b,C),u.constructor=j,u.render=ho),_&&_.sub(u),u.state||(u.state={}),u.__n=o,p=u.__d=!0,u.__h=[],u._sb=[]),w&&u.__s==null&&(u.__s=u.state),w&&j.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=ue({},u.__s)),ue(u.__s,j.getDerivedStateFromProps(b,u.__s))),h=u.props,g=u.state,u.__v=n,p)w&&j.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),w&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(w&&j.getDerivedStateFromProps==null&&b!==h&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(b,C),n.__v==i.__v||!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(b,u.__s,C)===!1){for(n.__v!=i.__v&&(u.props=b,u.state=u.__s,u.__d=!1),n.__e=i.__e,n.__k=i.__k,n.__k.some(function(le){le&&(le.__=n)}),$=0;$<u._sb.length;$++)u.__h.push(u._sb[$]);u._sb=[],u.__h.length&&a.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(b,u.__s,C),w&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(h,g,x)})}if(u.context=C,u.props=b,u.__P=e,u.__e=!1,A=I.__r,Q=0,w){for(u.state=u.__s,u.__d=!1,A&&A(n),f=u.render(u.props,u.state,u.context),oe=0;oe<u._sb.length;oe++)u.__h.push(u._sb[oe]);u._sb=[]}else do u.__d=!1,A&&A(n),f=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++Q<25);u.state=u.__s,u.getChildContext!=null&&(o=ue(ue({},o),u.getChildContext())),w&&!p&&u.getSnapshotBeforeUpdate!=null&&(x=u.getSnapshotBeforeUpdate(h,g)),re=f,f!=null&&f.type===M&&f.key==null&&(re=Ei(f.props.children)),s=Mi(e,sn(re)?re:[re],n,i,o,r,l,a,s,d,c),u.base=n.__e,n.__u&=-161,u.__h.length&&a.push(u),m&&(u.__E=u.__=null)}catch(le){if(n.__v=null,d||l!=null)if(le.then){for(n.__u|=d?160:128;s&&s.nodeType==8&&s.nextSibling;)s=s.nextSibling;l[l.indexOf(s)]=null,n.__e=s}else{for(X=l.length;X--;)On(l[X]);Rn(n)}else n.__e=i.__e,n.__k=i.__k,le.then||Rn(n);I.__e(le,n,i)}else l==null&&n.__v==i.__v?(n.__k=i.__k,n.__e=i.__e):s=n.__e=po(i.__e,n,i,o,r,l,a,d,c);return(f=I.diffed)&&f(n),128&n.__u?void 0:s}function Rn(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Rn)}function Ti(e,n,i){for(var o=0;o<i.length;o++)Wn(i[o],i[++o],i[++o]);I.__c&&I.__c(n,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(l){l.call(r)})}catch(l){I.__e(l,r.__v)}})}function Ei(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:sn(e)?e.map(Ei):ue({},e)}function po(e,n,i,o,r,l,a,s,d){var c,f,u,p,h,g,x,m=i.props||mt,b=n.props,w=n.type;if(w=="svg"?r="http://www.w3.org/2000/svg":w=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),l!=null){for(c=0;c<l.length;c++)if((h=l[c])&&"setAttribute"in h==!!w&&(w?h.localName==w:h.nodeType==3)){e=h,l[c]=null;break}}if(e==null){if(w==null)return document.createTextNode(b);e=document.createElementNS(r,w,b.is&&b),s&&(I.__m&&I.__m(n,l),s=!1),l=null}if(w==null)m===b||s&&e.data==b||(e.data=b);else{if(l=l&&an.call(e.childNodes),!s&&l!=null)for(m={},c=0;c<e.attributes.length;c++)m[(h=e.attributes[c]).name]=h.value;for(c in m)if(h=m[c],c!="children"){if(c=="dangerouslySetInnerHTML")u=h;else if(!(c in b)){if(c=="value"&&"defaultValue"in b||c=="checked"&&"defaultChecked"in b)continue;Et(e,c,null,h,r)}}for(c in b)h=b[c],c=="children"?p=h:c=="dangerouslySetInnerHTML"?f=h:c=="value"?g=h:c=="checked"?x=h:s&&typeof h!="function"||m[c]===h||Et(e,c,h,m[c],r);if(f)s||u&&(f.__html==u.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),n.__k=[];else if(u&&(e.innerHTML=""),Mi(n.type=="template"?e.content:e,sn(p)?p:[p],n,i,o,w=="foreignObject"?"http://www.w3.org/1999/xhtml":r,l,a,l?l[0]:i.__k&&Ye(i,0),s,d),l!=null)for(c=l.length;c--;)On(l[c]);s||(c="value",w=="progress"&&g==null?e.removeAttribute("value"):g!=null&&(g!==e[c]||w=="progress"&&!g||w=="option"&&g!=m[c])&&Et(e,c,g,m[c],r),c="checked",x!=null&&x!=e[c]&&Et(e,c,x,m[c],r))}return e}function Wn(e,n,i){try{if(typeof e=="function"){var o=typeof e.__u=="function";o&&e.__u(),o&&n==null||(e.__u=e(n))}else e.current=n}catch(r){I.__e(r,i)}}function Pi(e,n,i){var o,r;if(I.unmount&&I.unmount(e),(o=e.ref)&&(o.current&&o.current!=e.__e||Wn(o,null,n)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(l){I.__e(l,n)}o.base=o.__P=null}if(o=e.__k)for(r=0;r<o.length;r++)o[r]&&Pi(o[r],n,i||typeof e.type!="function");i||On(e.__e),e.__c=e.__=e.__e=void 0}function ho(e,n,i){return this.constructor(e,i)}function fo(e,n,i){var o,r,l,a;n==document&&(n=document.documentElement),I.__&&I.__(e,n),r=(o=!1)?null:n.__k,l=[],a=[],jn(n,e=n.__k=so(M,null,[e]),r||mt,mt,n.namespaceURI,r?null:n.firstChild?an.call(n.childNodes):null,l,r?r.__e:n.firstChild,o,a),Ti(l,e,a)}an=Ai.slice,I={__e:function(e,n,i,o){for(var r,l,a;n=n.__;)if((r=n.__c)&&!r.__)try{if((l=r.constructor)&&l.getDerivedStateFromError!=null&&(r.setState(l.getDerivedStateFromError(e)),a=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,o||{}),a=r.__d),a)return r.__E=r}catch(s){e=s}throw e}},ki=0,Si=function(e){return e!=null&&e.constructor==null},pt.prototype.setState=function(e,n){var i;i=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ue({},this.state),typeof e=="function"&&(e=e(ue({},i),this.props)),e&&ue(i,e),e!=null&&this.__v&&(n&&this._sb.push(n),ni(this))},pt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ni(this))},pt.prototype.render=M,Ie=[],$i=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,zi=function(e,n){return e.__v.__b-n.__v.__b},Zt.__r=0,Ii=/(PointerCapture)$|Capture$/i,Bn=0,In=oi(!1),An=oi(!0);var go=0;function t(e,n,i,o,r,l){n||(n={});var a,s,d=n;if("ref"in d)for(s in d={},n)s=="ref"?a=n[s]:d[s]=n[s];var c={type:e,props:d,key:i,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--go,__i:-1,__u:0,__source:r,__self:l};if(typeof e=="function"&&(a=e.defaultProps))for(s in a)d[s]===void 0&&(d[s]=a[s]);return I.vnode&&I.vnode(c),c}var yt,E,gn,ri,Qt=0,Ni=[],P=I,li=P.__b,ai=P.__r,si=P.diffed,ci=P.__c,di=P.unmount,ui=P.__;function Hn(e,n){P.__h&&P.__h(E,e,Qt||n),Qt=0;var i=E.__H||(E.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function ae(e){return Qt=1,vo(Bi,e)}function vo(e,n,i){var o=Hn(yt++,2);if(o.t=e,!o.__c&&(o.__=[Bi(void 0,n),function(s){var d=o.__N?o.__N[0]:o.__[0],c=o.t(d,s);d!==c&&(o.__N=[c,o.__[1]],o.__c.setState({}))}],o.__c=E,!E.__f)){var r=function(s,d,c){if(!o.__c.__H)return!0;var f=o.__c.__H.__.filter(function(p){return!!p.__c});if(f.every(function(p){return!p.__N}))return!l||l.call(this,s,d,c);var u=o.__c.props!==s;return f.forEach(function(p){if(p.__N){var h=p.__[0];p.__=p.__N,p.__N=void 0,h!==p.__[0]&&(u=!0)}}),l&&l.call(this,s,d,c)||u};E.__f=!0;var l=E.shouldComponentUpdate,a=E.componentWillUpdate;E.componentWillUpdate=function(s,d,c){if(this.__e){var f=l;l=void 0,r(s,d,c),l=f}a&&a.call(this,s,d,c)},E.shouldComponentUpdate=r}return o.__N||o.__}function B(e,n){var i=Hn(yt++,3);!P.__s&&Li(i.__H,n)&&(i.__=e,i.u=n,E.__H.__h.push(i))}function mo(e){return Qt=5,Fi(function(){return{current:e}},[])}function Fi(e,n){var i=Hn(yt++,7);return Li(i.__H,n)&&(i.__=e(),i.__H=n,i.__h=e),i.__}function yo(){for(var e;e=Ni.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(qt),e.__H.__h.forEach(Mn),e.__H.__h=[]}catch(n){e.__H.__h=[],P.__e(n,e.__v)}}P.__b=function(e){E=null,li&&li(e)},P.__=function(e,n){e&&n.__k&&n.__k.__m&&(e.__m=n.__k.__m),ui&&ui(e,n)},P.__r=function(e){ai&&ai(e),yt=0;var n=(E=e.__c).__H;n&&(gn===E?(n.__h=[],E.__h=[],n.__.forEach(function(i){i.__N&&(i.__=i.__N),i.u=i.__N=void 0})):(n.__h.forEach(qt),n.__h.forEach(Mn),n.__h=[],yt=0)),gn=E},P.diffed=function(e){si&&si(e);var n=e.__c;n&&n.__H&&(n.__H.__h.length&&(Ni.push(n)!==1&&ri===P.requestAnimationFrame||((ri=P.requestAnimationFrame)||xo)(yo)),n.__H.__.forEach(function(i){i.u&&(i.__H=i.u),i.u=void 0})),gn=E=null},P.__c=function(e,n){n.some(function(i){try{i.__h.forEach(qt),i.__h=i.__h.filter(function(o){return!o.__||Mn(o)})}catch(o){n.some(function(r){r.__h&&(r.__h=[])}),n=[],P.__e(o,i.__v)}}),ci&&ci(e,n)},P.unmount=function(e){di&&di(e);var n,i=e.__c;i&&i.__H&&(i.__H.__.forEach(function(o){try{qt(o)}catch(r){n=r}}),i.__H=void 0,n&&P.__e(n,i.__v))};var pi=typeof requestAnimationFrame=="function";function xo(e){var n,i=function(){clearTimeout(o),pi&&cancelAnimationFrame(n),setTimeout(e)},o=setTimeout(i,35);pi&&(n=requestAnimationFrame(i))}function qt(e){var n=E,i=e.__c;typeof i=="function"&&(e.__c=void 0,i()),E=n}function Mn(e){var n=E;e.__c=e.__(),E=n}function Li(e,n){return!e||e.length!==n.length||n.some(function(i,o){return i!==e[o]})}function Bi(e,n){return typeof n=="function"?n(e):n}var bo=Symbol.for("preact-signals");function cn(){if(be>1)be--;else{for(var e,n=!1;ht!==void 0;){var i=ht;for(ht=void 0,Dn++;i!==void 0;){var o=i.o;if(i.o=void 0,i.f&=-3,!(8&i.f)&&Wi(i))try{i.c()}catch(r){n||(e=r,n=!0)}i=o}}if(Dn=0,be--,n)throw e}}function wo(e){if(be>0)return e();be++;try{return e()}finally{cn()}}var z=void 0;function Oi(e){var n=z;z=void 0;try{return e()}finally{z=n}}var ht=void 0,be=0,Dn=0,Xt=0;function ji(e){if(z!==void 0){var n=e.n;if(n===void 0||n.t!==z)return n={i:0,S:e,p:z.s,n:void 0,t:z,e:void 0,x:void 0,r:n},z.s!==void 0&&(z.s.n=n),z.s=n,e.n=n,32&z.f&&e.S(n),n;if(n.i===-1)return n.i=0,n.n!==void 0&&(n.n.p=n.p,n.p!==void 0&&(n.p.n=n.n),n.p=z.s,n.n=void 0,z.s.n=n,z.s=n),n}}function O(e,n){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=n?.watched,this.Z=n?.unwatched,this.name=n?.name}O.prototype.brand=bo;O.prototype.h=function(){return!0};O.prototype.S=function(e){var n=this,i=this.t;i!==e&&e.e===void 0&&(e.x=i,this.t=e,i!==void 0?i.e=e:Oi(function(){var o;(o=n.W)==null||o.call(n)}))};O.prototype.U=function(e){var n=this;if(this.t!==void 0){var i=e.e,o=e.x;i!==void 0&&(i.x=o,e.e=void 0),o!==void 0&&(o.e=i,e.x=void 0),e===this.t&&(this.t=o,o===void 0&&Oi(function(){var r;(r=n.Z)==null||r.call(n)}))}};O.prototype.subscribe=function(e){var n=this;return pe(function(){var i=n.value,o=z;z=void 0;try{e(i)}finally{z=o}},{name:"sub"})};O.prototype.valueOf=function(){return this.value};O.prototype.toString=function(){return this.value+""};O.prototype.toJSON=function(){return this.value};O.prototype.peek=function(){var e=z;z=void 0;try{return this.value}finally{z=e}};Object.defineProperty(O.prototype,"value",{get:function(){var e=ji(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(Dn>100)throw new Error("Cycle detected");this.v=e,this.i++,Xt++,be++;try{for(var n=this.t;n!==void 0;n=n.x)n.t.N()}finally{cn()}}}});function v(e,n){return new O(e,n)}function Wi(e){for(var n=e.s;n!==void 0;n=n.n)if(n.S.i!==n.i||!n.S.h()||n.S.i!==n.i)return!0;return!1}function Hi(e){for(var n=e.s;n!==void 0;n=n.n){var i=n.S.n;if(i!==void 0&&(n.r=i),n.S.n=n,n.i=-1,n.n===void 0){e.s=n;break}}}function Ui(e){for(var n=e.s,i=void 0;n!==void 0;){var o=n.p;n.i===-1?(n.S.U(n),o!==void 0&&(o.n=n.n),n.n!==void 0&&(n.n.p=o)):i=n,n.S.n=n.r,n.r!==void 0&&(n.r=void 0),n=o}e.s=i}function De(e,n){O.call(this,void 0),this.x=e,this.s=void 0,this.g=Xt-1,this.f=4,this.W=n?.watched,this.Z=n?.unwatched,this.name=n?.name}De.prototype=new O;De.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Xt))return!0;if(this.g=Xt,this.f|=1,this.i>0&&!Wi(this))return this.f&=-2,!0;var e=z;try{Hi(this),z=this;var n=this.x();(16&this.f||this.v!==n||this.i===0)&&(this.v=n,this.f&=-17,this.i++)}catch(i){this.v=i,this.f|=16,this.i++}return z=e,Ui(this),this.f&=-2,!0};De.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var n=this.s;n!==void 0;n=n.n)n.S.S(n)}O.prototype.S.call(this,e)};De.prototype.U=function(e){if(this.t!==void 0&&(O.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var n=this.s;n!==void 0;n=n.n)n.S.U(n)}};De.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};Object.defineProperty(De.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=ji(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function qe(e,n){return new De(e,n)}function Gi(e){var n=e.u;if(e.u=void 0,typeof n=="function"){be++;var i=z;z=void 0;try{n()}catch(o){throw e.f&=-2,e.f|=8,Un(e),o}finally{z=i,cn()}}}function Un(e){for(var n=e.s;n!==void 0;n=n.n)n.S.U(n);e.x=void 0,e.s=void 0,Gi(e)}function _o(e){if(z!==this)throw new Error("Out-of-order effect");Ui(this),z=e,this.f&=-2,8&this.f&&Un(this),cn()}function Xe(e,n){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=n?.name}Xe.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var n=this.x();typeof n=="function"&&(this.u=n)}finally{e()}};Xe.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,Gi(this),Hi(this),be++;var e=z;return z=this,_o.bind(this,e)};Xe.prototype.N=function(){2&this.f||(this.f|=2,this.o=ht,ht=this)};Xe.prototype.d=function(){this.f|=8,1&this.f||Un(this)};Xe.prototype.dispose=function(){this.d()};function pe(e,n){var i=new Xe(e,n);try{i.c()}catch(r){throw i.d(),r}var o=i.d.bind(i);return o[Symbol.dispose]=o,o}var Vi,vn,dn=typeof window<"u"&&!!window.__PREACT_SIGNALS_DEVTOOLS__,Ki=[];pe(function(){Vi=this.N})();function et(e,n){I[e]=n.bind(null,I[e]||function(){})}function en(e){vn&&vn(),vn=e&&e.S()}function Yi(e){var n=this,i=e.data,o=ko(i);o.value=i;var r=Fi(function(){for(var s=n,d=n.__v;d=d.__;)if(d.__c){d.__c.__$f|=4;break}var c=qe(function(){var h=o.value.value;return h===0?0:h===!0?"":h||""}),f=qe(function(){return!Array.isArray(c.value)&&!Si(c.value)}),u=pe(function(){if(this.N=qi,f.value){var h=c.value;s.__v&&s.__v.__e&&s.__v.__e.nodeType===3&&(s.__v.__e.data=h)}}),p=n.__$u.d;return n.__$u.d=function(){u(),p.call(this)},[f,c]},[]),l=r[0],a=r[1];return l.value?a.peek():a.value}Yi.displayName="ReactiveTextNode";Object.defineProperties(O.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:Yi},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});et("__b",function(e,n){if(dn&&typeof n.type=="function"&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),typeof n.type=="string"){var i,o=n.props;for(var r in o)if(r!=="children"){var l=o[r];l instanceof O&&(i||(n.__np=i={}),i[r]=l,o[r]=l.peek())}}e(n)});et("__r",function(e,n){if(dn&&typeof n.type=="function"&&window.__PREACT_SIGNALS_DEVTOOLS__.enterComponent(n),n.type!==M){en();var i,o=n.__c;o&&(o.__$f&=-2,(i=o.__$u)===void 0&&(o.__$u=i=(function(r){var l;return pe(function(){l=this}),l.c=function(){o.__$f|=1,o.setState({})},l})())),en(i)}e(n)});et("__e",function(e,n,i,o){dn&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),en(),e(n,i,o)});et("diffed",function(e,n){dn&&typeof n.type=="function"&&window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent(),en();var i;if(typeof n.type=="string"&&(i=n.__e)){var o=n.__np,r=n.props;if(o){var l=i.U;if(l)for(var a in l){var s=l[a];s!==void 0&&!(a in o)&&(s.d(),l[a]=void 0)}else l={},i.U=l;for(var d in o){var c=l[d],f=o[d];c===void 0?(c=Co(i,d,f,r),l[d]=c):c.o(f,r)}}}e(n)});function Co(e,n,i,o){var r=n in e&&e.ownerSVGElement===void 0,l=v(i);return{o:function(a,s){l.value=a,o=s},d:pe(function(){this.N=qi;var a=l.value.value;o[n]!==a&&(o[n]=a,r?e[n]=a:a!=null&&(a!==!1||n[4]==="-")?e.setAttribute(n,a):e.removeAttribute(n))})}}et("unmount",function(e,n){if(typeof n.type=="string"){var i=n.__e;if(i){var o=i.U;if(o){i.U=void 0;for(var r in o){var l=o[r];l&&l.d()}}}}else{var a=n.__c;if(a){var s=a.__$u;s&&(a.__$u=void 0,s.d())}}e(n)});et("__h",function(e,n,i,o){(o<3||o===9)&&(n.__$f|=2),e(n,i,o)});pt.prototype.shouldComponentUpdate=function(e,n){var i=this.__$u,o=i&&i.s!==void 0;for(var r in n)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var l=2&this.__$f;if(!(o||l||4&this.__$f)||1&this.__$f)return!0}else if(!(o||4&this.__$f)||3&this.__$f)return!0;for(var a in e)if(a!=="__source"&&e[a]!==this.props[a])return!0;for(var s in this.props)if(!(s in e))return!0;return!1};function ko(e,n){return ae(function(){return v(e,n)})[0]}var So=function(e){queueMicrotask(function(){queueMicrotask(e)})};function $o(){wo(function(){for(var e;e=Ki.shift();)Vi.call(e)})}function qi(){Ki.push(this)===1&&(I.requestAnimationFrame||So)($o)}const zo={apiKey:"AIzaSyCr-Ej5jeuV3kdvquu2W_R0ffSrUW0OUcQ",authDomain:"tennis-coordinator-43f53.firebaseapp.com",databaseURL:"https://tennis-coordinator-43f53-default-rtdb.firebaseio.com",projectId:"tennis-coordinator-43f53",storageBucket:"tennis-coordinator-43f53.firebasestorage.app",messagingSenderId:"665148711646",appId:"1:665148711646:web:66d14722800a12f5a3184f",measurementId:"G-J0KVB2Q93W"};let Oe=null;function Ji(){if(Oe)return Oe;try{return window.firebase.initializeApp(zo),Oe=window.firebase.database(),console.log("Firebase initialized successfully"),Oe}catch(e){throw console.error("Firebase initialization error:",e),e}}function R(){return Oe||Ji()}function Io(){return t("div",{class:"landing-page",children:t("div",{class:"landing-container",children:[t("h1",{children:"ðŸŽ¾ Tennis Coordinator"}),t("p",{class:"landing-tagline",children:"Turn your love for tennis into more games."}),t("p",{class:"landing-subtitle",children:"A simple tool that helps tennis groups self-organize matches with minimal frictionâ€”so you spend less time coordinating and more time on the court."}),t("div",{class:"landing-section",children:[t("h2",{children:"Why It Works"}),t("div",{class:"landing-features",children:[t("div",{class:"feature-item",children:[t("span",{class:"feature-icon",children:"â™¦"}),t("div",{children:[t("strong",{children:"Frictionless"}),t("span",{children:"Check in with a few taps. No accounts, no apps to download."})]})]}),t("div",{class:"feature-item",children:[t("span",{class:"feature-icon",children:"â™¦"}),t("div",{children:[t("strong",{children:"Flexible"}),t("span",{children:"Handles doubles, singles, odd numbers, guests, and preferences."})]})]}),t("div",{class:"feature-item",children:[t("span",{class:"feature-icon",children:"â™¦"}),t("div",{children:[t("strong",{children:"Adaptable"}),t("span",{children:"Works for tight-knit groups of 20 or club communities of 50+."})]})]}),t("div",{class:"feature-item",children:[t("span",{class:"feature-icon",children:"â™¦"}),t("div",{children:[t("strong",{children:"Real-Time"}),t("span",{children:"Everyone sees who's playing instantly."})]})]})]})]}),t("div",{class:"landing-section landing-section-alt",children:[t("h2",{children:"How It Works"}),t("div",{class:"landing-steps",children:[t("div",{class:"step-item",children:[t("span",{class:"step-number",children:"1"}),t("div",{children:[t("strong",{children:"Check In"}),t("span",{children:"Select your name, play style, and when you're available"})]})]}),t("div",{class:"step-item",children:[t("span",{class:"step-number",children:"2"}),t("div",{children:[t("strong",{children:"Auto-Match"}),t("span",{children:"System organizes matches based on who's playing"})]})]}),t("div",{class:"step-item",children:[t("span",{class:"step-number",children:"3"}),t("div",{children:[t("strong",{children:"Play"}),t("span",{children:"Show up and enjoy the game"})]})]})]})]}),t("div",{class:"landing-cta",children:t("p",{children:"To access your tennis group, visit your group's unique URL or contact your group admin for the link."})}),t("div",{class:"landing-footer",children:t("a",{href:"#admin",class:"admin-link",onClick:e=>{e.preventDefault(),window.location.hash="admin",window.location.reload()},children:"Site Administrator? Access Site Admin â†’"})})]})})}function Tn(e){return e.toLowerCase().trim().replace(/\s+/g," ")}function Pt(e){if(!e)return"";const[n,i]=e.split(":"),o=parseInt(n),r=o>=12?"PM":"AM";return`${o%12||12}:${i}${r}`}function q(e,n){return!e&&!n?"":e&&n?`${Pt(e)}-${Pt(n)}`:e?`from ${Pt(e)}`:n?`until ${Pt(n)}`:""}function W(e){return new Date(e+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}function Zi(e){const n=new Date(e),i=new Date,o=n.toDateString()===i.toDateString(),r=n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"});return o?r:`${n.toLocaleDateString("en-US",{month:"short",day:"numeric"})} ${r}`}function En(e){const n=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return`${n}-${i}-${o}`}function Ao(){return En(new Date)}function Ro(e,n){let i=null;return function(...o){i&&clearTimeout(i),i=setTimeout(()=>{e.apply(this,o)},n)}}const T=v({groupPin:"",adminPin:""}),G=v({});function V(e){return R().ref(e)}function Mo(){B(()=>{const e=pe(()=>{const n=S.value;if(!n||n==="admin")return;V(`groups/${n}/settings`).once("value").then(o=>{const r=o.val()||{};H.value=r.groupName||"Unknown Group",F.value=r.members||[],L.value=r.memberDetails||{},T.value={groupPin:r.groupPin||"",adminPin:r.adminPin||"",shortCode:r.shortCode,location:r.location,groupDescription:r.groupDescription,groupRules:r.groupRules},document.title=`${r.groupName||"Tennis"} - Tennis Coordinator`}).catch(o=>{console.error("Error loading group settings:",o),y("Failed to load group data","error")})});return()=>{e()}},[])}function Do(){B(()=>{let e=null,n=null;const i=pe(()=>{const o=S.value;e&&n&&e.off("value",n),!(!o||o==="admin")&&(e=V(`groups/${o}/checkins`),n=e.on("value",r=>{const l=r.val()||{};Z.value=l}))});return()=>{i(),e&&n&&e.off("value",n)}},[])}function To(){B(()=>{let e=null,n=null;const i=pe(()=>{const o=S.value,r=D.value;if(e&&n&&e.off("value",n),!o||o==="admin"||!r){G.value={};return}e=V(`groups/${o}/matchNotes/${r}`),n=e.on("value",l=>{G.value=l.val()||{}})});return()=>{i(),e&&n&&e.off("value",n)}},[])}function N(e){return e.toLowerCase().replace(/\s+/g,"")}async function Eo(e){const n=S.value,i=D.value;if(!n||!i)return;const o=V(`groups/${n}/checkins/${i}`),r=Z.value[i]||[],l=N(e.name);if(r.some(d=>d.name&&N(d.name)===l)){y(`${e.name} is already checked in for this date!`,"error");return}const s={name:e.name,playStyle:e.playStyle,isGuest:e.isGuest,addedBy:e.addedBy,allowRotation:e.allowRotation,timestamp:Date.now()};e.timeRange&&(s.timeRange=e.timeRange);try{await o.set([...r,s]),y(`${e.name} checked in!`,"success"),await we(n,i,"checkin",e.name,e.addedBy),await Oo(n,e.name,i,e.addedBy,{playStyle:e.playStyle,timeRange:e.timeRange,allowRotation:e.allowRotation})}catch(d){console.error("Error adding check-in:",d),y("Failed to check in","error")}}async function Po(e,n,i){const o=S.value,r=D.value;if(!o||!r)return;const l=Z.value[r]||[],a=l[e];if(!a)return;const s=a.name||"this person",d=i&&N(i)===N(s),c=a.addedBy&&i&&N(i)===N(a.addedBy),f=sessionStorage.getItem(`adminAuth_${o}`)==="true";if(!d&&!c&&!f){y("You can only edit check-ins you added","error");return}const u=V(`groups/${o}/checkins/${r}`),p=[...l];p[e]={...p[e],...n};try{await u.set(p),y(`${s}'s preferences updated`,"success")}catch(h){console.error("Error updating check-in:",h),y("Failed to update check-in","error")}}function No(e,n){const i=S.value,o=D.value;if(!i||!o)return null;const l=(Z.value[o]||[])[e],a=l?.name||"this person",s=n&&N(n)===N(a),d=l?.addedBy&&n&&N(n)===N(l.addedBy),c=sessionStorage.getItem(`adminAuth_${i}`)==="true";return!s&&!d&&!c?(y("You can only remove check-ins you added","error"),null):{personName:a,isOwner:s}}async function Fo(e,n){const i=S.value,o=D.value;if(!i||!o)return;const r=Z.value[o]||[],a=r[e]?.name||"this person",s=n&&N(n)===N(a),d=V(`groups/${i}/checkins/${o}`),c=r.filter((f,u)=>u!==e);try{await d.set(c.length>0?c:null),y(`${a} removed`,"info"),s&&n&&(de.value=n,Y.value=!0),await we(i,o,"removal",a,n),await Lo(i,a,o,n)}catch(f){console.error("Error removing check-in:",f),y("Failed to remove check-in","error")}}async function we(e,n,i,o,r,l={}){const a={timestamp:Date.now(),action:i,player:o,by:r||o,...l};Object.keys(a).forEach(s=>{a[s]===void 0&&delete a[s]});try{await R().ref(`groups/${e}/activity/${n}`).push(a)}catch(s){console.error("Error logging activity:",s)}}async function Lo(e,n,i,o){const l=N(n)===N(o)?`ðŸŽ¾ ${n} removed themselves from ${i}`:`ðŸŽ¾ ${n} was removed from ${i} by ${o}`;try{const a=R(),d=(await a.ref(`groups/${e}/userNotifications`).once("value")).val()||{};for(const[c,f]of Object.entries(d)){const u=f.preferences||{};if(u.activityAlerts){if(c===N(o))continue;const p=u.unwatchedMembers||u.mutedMembers||[];if(p.includes(n)||p.includes(o))continue;await a.ref(`groups/${e}/userNotifications/${c}/items`).push().set({message:l,timestamp:Date.now(),read:!1,date:i})}}}catch(a){console.error("Error sending removal notifications:",a)}}function Bo(e){switch(e){case"singles":return"Singles";case"doubles":return"Doubles";default:return"Either"}}async function Oo(e,n,i,o,r){const l=N(n)===N(o),a=[];if(r.playStyle&&a.push(Bo(r.playStyle)),r.timeRange){const c=q(r.timeRange.start,r.timeRange.end);c&&a.push(c)}r.playStyle==="singles"&&r.allowRotation===!1&&a.push("No 3s");const s=a.length>0?` (${a.join(", ")})`:"",d=l?`ðŸŽ¾ ${n} checked in for ${i}${s}`:`ðŸŽ¾ ${n} was added for ${i} by ${o}${s}`;console.log("[notifyCheckinAlert] Starting notification for:",{playerName:n,date:i,addedBy:o});try{const c=R(),u=(await c.ref(`groups/${e}/userNotifications`).once("value")).val()||{};console.log("[notifyCheckinAlert] Found userNotifications entries:",Object.keys(u));for(const[p,h]of Object.entries(u)){const g=h.preferences||{};if(console.log(`[notifyCheckinAlert] User ${p}:`,{activityAlerts:g.activityAlerts,unwatchedMembers:g.unwatchedMembers||g.mutedMembers}),g.activityAlerts){if(p===N(o)){console.log(`[notifyCheckinAlert] Skipping ${p} - is addedBy`);continue}if(p===N(n)){console.log(`[notifyCheckinAlert] Skipping ${p} - is player`);continue}const x=g.unwatchedMembers||g.mutedMembers||[];if(x.includes(n)||x.includes(o)){console.log(`[notifyCheckinAlert] Skipping ${p} - player/adder is unwatched`);continue}console.log(`[notifyCheckinAlert] Sending notification to ${p}`),await c.ref(`groups/${e}/userNotifications/${p}/items`).push().set({message:d,timestamp:Date.now(),read:!1,date:i}),console.log(`[notifyCheckinAlert] Notification sent to ${p}`)}}}catch(c){console.error("Error sending check-in notifications:",c)}}async function mn(e,n,i,o,r,l){const a=o.replace(/-/g," ").replace(/\b\w/g,d=>d.toUpperCase()).replace("Forming 1","(forming)");let s;if(r==="added"){const d=l&&l.length>30?l.substring(0,30)+"...":l;s=`ðŸ“ ${i} added note to ${a}: "${d}"`}else if(r==="updated"){const d=l&&l.length>30?l.substring(0,30)+"...":l;s=`ðŸ“ ${i} updated note on ${a}: "${d}"`}else s=`ðŸ“ ${i} removed note from ${a}`;try{const d=R(),f=(await d.ref(`groups/${e}/userNotifications`).once("value")).val()||{};for(const[u,p]of Object.entries(f)){const h=p.preferences||{};if(h.activityAlerts){if(u===N(i)||(h.unwatchedMembers||h.mutedMembers||[]).includes(i))continue;await d.ref(`groups/${e}/userNotifications/${u}/items`).push().set({message:s,timestamp:Date.now(),read:!1,date:n})}}}catch(d){console.error("Error sending note notifications:",d)}}async function jo(){const e=S.value,n=D.value;if(!(!e||!n))try{await V(`groups/${e}/checkins/${n}`).remove(),await V(`groups/${e}/matchNotes/${n}`).remove(),y("Day reset","success")}catch(i){console.error("Error resetting day:",i),y("Failed to reset day","error")}}const Nt={};async function Wo(e,n){const i=S.value,o=D.value;if(!(!i||!o))try{const r=`${i}:${o}:${e}`,l=Nt[r]??G.value[e]??"",a=k.value||"Unknown";await V(`groups/${i}/matchNotes/${o}/${e}`).set(n||null),n&&!l?(await we(i,o,"note_added",a,a,{matchKey:e,noteContent:n}),await mn(i,o,a,e,"added",n),Nt[r]=n,y("Note added","success")):n&&l&&n!==l?(await we(i,o,"note_updated",a,a,{matchKey:e,noteContent:n,previousNote:l}),await mn(i,o,a,e,"updated",n),Nt[r]=n,y("Note updated","success")):!n&&l&&(await we(i,o,"note_removed",a,a,{matchKey:e,previousNote:l}),await mn(i,o,a,e,"removed"),delete Nt[r],y("Note removed","info"))}catch(r){console.error("Error saving match note:",r),y("Failed to save note","error")}}async function Ho(e){const n=S.value;if(!n)return;const i=V(`groups/${n}/settings`);try{const r=(await i.once("value")).val()||{},l=r.members||[],a=r.memberDetails||{};if(l.includes(e.name)){y("Member already exists","error");return}const s=[...l,e.name].sort(),d={...a,[e.name]:{addedBy:e.addedBy,addedDate:new Date().toISOString(),phone:e.phone||"",email:e.email||"",notes:e.notes||""}};await i.update({members:s,memberDetails:d});const c=D.value||new Date().toISOString().split("T")[0];await we(n,c,"member_added",e.name,e.addedBy,{contact:e.phone||e.email||void 0,notes:e.notes||void 0}),y(`${e.name} added to members`,"success")}catch(o){console.error("Error adding member:",o),y("Failed to add member","error")}}async function Uo(e){const n=S.value;if(!n)return;const i=V(`groups/${n}/settings`);try{const r=(await i.once("value")).val()||{},l=r.members||[],a=r.memberDetails||{},s=l.filter(u=>u!==e),d={...a};delete d[e],await i.update({members:s,memberDetails:d}),F.value=s,L.value=d;const c=D.value||new Date().toISOString().split("T")[0],f=k.value||"Admin";await we(n,c,"member_removed",e,f),y(`${e} removed from members`,"info")}catch(o){console.error("Error removing member:",o),y("Failed to remove member","error")}}async function hi(e,n){const i=S.value;if(!i)return!1;const o=V(`groups/${i}/settings`);try{const a=((await o.once("value")).val()||{}).memberDetails||{},s=a[e]||{},d={...a,[e]:{...s,phone:n.phone??s.phone??"",email:n.email??s.email??"",notes:n.notes??s.notes??""}};return await o.update({memberDetails:d}),L.value=d,y("Profile updated","success"),!0}catch(r){return console.error("Error updating member details:",r),y("Failed to update profile","error"),!1}}async function Qi(e,n){const i=S.value;if(!i)return!1;const o=n.trim();if(!o)return y("Name cannot be empty","error"),!1;if(o===e)return!0;const r=V(`groups/${i}/settings`);try{const a=(await r.once("value")).val()||{},s=a.members||[],d=a.memberDetails||{};if(s.some(m=>m.toLowerCase()===o.toLowerCase()&&m!==e))return y("A member with this name already exists","error"),!1;const c=s.map(m=>m===e?o:m).sort(),f={...d};f[e]&&(f[o]=f[e],delete f[e]),await r.update({members:c,memberDetails:f}),F.value=c,L.value=f;const u=R(),h=(await u.ref(`groups/${i}/checkins`).once("value")).val()||{};for(const[m,b]of Object.entries(h))if(b&&typeof b=="object"){const w=Object.values(b);let _=!1;const C=w.map($=>$&&$.name===e?(_=!0,{...$,name:o}):$);_&&await u.ref(`groups/${i}/checkins/${m}`).set(C)}const g=D.value||new Date().toISOString().split("T")[0],x=k.value||"Admin";return await we(i,g,"member_renamed",o,x,{oldName:e}),y(`${e} renamed to ${o}`,"success"),!0}catch(l){return console.error("Error renaming member:",l),y("Failed to rename member","error"),!1}}function _e({isOpen:e,onClose:n,title:i,subtitle:o,children:r,showCloseButton:l=!0}){return e?t("div",{class:"modal active",onClick:a=>{a.target===a.currentTarget&&n&&n()},children:t("div",{class:"modal-content",onClick:a=>a.stopPropagation(),children:[t("div",{class:"modal-header",children:[t("div",{children:[t("h2",{children:i}),o&&t("p",{style:"font-size: 12px; color: #666; margin: 4px 0 0 0;",children:o})]}),l&&n&&t("button",{class:"close-btn",onClick:n,children:"Ã—"})]}),r]})}):null}v(!1);function un(e){return e.toLowerCase().replace(/\s+/g,"")}v(!1);v(!1);v([]);v(!1);const pn=v([]);v(!1);let He=null;function Go(){const e=S.value,n=k.value;if(!(!e||!n)){He&&He();try{const o=R().ref(`groups/${e}/userNotifications/${un(n)}/items`),r=o.on("value",l=>{const a=l.val()||{},s=Object.entries(a).map(([d,c])=>({id:d,...c}));pn.value=s.sort((d,c)=>c.timestamp-d.timestamp)});He=()=>{o.off("value",r)}}catch(i){console.error("Error subscribing to notifications:",i)}}}async function Vo(e){const n=S.value,i=k.value;if(!(!n||!i))try{await R().ref(`groups/${n}/userNotifications/${un(i)}/notifications/${e}/read`).set(!0)}catch(o){console.error("Error marking notification as read:",o)}}function Ko(){B(()=>{const e=S.value,n=k.value;return e&&n&&Go(),()=>{He&&(He(),He=null)}},[S.value,k.value])}async function Yo(e){const n=S.value,i=k.value;if(!(!n||!i))try{await R().ref(`groups/${n}/userNotifications/${un(i)}/notifications/${e}`).remove()}catch(o){console.error("Error clearing notification:",o)}}async function qo(){const e=S.value,n=k.value;if(!(!e||!n))try{const i=R(),o={};pn.value.forEach(r=>{r.read||(o[`${r.id}/read`]=!0)}),Object.keys(o).length>0&&await i.ref(`groups/${e}/userNotifications/${un(n)}/items`).update(o)}catch(i){console.error("Error marking all as read:",i)}}const ne=v("checkin");function Jo(){ne.value="profile"}const yn=qe(()=>pn.value.filter(e=>!e.read).length),Zo=[{id:"checkin",label:"Check-in",icon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>',activeIcon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>'},{id:"matches",label:"My Games",icon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>',activeIcon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>'},{id:"notifications",label:"Alerts",icon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>',activeIcon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>'},{id:"help",label:"Help",icon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></svg>',activeIcon:'<svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></svg>'}];function Qo(){return t("nav",{style:{position:"fixed",bottom:0,left:"50%",transform:"translateX(-50%)",width:"100%",maxWidth:"480px",height:"calc(64px + env(safe-area-inset-bottom))",background:"#fff",borderTop:"1px solid #e0e0e0",display:"flex",justifyContent:"space-around",alignItems:"flex-start",paddingTop:"8px",zIndex:1e3,paddingBottom:"env(safe-area-inset-bottom)",boxShadow:"0 -2px 10px rgba(0,0,0,0.1)"},children:Zo.map(e=>{const n=ne.value===e.id,i=e.id==="notifications"&&yn.value>0;return t("button",{onClick:()=>{ne.value=e.id},style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"2px",background:"none",border:"none",padding:"8px 12px",cursor:"pointer",color:n?"#4CAF50":"#666",position:"relative",minWidth:"60px"},children:[t("div",{style:{position:"relative"},dangerouslySetInnerHTML:{__html:n?e.activeIcon:e.icon}}),i&&t("span",{style:{position:"absolute",top:"2px",right:"8px",background:"#f44336",color:"white",fontSize:"10px",padding:"1px 5px",borderRadius:"10px",minWidth:"16px",textAlign:"center"},children:yn.value>9?"9+":yn.value}),t("span",{style:{fontSize:"10px",fontWeight:n?"600":"400"},children:e.label})]},e.id)})})}const Ue=v(!1),Ae=v(!1);function fi(){const e=S.value;return e?sessionStorage.getItem(`adminAuth_${e}`)==="true":!1}function Xo(){const[e,n]=ae(fi());return B(()=>{const i=setInterval(()=>{n(fi())},1e3);return()=>clearInterval(i)},[]),t("h1",{style:"display: flex; justify-content: space-between; align-items: center;",children:[t("span",{children:[t("span",{id:"groupNameDisplay",children:["ðŸŽ¾ ",H.value||"Tennis Coordinator"]}),H.value&&t(M,{children:[t("br",{}),t("small",{style:"font-size: 12px; font-weight: 400; opacity: 0.8;",children:"Tennis Coordinator"})]})]}),k.value&&t("button",{onClick:Jo,style:{display:"flex",alignItems:"center",gap:"6px",background:e?"#FFF3E0":"#f5f5f5",border:e?"2px solid #FF9800":"1px solid #e0e0e0",borderRadius:"20px",padding:"6px 12px",fontSize:"14px",fontWeight:"500",color:"#333",cursor:"pointer"},children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",style:"opacity: 0.7;",children:t("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),t("span",{children:k.value}),e&&t("span",{style:{background:"#FF9800",color:"white",fontSize:"10px",padding:"2px 6px",borderRadius:"10px",fontWeight:"600"},children:"ADMIN"})]})]})}const Ft=v(""),nt=v("");function er({isOpen:e,groupName:n,correctPin:i,onSuccess:o}){const r=a=>{a.preventDefault(),Ft.value===i?(nt.value="",Ft.value="",o()):(nt.value="Invalid PIN. Please try again.",y("Invalid PIN","error"))},l=a=>{Ft.value=a.target.value,nt.value=""};return t(_e,{isOpen:e,title:`Welcome to ${n||"Tennis Coordinator"}`,showCloseButton:!1,children:t("div",{style:"text-align: center; padding: 20px 0;",children:[t("p",{style:"font-size: 48px; margin-bottom: 16px;",children:"ðŸŽ¾"}),t("p",{style:"color: #666; margin-bottom: 24px;",children:"Enter the group PIN to access check-ins"}),t("form",{onSubmit:r,children:[t("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Enter PIN",value:Ft.value,onInput:l,style:`
              width: 100%;
              padding: 16px;
              font-size: 24px;
              text-align: center;
              border: 2px solid #e0e0e0;
              border-radius: 12px;
              margin-bottom: 16px;
              letter-spacing: 8px;
            `,autoFocus:!0}),nt.value&&t("p",{style:"color: #f44336; font-size: 14px; margin-bottom: 16px;",children:nt.value}),t("button",{type:"submit",style:`
              width: 100%;
              padding: 16px;
              background: #4CAF50;
              color: white;
              border: none;
              border-radius: 12px;
              font-size: 18px;
              font-weight: 600;
              cursor: pointer;
            `,children:"Enter"})]}),t("p",{style:"font-size: 12px; color: #999; margin-top: 16px;",children:"Don't know the PIN? Ask your group admin."})]})})}const Gn=v(!1),Vn=v(""),Kn=v(""),Yn=v("");function qn(e){const n=H.value||"our tennis group",i=S.value,o=window.location.href.split("?")[0]+"?group="+i,r=T.value.groupPin||"";return`Hi ${e}! You've been added to ${n} tennis coordination.

Check in for upcoming matches here:
${o}

PIN: ${r}

Just select your name and check in when you can play!`}function tr(e,n){const i=e.replace(/[\s\-\(\)]/g,""),o=navigator.userAgent||"";return/iPad|iPhone|iPod/.test(o)?`sms:${i}&body=${encodeURIComponent(n)}`:`sms:${i}?body=${encodeURIComponent(n)}`}function nr(e,n,i){return`mailto:${e}?subject=${encodeURIComponent(n)}&body=${encodeURIComponent(i)}`}async function ir(e){const n=qn(e),i=H.value||"Tennis Group";try{await navigator.share({title:`Join ${i}`,text:n}),Re(),y("Shared successfully!","success")}catch(o){o.name!=="AbortError"&&(console.error("Share failed:",o),Xi(e))}}async function Xi(e){const n=qn(e);try{await navigator.clipboard.writeText(n),Re(),y("Message copied! Paste in SMS or email.","success")}catch{const o=document.createElement("textarea");o.value=n,o.style.position="fixed",o.style.left="-9999px",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),Re(),y("Message copied! Paste in SMS or email.","success")}}function Re(){Gn.value=!1,Vn.value="",Kn.value="",Yn.value=""}function eo(e,n,i){Vn.value=e,Kn.value=n||"",Yn.value=i||"",Gn.value=!0}function or(){const e=Vn.value,n=Kn.value,i=Yn.value,o=qn(e),r=H.value||"Tennis Group",l=typeof navigator<"u"&&navigator.share!==void 0;return t(_e,{isOpen:Gn.value,onClose:Re,title:"",showCloseButton:!1,children:t("div",{style:{textAlign:"center",padding:"10px 0"},children:[t("h3",{style:{margin:"0 0 12px 0",fontSize:"16px"},children:["Invite ",e,"?"]}),t("p",{style:{margin:"0 0 16px 0",color:"#666",fontSize:"14px"},children:"Send them an invite with the group link and PIN"}),t("div",{style:{display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[n&&t("a",{href:tr(n,o),onClick:()=>setTimeout(Re,500),style:{background:"#25D366",color:"white",padding:"12px 20px",border:"none",borderRadius:"8px",fontSize:"14px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"8px",textDecoration:"none"},children:[t("span",{children:"ðŸ“±"})," Text ",n]}),i&&t("a",{href:nr(i,`You're invited to ${r}`,o),onClick:()=>setTimeout(Re,500),style:{background:"#4285F4",color:"white",padding:"12px 20px",border:"none",borderRadius:"8px",fontSize:"14px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"8px",textDecoration:"none"},children:[t("span",{children:"ðŸ“§"})," Email"]}),l&&t("button",{onClick:()=>ir(e),style:{background:"#9C27B0",color:"white",padding:"12px 20px",border:"none",borderRadius:"8px",fontSize:"14px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"8px"},children:[t("span",{children:"ðŸ“¤"})," Other"]}),t("button",{onClick:()=>Xi(e),style:{background:"#607D8B",color:"white",padding:"12px 20px",border:"none",borderRadius:"8px",fontSize:"14px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"8px"},children:[t("span",{children:"ðŸ“‹"})," Copy"]})]}),t("button",{onClick:Re,style:{marginTop:"12px",background:"none",border:"none",color:"#999",fontSize:"14px",cursor:"pointer"},children:"Skip"})]})})}const hn=v(!1),tn=v(""),Je=v(null),nn=v(""),xt=v(""),bt=v(""),wt=v(""),ze=v("");async function gi(){const e=tn.value.trim();if(!e)return;const n=S.value;if(n){if(F.value.includes(e)){y("Member already exists","error");return}try{const o=R().ref(`groups/${n}/settings`),r=[...F.value,e].sort();await o.update({members:r}),F.value=r,tn.value="",y(`${e} added`,"success")}catch(i){console.error("Error adding member:",i),y("Failed to add member","error")}}}function rr(e){confirm(`Remove ${e} from the group?`)&&Uo(e)}function lr(e){Je.value=e,nn.value=e;const n=L.value[e]||{};xt.value=n.phone||"",bt.value=n.email||"",wt.value=n.notes||""}async function ar(){const e=Je.value;if(!e)return;const n=S.value;if(!n)return;const i=nn.value.trim();try{if(i!==e&&!await Qi(e,i))return;const o=i!==e?i:e;await R().ref(`groups/${n}/settings/memberDetails/${o}`).update({phone:xt.value,email:bt.value,notes:wt.value}),L.value={...L.value,[o]:{...L.value[o]||{},phone:xt.value,email:bt.value,notes:wt.value}},Je.value=null,i===e&&y("Member updated","success")}catch(o){console.error("Error updating member:",o),y("Failed to update member","error")}}function sr(){hn.value=!1,Je.value=null,ze.value=""}function cr(){const e=F.value.filter(n=>n.toLowerCase().includes(ze.value.toLowerCase())).sort((n,i)=>n.localeCompare(i));return t(_e,{isOpen:hn.value,onClose:sr,title:"Manage Members",subtitle:`${F.value.length} members in group`,children:[Je.value&&t("div",{style:"position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1001;",children:t("div",{style:"background: white; padding: 24px; border-radius: 12px; max-width: 400px; width: 90%;",children:[t("h3",{style:"margin-top: 0;",children:"Edit Member"}),t("div",{style:"margin-bottom: 12px;",children:[t("label",{style:"font-size: 12px; color: #666; display: block; margin-bottom: 4px;",children:"Name"}),t("input",{type:"text",placeholder:"Member name",value:nn.value,onInput:n=>{nn.value=n.target.value},style:"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; box-sizing: border-box;"})]}),t("div",{style:"margin-bottom: 12px;",children:[t("label",{style:"font-size: 12px; color: #666; display: block; margin-bottom: 4px;",children:"Phone"}),t("input",{type:"tel",placeholder:"Phone number",value:xt.value,onInput:n=>{xt.value=n.target.value},style:"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; box-sizing: border-box;"})]}),t("div",{style:"margin-bottom: 12px;",children:[t("label",{style:"font-size: 12px; color: #666; display: block; margin-bottom: 4px;",children:"Email"}),t("input",{type:"email",placeholder:"Email address",value:bt.value,onInput:n=>{bt.value=n.target.value},style:"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; box-sizing: border-box;"})]}),t("div",{style:"margin-bottom: 16px;",children:[t("label",{style:"font-size: 12px; color: #666; display: block; margin-bottom: 4px;",children:"Notes"}),t("textarea",{placeholder:"Notes (skill level, etc.)",rows:2,value:wt.value,onInput:n=>{wt.value=n.target.value},style:"width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; resize: vertical; box-sizing: border-box;"})]}),t("div",{style:"display: flex; gap: 8px;",children:[t("button",{onClick:()=>{Je.value=null},style:"flex: 1; background: #ccc; color: #333;",children:"Cancel"}),t("button",{onClick:ar,style:"flex: 1; background: #4CAF50; color: white;",children:"Save"})]})]})}),t("div",{style:"margin-bottom: 16px;",children:t("div",{style:"position: relative;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#999",style:"position: absolute; left: 12px; top: 50%; transform: translateY(-50%);",children:t("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),t("input",{type:"text",placeholder:"Search members...",value:ze.value,onInput:n=>{ze.value=n.target.value},style:"width: 100%; padding: 12px 12px 12px 40px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; box-sizing: border-box;"}),ze.value&&t("button",{onClick:()=>{ze.value=""},style:"position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; padding: 0;",children:t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#999",children:t("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]})}),t("div",{style:"max-height: 400px; overflow-y: auto; margin-bottom: 16px;",children:e.length===0?t("div",{style:"text-align: center; padding: 20px; color: #888;",children:ze.value?"No members found":"No members yet"}):e.map(n=>{const i=L.value[n],o=i&&(i.phone||i.email||i.addedBy),r=i&&(i.phone||i.email),l=i?.addedDate?new Date(i.addedDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):null;return t("div",{style:"flex-direction: column; align-items: flex-start; padding: 12px; background: #f9f9f9; border-radius: 8px; margin-bottom: 8px;",children:[t("div",{style:"display: flex; justify-content: space-between; width: 100%; align-items: center;",children:[t("span",{style:"font-weight: 500;",children:n}),t("div",{style:"display: flex; gap: 4px;",children:[t("button",{onClick:()=>lr(n),style:{background:"rgba(76, 175, 80, 0.1)",color:"#4CAF50",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0"},title:"Edit",children:t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})}),r&&t("button",{onClick:()=>eo(n,i?.phone,i?.email),style:{background:"rgba(33, 150, 243, 0.1)",color:"#2196F3",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0"},title:"Invite",children:t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})})}),t("button",{onClick:()=>rr(n),style:{background:"rgba(255, 82, 82, 0.1)",color:"#e57373",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0"},title:"Remove",children:t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]})]}),o&&t("div",{style:"font-size: 12px; color: #666; margin-top: 8px; padding-left: 12px; border-left: 3px solid #4CAF50;",children:[i.addedBy&&t("div",{children:["Added by: ",t("strong",{children:i.addedBy}),l&&` on ${l}`]}),i.phone&&t("div",{children:["ðŸ“± ",i.phone]}),i.email&&t("div",{children:["ðŸ“§ ",i.email]}),i.notes&&t("div",{children:["Notes: ",i.notes]})]})]},n)})}),t("div",{style:"display: flex; gap: 8px; padding-top: 12px; border-top: 1px solid #e0e0e0;",children:[t("input",{type:"text",placeholder:"New member name",value:tn.value,onInput:n=>{tn.value=n.target.value},onKeyPress:n=>{n.key==="Enter"&&gi()},style:"flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px;"}),t("button",{onClick:gi,style:"padding: 12px 24px; background: #4CAF50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 500;",children:"Add"})]})]})}const Ge=v(""),_t=v(""),Ct=v(""),Me=v(""),Ve=v(""),Ke=v(""),kt=v(""),St=v(""),Jn=v(!0),$t=v(""),Pn=v(!1);function dr(){const e=S.value;if(!e)return!1;const n=`adminAuth_${e}`;return sessionStorage.getItem(n)==="true"}function ur(){const e=S.value;e&&(sessionStorage.setItem(`adminAuth_${e}`,"true"),Pn.value=!0)}function pr(){Ge.value=H.value||"",_t.value=T.value.adminPin||"",Ct.value=T.value.groupPin||"",Me.value=T.value.location?.name||"",Ve.value=T.value.location?.lat?.toString()||"",Ke.value=T.value.location?.lon?.toString()||"",kt.value=T.value.groupDescription||"",St.value=T.value.groupRules||"",Pn.value=dr(),Jn.value=!Pn.value&&!!T.value.adminPin,$t.value=""}async function hr(e=!1){const n=S.value;if(n)try{const o=R().ref(`groups/${n}/settings`),r={groupName:Ge.value,adminPin:_t.value,groupPin:Ct.value,groupDescription:kt.value||null,groupRules:St.value||null};Me.value&&Ve.value&&Ke.value&&(r.location={name:Me.value,lat:parseFloat(Ve.value),lon:parseFloat(Ke.value)}),await o.update(r),H.value=Ge.value,T.value={...T.value,adminPin:_t.value,groupPin:Ct.value,location:Me.value?{name:Me.value,lat:parseFloat(Ve.value),lon:parseFloat(Ke.value)}:void 0,groupDescription:kt.value||void 0,groupRules:St.value||void 0},y("Settings saved","success"),e&&Nn()}catch(i){console.error("Error saving settings:",i),y("Failed to save settings","error")}}function vi(){$t.value===T.value.adminPin?(ur(),Jn.value=!1):(y("Incorrect PIN","error"),$t.value="")}function Nn(){Ae.value=!1}function fr(){return Ae.value&&Ge.value===""&&H.value&&pr(),t(_e,{isOpen:Ae.value,onClose:Nn,title:"Admin Settings",subtitle:`Managing: ${H.value}`,children:Jn.value?t("div",{style:"padding: 20px; text-align: center;",children:[t("p",{style:"margin-bottom: 16px; color: #666;",children:"Enter admin PIN to access settings"}),t("input",{type:"password",placeholder:"Admin PIN",value:$t.value,onInput:e=>{$t.value=e.target.value},onKeyPress:e=>{e.key==="Enter"&&vi()},style:"width: 100%; max-width: 200px; padding: 12px; text-align: center; font-size: 18px; border: 2px solid #e0e0e0; border-radius: 8px; margin-bottom: 16px;"}),t("br",{}),t("button",{onClick:vi,style:"padding: 12px 32px; background: #4CAF50; color: white;",children:"Submit"})]}):t(M,{children:[t("div",{style:"margin-bottom: 16px;",children:t("button",{onClick:()=>{Ue.value=!0,Ae.value=!1},style:"width: 100%; padding: 12px 16px; background: #f5f5f5; border: 1px solid #e0e0e0; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 10px; font-size: 14px; color: #333;",children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",style:"color: #666;",children:t("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"})}),t("div",{style:"flex: 1; text-align: left;",children:[t("div",{style:"font-weight: 500;",children:"Activity History"}),t("div",{style:"font-size: 12px; color: #666;",children:"View all check-ins, changes, and match updates"})]}),t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",style:"color: #999;",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]})}),t("div",{style:"margin-bottom: 16px;",children:t("button",{onClick:()=>{hn.value=!0,Ae.value=!1},style:"width: 100%; padding: 12px 16px; background: #f5f5f5; border: 1px solid #e0e0e0; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 10px; font-size: 14px; color: #333;",children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",style:"color: #4CAF50;",children:t("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})}),t("div",{style:"flex: 1; text-align: left;",children:[t("div",{style:"font-weight: 500;",children:"Manage Members"}),t("div",{style:"font-size: 12px; color: #666;",children:"Add, edit, or remove group members"})]}),t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",style:"color: #999;",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]})}),t("div",{style:"margin-bottom: 16px; padding-top: 16px; border-top: 1px solid #e0e0e0;",children:t("div",{style:"display: flex; justify-content: space-between; align-items: center;",children:[t("h3",{style:"margin: 0; color: #333;",children:"Group Settings"}),t("span",{style:"font-size: 11px; color: #666; background: #f5f5f5; padding: 2px 8px; border-radius: 10px;",children:"Click Save to apply"})]})}),t("div",{class:"pref-section",children:[t("h3",{children:"Group Name"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"Display name for this tennis group"}),t("input",{type:"text",placeholder:"e.g., Tue/Thu Midday Doubles",value:Ge.value,onInput:e=>{Ge.value=e.target.value},style:"width: 100%; margin-bottom: 12px;"})]}),t("div",{class:"pref-section",children:[t("h3",{children:"Group Story"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"Tell your group's story - when/where you play, how it started, etc."}),t("textarea",{placeholder:"e.g., We're a group of friends who play doubles every Tuesday and Thursday at noon at Los Gatos High School courts...",value:kt.value,onInput:e=>{kt.value=e.target.value},rows:3,style:"width: 100%; margin-bottom: 12px; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; resize: vertical; font-family: inherit; box-sizing: border-box;"})]}),t("div",{class:"pref-section",children:[t("h3",{children:"Rules & Tips"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"House rules, etiquette, and tips for new members (one per line)"}),t("textarea",{placeholder:`e.g.,
Check in by 10am on game days
Bring water and sunscreen
New balls provided by rotating member...`,value:St.value,onInput:e=>{St.value=e.target.value},rows:4,style:"width: 100%; margin-bottom: 12px; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; resize: vertical; font-family: inherit; box-sizing: border-box;"})]}),t("div",{class:"pref-section",children:[t("h3",{children:"Admin PIN"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"Required to access admin settings"}),t("input",{type:"text",value:_t.value,onInput:e=>{_t.value=e.target.value},style:"width: 100%; margin-bottom: 12px;"})]}),t("div",{class:"pref-section",children:[t("h3",{children:"Group PIN"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"Share this PIN with all group members to access the app"}),t("input",{type:"text",value:Ct.value,onInput:e=>{Ct.value=e.target.value},style:"width: 100%; margin-bottom: 12px;"})]}),t("div",{class:"pref-section",children:[t("h3",{children:"Weather Location"}),t("p",{style:"font-size: 12px; color: #666; margin-bottom: 8px;",children:"Set the location for weather forecasts"}),t("input",{type:"text",placeholder:"Location name (e.g., Los Gatos, CA)",value:Me.value,onInput:e=>{Me.value=e.target.value},style:"width: 100%; margin-bottom: 8px;"}),t("div",{style:"display: flex; gap: 8px; margin-bottom: 12px;",children:[t("input",{type:"number",step:"0.0001",placeholder:"Latitude",value:Ve.value,onInput:e=>{Ve.value=e.target.value},style:"flex: 1;"}),t("input",{type:"number",step:"0.0001",placeholder:"Longitude",value:Ke.value,onInput:e=>{Ke.value=e.target.value},style:"flex: 1;"})]}),t("p",{style:"font-size: 11px; color: #999; margin-bottom: 12px;",children:["Tip: Use ",t("a",{href:"https://www.latlong.net/",target:"_blank",style:"color: #4CAF50;",children:"latlong.net"})," to find coordinates"]})]}),t("div",{style:"display: flex; gap: 8px; margin-top: 16px;",children:[t("button",{onClick:Nn,style:"flex: 1; background: #e0e0e0; color: #333;",children:"Close"}),t("button",{onClick:()=>hr(!0),style:"flex: 1; background: #4CAF50; color: white;",children:"Save & Close"})]})]})})}const to={login:{label:"Logins",actions:["user_login"]},checkin:{label:"Check-ins",actions:["check-in","checkin"]},removal:{label:"Removals",actions:["removal"]},shared:{label:"Shared",actions:["whatsapp_share"]},notes:{label:"Notes",actions:["notes_saved","note_added","note_updated","note_removed"]},members:{label:"Members",actions:["member_added","member_removed","member_renamed"]}},Be=v(!1),zt=v([]),Fn=v(!1),ie=v(new Set);async function gr(){const e=S.value;if(e){Fn.value=!0;try{const n=R();let i=[];const r=(await n.ref(`groups/${e}/activity`).once("value")).val();if(r){for(const[l,a]of Object.entries(r))if(a)for(const[s,d]of Object.entries(a))i.push({...d,date:l,firebaseKey:s})}i.sort((l,a)=>a.timestamp-l.timestamp),zt.value=i}catch(n){console.error("Error loading activity:",n)}finally{Fn.value=!1}}}async function vr(e){const n=S.value;if(!(!n||!e.firebaseKey||!e.date)&&confirm("Remove this activity entry?"))try{await R().ref(`groups/${n}/activity/${e.date}/${e.firebaseKey}`).remove(),zt.value=zt.value.filter(o=>!(o.date===e.date&&o.firebaseKey===e.firebaseKey))}catch(i){console.error("Error deleting activity:",i),alert("Failed to delete activity")}}function mr(e){switch(e){case"singles":return"Singles";case"doubles":return"Doubles";default:return"Either"}}function yr(e){return Zi(e)}function xr(e){switch(e){case"check-in":case"checkin":return"âœ…";case"removal":return"âŒ";case"member_added":return"ðŸ‘¤";case"member_removed":return"ðŸš«";case"member_renamed":return"âœï¸";case"whatsapp_share":return"ðŸ“¤";case"notes_saved":case"note_added":return"ðŸ“";case"note_updated":return"âœï¸";case"note_removed":return"ðŸ—‘ï¸";case"user_login":return"ðŸ”“";default:return"ðŸ“‹"}}function br(e){const{action:n,player:i,by:o,playStyle:r,timeRange:l,matchKey:a,type:s}=e;switch(n){case"check-in":case"checkin":{let d=`${i} checked in`;return o&&o!==i&&(d+=` (by ${o})`),r&&(d+=` - ${mr(r)}`,(l?.start||l?.end)&&(d+=` (${l.start||"anytime"}â€“${l.end||"anytime"})`)),d}case"removal":return o&&o!==i?`${o} removed ${i}`:`${i} removed themselves`;case"member_added":return`${o} added ${i} as member`;case"member_removed":return`${o} removed ${i} from members`;case"member_renamed":return`${o} renamed ${e.oldName} to ${i}`;case"whatsapp_share":{let c=`${o} shared ${s==="matches"?"matches":s==="checkin"?"check-in":"removal"} to WhatsApp`;return i&&i!==o&&(c+=` (for ${i})`),c}case"notes_saved":case"note_added":{const d=a?a.replace("-"," #").replace("forming 1","forming"):"match",c=e.noteContent?`: "${e.noteContent.length>30?e.noteContent.substring(0,30)+"...":e.noteContent}"`:"";return`${o} added note to ${d}${c}`}case"note_updated":{const d=a?a.replace("-"," #").replace("forming 1","forming"):"match",c=e.noteContent?`: "${e.noteContent.length>30?e.noteContent.substring(0,30)+"...":e.noteContent}"`:"";return`${o} updated note on ${d}${c}`}case"note_removed":{const d=a?a.replace("-"," #").replace("forming 1","forming"):"match";return`${o} removed note from ${d}`}case"user_login":return`${i} logged in`;default:return`${i} - ${n}`}}function wr(e){const n=new Set(ie.value);n.has(e)?n.delete(e):n.add(e),ie.value=n}function _r(){if(ie.value.size===0)return zt.value;const e=new Set;return ie.value.forEach(n=>{to[n].actions.forEach(i=>e.add(i))}),zt.value.filter(n=>e.has(n.action))}function Cr(){Ue.value=!1,Be.value=!1,ie.value=new Set}function kr(){B(()=>{Ue.value&&gr()},[Ue.value]);const e=_r(),n={};return Be.value?e.forEach(i=>{n[i.date]||(n[i.date]=[]),n[i.date].push(i)}):e.forEach(i=>{const o=new Date(i.timestamp).toISOString().split("T")[0];n[o]||(n[o]=[]),n[o].push(i)}),t(_e,{isOpen:Ue.value,onClose:Cr,title:"Activity History",children:[t("div",{style:"display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 12px;",children:[Object.entries(to).map(([i,o])=>{const r=ie.value.has(i);return t("button",{onClick:()=>wr(i),style:{padding:"4px 10px",fontSize:"12px",border:r?"1px solid #4CAF50":"1px solid #ddd",borderRadius:"16px",background:r?"#E8F5E9":"#fff",color:r?"#2E7D32":"#666",cursor:"pointer",fontWeight:r?"500":"400"},children:o.label},i)}),ie.value.size>0&&t("button",{onClick:()=>{ie.value=new Set},style:{padding:"4px 10px",fontSize:"12px",border:"1px solid #f44336",borderRadius:"16px",background:"#fff",color:"#f44336",cursor:"pointer"},children:"Clear"})]}),t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;",children:[t("p",{style:"font-size: 13px; color: #666; margin: 0;",children:[Be.value?"Grouped by play date":"Grouped by when changes were made",ie.value.size>0&&` (${e.length} filtered)`]}),t("label",{style:"font-size: 13px; color: #666; cursor: pointer; display: flex; align-items: center; gap: 4px;",children:[t("input",{type:"checkbox",checked:Be.value,onChange:i=>{Be.value=i.target.checked}}),"Group by Play Date"]})]}),t("div",{style:"max-height: 400px; overflow-y: auto;",children:Fn.value?t("p",{style:"color: #999; text-align: center; padding: 24px;",children:"Loading..."}):e.length===0?t("p",{style:"color: #999; text-align: center; padding: 24px;",children:ie.value.size>0?"No matching activities":"No activity recorded yet"}):Object.entries(n).sort(([i],[o])=>o.localeCompare(i)).map(([i,o])=>t("div",{children:[t("div",{style:"font-weight: bold; color: #666; margin-top: 12px; padding-bottom: 4px; border-bottom: 1px solid #ddd;",children:W(i)}),o.map((r,l)=>t("div",{style:"padding: 10px; background: #f9f9f9; border-radius: 6px; font-size: 14px; margin-top: 8px; position: relative;",children:t("div",{style:"display: flex; align-items: flex-start; gap: 6px;",children:[t("span",{children:xr(r.action)}),t("div",{style:"flex: 1;",children:[br(r),t("div",{style:"font-size: 12px; color: #999; margin-top: 4px; display: flex; gap: 8px; flex-wrap: wrap;",children:[t("span",{children:yr(r.timestamp)}),Be.value?t("span",{style:"color: #666;",children:["changed on ",W(new Date(r.timestamp).toISOString().split("T")[0])]}):t("span",{style:"color: #4CAF50;",children:["for ",W(r.date)]})]})]}),t("button",{onClick:()=>vr(r),title:"Remove this activity",style:{background:"none",border:"none",padding:"4px",cursor:"pointer",color:"#999",fontSize:"16px",lineHeight:"1",borderRadius:"4px",transition:"color 0.2s, background 0.2s"},onMouseOver:a=>{a.target.style.color="#f44336",a.target.style.background="#ffebee"},onMouseOut:a=>{a.target.style.color="#999",a.target.style.background="none"},children:t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]})},l))]},i))})]})}const It=v(!1);async function Sr(e,n){try{const i=R(),o=new Date().toISOString().split("T")[0];await i.ref(`groups/${e}/activity/${o}`).push({timestamp:Date.now(),action:"user_login",player:n,by:n})}catch(i){console.error("Error logging login activity:",i)}}function $r(e){const n=e.target.value;if(!n)return;k.value=n;const i=S.value;i&&(localStorage.setItem(`sessionUser_${i}`,n),Sr(i,n)),de.value=n,Y.value=!0,It.value=!1,window.scrollTo(0,0),y(`Welcome, ${n}!`,"success")}function zr(){const e=[...F.value].sort((n,i)=>n.localeCompare(i));return t(_e,{isOpen:It.value,title:"",showCloseButton:!1,children:t("div",{style:"text-align: center; padding: 10px 0;",children:[t("h2",{style:"margin-top: 0; font-size: 24px;",children:"Welcome!"}),t("p",{style:"color: #4CAF50; font-weight: 500; margin-bottom: 16px; font-size: 16px;",children:H.value}),t("p",{style:"color: #666; margin-bottom: 20px;",children:"Select your name to start"}),t("select",{onChange:$r,style:"width: 100%; padding: 12px; font-size: 16px; border: 2px solid #e0e0e0; border-radius: 8px;",children:[t("option",{value:"",children:"Select your name..."}),e.map(n=>t("option",{value:n,children:n},n))]})]})})}function Ir(e){if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function Ar(e){return`https://wa.me/?text=${encodeURIComponent(e)}`}function no(e){const n=new Date(e+"T12:00:00"),i=n.toLocaleDateString("en-US",{weekday:"long"}),o=n.toLocaleDateString("en-US",{month:"long"}),r=n.getDate(),l=Ir(r);return`${i}, ${o} ${r}${l}`}function Rr(e,n,i){const o=no(n),r=[];r.push(`I'm checking in for tennis on ${o}!`),r.push("");const l=i.playStyle==="singles"?"Singles only":i.playStyle==="doubles"?"Doubles only":"Either singles or doubles";if(r.push(`Preference: ${l}`),i.timeRange){const a=q(i.timeRange.start,i.timeRange.end);a&&r.push(`Available: ${a}`)}return r.join(`
`)}function Mr(e,n){return`I'm no longer available for tennis on ${no(n)}.`}async function Dr(e){try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(e),!0;const n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.left="-999999px",n.style.top="-999999px",document.body.appendChild(n),n.focus(),n.select();const i=document.execCommand("copy");return document.body.removeChild(n),i}catch{return!1}}function Tr(){if(B(()=>{if(se.value){const f=setTimeout(()=>{se.value=!1,ye.value=null},8e3);return()=>clearTimeout(f)}},[se.value]),!se.value||!ye.value)return null;const e=ye.value,n=e.action==="removal",i=()=>n?Mr(e.name,e.date):Rr(e.name,e.date,{playStyle:e.playStyle||"both",timeRange:e.timeRange});return t("div",{style:{position:"fixed",bottom:"70px",left:"50%",transform:"translateX(-50%)",width:"calc(100% - 24px)",maxWidth:"456px",background:n?"#FFF3E0":"#E8F5E9",borderRadius:"12px",padding:"12px 16px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",gap:"12px",zIndex:1e3,animation:"slideUp 0.3s ease-out"},children:[t("div",{style:{flex:1,fontSize:"14px",color:n?"#E65100":"#2E7D32"},children:[t("strong",{children:n?"Removed!":"Checked in!"})," ",n?"Let others know?":"Share with the group?"]}),t("div",{style:{display:"flex",gap:"8px"},children:[t("button",{onClick:()=>{const f=i(),u=Ar(f);window.open(u,"_blank"),se.value=!1,ye.value=null},style:{background:"#25D366",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",fontSize:"13px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"white",children:t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp"]}),t("button",{onClick:async()=>{const f=i();await Dr(f)?y("Copied to clipboard","success"):y("Failed to copy","error"),se.value=!1,ye.value=null},style:{background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:"8px",padding:"8px 12px",fontSize:"13px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"#666",children:t("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),"Copy"]}),t("button",{onClick:()=>{se.value=!1,ye.value=null},style:{background:"transparent",border:"none",padding:"4px",cursor:"pointer",color:"#666",fontSize:"18px",lineHeight:1},title:"Dismiss",children:"Ã—"})]}),t("style",{children:`
        @keyframes slideUp {
          from {
            transform: translate(-50%, 100%);
            opacity: 0;
          }
          to {
            transform: translate(-50%, 0);
            opacity: 1;
          }
        }
      `})]})}function mi(e){return e.toLowerCase().replace(/\s+/g,"")}function Er(e){const n=k.value;return n?(Z.value[e]||[]).some(o=>o.name&&mi(o.name)===mi(n)):!0}function Pr(e){D.value=e,k.value&&!Er(e)?(de.value=k.value,Y.value=!0):(de.value="",Y.value=!1)}function Nr(){const e=mo(null);B(()=>{const r=e.current;if(!r)return;const l=setTimeout(()=>{const a=r.querySelector('[data-today="true"]');a&&a.scrollIntoView({behavior:"instant",inline:"start",block:"nearest"})},50);return()=>clearTimeout(l)},[]);const n=[],i=new Date,o=En(i);for(let r=-14;r<=14;r++){const l=new Date(i);l.setDate(i.getDate()+r);const a=En(l),s=l.toLocaleDateString("en-US",{weekday:"short"}),d=l.getDate(),c=l.toLocaleDateString("en-US",{month:"short"}),u=(Z.value[a]||[]).length,p=a===o,h=r<0;n.push({value:a,dayName:s,dayNum:d,monthName:c,isToday:p,isPast:h,checkinCount:u})}return t("div",{class:"date-selector",children:t("div",{class:"date-scroll",ref:e,children:n.map(r=>t("button",{class:`date-btn ${D.value===r.value?"selected":""} ${r.isPast?"past":""}`,onClick:()=>Pr(r.value),"data-date":r.value,"data-today":r.isToday?"true":void 0,children:[t("span",{class:"day-name",children:r.dayName}),t("span",{class:"day-num",children:r.dayNum}),t("span",{class:"month-name",children:r.monthName}),r.isToday&&t("span",{class:"today-badge",children:"Today"}),r.checkinCount>0&&t("span",{class:"checkin-badge",children:r.checkinCount})]},r.value))})})}function Fr(){const e=a=>{const s=a.target.value;if(de.value=s,s==="__guest__")fe.value=!0,Ce.value=!1,Y.value=!0;else if(s==="__new_member__")Ce.value=!0,fe.value=!1,Y.value=!0;else if(s){if(fe.value=!1,Ce.value=!1,Y.value=!0,!k.value){k.value=s;const d=S.value;d&&localStorage.setItem(`sessionUser_${d}`,s)}}else Y.value=!1},n=async()=>{let a=de.value,s="";if(fe.value){if(!ot.value.trim()){y("Please enter guest name","error");return}if(!st.value){y("Please select who is adding the guest","error");return}a=ot.value.trim(),s=st.value}if(!a||a==="__guest__"||a==="__new_member__"){y("Please select a name","error");return}const d=he.value,c=ke.value&&Se.value?{start:ke.value,end:Se.value}:void 0;await Eo({name:a,playStyle:d,isGuest:fe.value,addedBy:fe.value?s:k.value,allowRotation:Wt.value,timeRange:c}),ye.value={action:"checkin",name:a,playStyle:d,timeRange:c,date:D.value},se.value=!0,r()},i=async()=>{if(!Ne.value.trim()){y("Please enter member name","error");return}if(!k.value){y("Please select your name first","error");return}const a=Ne.value.trim(),s=rt.value.trim(),d=lt.value.trim();await Ho({name:a,phone:s,email:d,notes:at.value.trim(),addedBy:k.value}),Ne.value="",rt.value="",lt.value="",at.value="",Ce.value=!1,de.value="",Y.value=!1,(s||d)&&eo(a,s,d)},o=()=>{r()},r=()=>{de.value="",fe.value=!1,Ce.value=!1,ot.value="",Ne.value="",rt.value="",lt.value="",at.value="",st.value="",he.value="both",Wt.value=!0,ke.value="",Se.value="",Y.value=!1},l=(a,s)=>{ke.value=a,Se.value=s};return t(M,{children:[t("div",{class:"input-group",children:t("select",{id:"nameSelect",value:de.value,onChange:e,children:[t("option",{value:"",children:k.value?"Check-in another player...":"Select your name..."}),[...F.value].sort((a,s)=>a.localeCompare(s)).map(a=>t("option",{value:a,children:a},a)),t("option",{disabled:!0,children:"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"}),t("option",{value:"__guest__",children:"+ Add Guest"}),t("option",{value:"__new_member__",children:"+ Add New Member"})]})}),Y.value&&t("div",{class:"collapsible-form expanded",id:"checkInFormFields",children:[fe.value&&t("div",{class:"guest-form active",children:[t("input",{type:"text",placeholder:"Guest's name",value:ot.value,onInput:a=>{ot.value=a.target.value}}),t("select",{value:st.value,onChange:a=>{st.value=a.target.value},children:[t("option",{value:"",children:"Who is adding this guest?"}),[...F.value].sort((a,s)=>a.localeCompare(s)).map(a=>t("option",{value:a,children:a},a))]})]}),Ce.value&&t("div",{class:"member-form",children:[t("h3",{style:"font-size: 14px; margin-bottom: 12px; color: #333;",children:"Add New Member"}),t("input",{type:"text",placeholder:"Member's full name",value:Ne.value,onInput:a=>{Ne.value=a.target.value},style:"margin-bottom: 8px;"}),t("div",{style:"display: flex; gap: 8px; margin-bottom: 8px;",children:[t("input",{type:"tel",placeholder:"Phone (optional)",value:rt.value,onInput:a=>{rt.value=a.target.value},style:"flex: 1;"}),t("input",{type:"email",placeholder:"Email (optional)",value:lt.value,onInput:a=>{lt.value=a.target.value},style:"flex: 1;"})]}),t("textarea",{placeholder:"Notes (skill level, how you know them, etc.) - optional",rows:3,value:at.value,onInput:a=>{at.value=a.target.value},style:"width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 14px; resize: vertical; margin-bottom: 12px;"}),t("div",{style:"font-size: 12px; color: #666; margin-bottom: 12px;",children:["Added by: ",t("strong",{children:k.value||"(select your name first)"})]}),t("div",{style:"display: flex; gap: 8px;",children:[t("button",{onClick:o,style:"flex: 1; background: #ccc; color: #333;",children:"Cancel"}),t("button",{onClick:i,style:"flex: 2; background: #4CAF50; color: white;",children:"Add Member"})]})]}),!Ce.value&&t(M,{children:[t("div",{class:"preference-group",children:[t("button",{class:`preference-btn singles ${he.value==="singles"?"selected":""}`,onClick:()=>{he.value="singles"},children:"Singles Only"}),t("button",{class:`preference-btn ${he.value==="both"?"selected":""}`,onClick:()=>{he.value="both"},children:"Either"}),t("button",{class:`preference-btn doubles ${he.value==="doubles"?"selected":""}`,onClick:()=>{he.value="doubles"},children:"Doubles Only"})]}),t("div",{class:"time-slots",children:[t("h3",{children:"Available Time (optional)"}),t("div",{style:"display: flex; gap: 6px; margin-bottom: 12px; flex-wrap: wrap;",children:[t("button",{class:"time-preset-btn",onClick:()=>l("08:00","12:00"),children:["Morning",t("br",{}),t("small",{children:"8am-12pm"})]}),t("button",{class:"time-preset-btn",onClick:()=>l("12:00","15:00"),children:["Midday",t("br",{}),t("small",{children:"12-3pm"})]}),t("button",{class:"time-preset-btn",onClick:()=>l("15:00","18:00"),children:["Afternoon",t("br",{}),t("small",{children:"3-6pm"})]}),t("button",{class:"time-preset-btn",onClick:()=>l("18:00","21:00"),children:["Evening",t("br",{}),t("small",{children:"6-9pm"})]})]}),t("div",{style:"display: flex; gap: 8px; align-items: center; flex-wrap: wrap;",children:[t("input",{type:"time",value:ke.value,onInput:a=>{ke.value=a.target.value},style:"flex: 1; min-width: 120px; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;"}),t("span",{style:"color: #666;",children:"to"}),t("input",{type:"time",value:Se.value,onInput:a=>{Se.value=a.target.value},style:"flex: 1; min-width: 120px; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;"}),t("button",{onClick:()=>{ke.value="",Se.value=""},style:"padding: 10px 12px; background: #f5f5f5; color: #666; font-size: 13px;",children:"Clear"})]})]}),t("div",{class:"rotation-option",style:"margin-bottom: 16px; padding: 12px; background: #f9f9f9; border-radius: 8px;",children:[t("label",{style:"display: flex; align-items: center; gap: 4px; cursor: pointer; font-size: 14px;",children:[t("input",{type:"checkbox",checked:Wt.value,onChange:a=>{Wt.value=a.target.checked},style:"width: 18px; height: 18px; cursor: pointer; margin-right: 4px;"}),t("span",{children:"Willing to play 3-player rotation (1v1 or 1v2 format)"})]}),t("div",{style:"font-size: 12px; color: #666; margin-top: 4px; margin-left: 26px;",children:"If unchecked, you'll only be placed in doubles or singles matches"})]}),t("div",{style:"display: flex; gap: 10px; margin-top: 16px;",children:[t("button",{onClick:o,style:"flex: 1; background: #f5f5f5; color: #666;",children:"Cancel"}),t("button",{onClick:n,style:"flex: 2; background: #4CAF50; color: white;",children:"Check In"})]})]})]})]})}function xe(e){return e.toLowerCase().replace(/\s+/g,"")}function Lr(e){switch(e){case"singles":return"Singles";case"doubles":return"Doubles";default:return"Either"}}const Zn=v(!1),Ze=v(null),me=v("both"),At=v(""),Rt=v(""),on=v(!0),Qn=v(!1),rn=v(null),ce=v(""),te=v(!1),ft=v("confirm"),K=v(""),Xn=v("");function Br(e){const n=No(e,k.value);n&&(rn.value=e,ce.value=n.personName,te.value=n.isOwner,ft.value="confirm",K.value=D.value,Xn.value=H.value,Qn.value=!0)}function Jt(){Qn.value=!1,rn.value=null,ce.value="",te.value=!1,ft.value="confirm",K.value="",Xn.value=""}async function Or(){const e=rn.value;if(e===null)return;const n=ce.value,i=te.value,o=K.value;rn.value=null,await Fo(e,k.value),Jt(),ye.value={action:"removal",name:n,date:o,isOwner:i},se.value=!0}function jr(e){const n=fn.value[e];n&&(Ze.value=e,me.value=n.playStyle||"both",At.value=n.timeRange?.start||"",Rt.value=n.timeRange?.end||"",on.value=n.allowRotation!==!1,Zn.value=!0)}function io(){Zn.value=!1,Ze.value=null}async function Wr(){if(Ze.value===null)return;const e={playStyle:me.value,allowRotation:on.value};(At.value||Rt.value)&&(e.timeRange={start:At.value,end:Rt.value}),await Po(Ze.value,e,k.value),io()}function Hr(e){const n=S.value,i=e.name||"",o=k.value&&xe(k.value)===xe(i),r=e.addedBy&&k.value&&xe(k.value)===xe(e.addedBy),l=n&&sessionStorage.getItem(`adminAuth_${n}`)==="true";return!!(o||r||l)}function Ur(){const e=fn.value,n=Ze.value!==null?e[Ze.value]:null,i=t(M,{children:[t(_e,{isOpen:Zn.value,onClose:io,title:`Edit ${n?.name||""}'s Preferences`,children:t("div",{style:"display: flex; flex-direction: column; gap: 16px;",children:[t("div",{children:[t("label",{style:"display: block; font-weight: 500; margin-bottom: 8px;",children:"Play Style"}),t("div",{style:"display: flex; gap: 8px;",children:["singles","doubles","both"].map(o=>t("button",{onClick:()=>{me.value=o},style:{flex:1,padding:"10px",border:me.value===o?"2px solid #4CAF50":"2px solid #e0e0e0",borderRadius:"8px",background:me.value===o?"#E8F5E9":"#fff",color:me.value===o?"#2E7D32":"#666",cursor:"pointer",fontWeight:me.value===o?"600":"400"},children:o==="singles"?"Singles":o==="doubles"?"Doubles":"Either"},o))})]}),t("div",{children:[t("label",{style:"display: block; font-weight: 500; margin-bottom: 8px;",children:"Available Time (optional)"}),t("div",{style:"display: flex; gap: 8px; align-items: center;",children:[t("input",{type:"time",value:At.value,onInput:o=>{At.value=o.target.value},style:"flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 6px;"}),t("span",{children:"to"}),t("input",{type:"time",value:Rt.value,onInput:o=>{Rt.value=o.target.value},style:"flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 6px;"})]})]}),me.value==="singles"&&t("div",{children:[t("label",{style:"display: flex; align-items: center; gap: 8px; cursor: pointer;",children:[t("input",{type:"checkbox",checked:on.value,onChange:o=>{on.value=o.target.checked}}),t("span",{children:"Open to 3-player rotation"})]}),t("p",{style:"font-size: 12px; color: #666; margin: 4px 0 0 24px;",children:"If unchecked, you'll only be matched for 2-player singles"})]}),t("button",{onClick:Wr,style:{padding:"12px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:"pointer",marginTop:"8px"},children:"Save Changes"})]})}),t(_e,{isOpen:Qn.value,onClose:Jt,title:ft.value==="done"?"":te.value?"Remove Your Check-in?":`Remove ${ce.value}?`,showCloseButton:ft.value!=="done",children:t("div",{style:"display: flex; flex-direction: column; gap: 16px;",children:ft.value==="confirm"?t(M,{children:[te.value?t(M,{children:[t("p",{style:"color: #666; margin: 0; line-height: 1.5;",children:"Are you sure you want to remove yourself from this date?"}),t("div",{style:"background: #FFF8E1; border-radius: 8px; padding: 12px; border-left: 4px solid #FFB74D;",children:[t("p",{style:"margin: 0 0 8px 0; font-weight: 500; color: #E65100;",children:"Things to consider:"}),t("ul",{style:"margin: 0; padding-left: 20px; color: #666; font-size: 14px;",children:[t("li",{children:"You'll lose your current spot in the check-in order"}),t("li",{children:["If you want to change your preferences, you can ",t("strong",{children:"edit"})," instead"]}),t("li",{children:"You can always check in again after removing"})]})]})]}):t(M,{children:[t("p",{style:"color: #666; margin: 0; line-height: 1.5;",children:["Are you sure you want to remove ",t("strong",{children:ce.value})," from this date?"]}),t("div",{style:"background: #FFF8E1; border-radius: 8px; padding: 12px; border-left: 4px solid #FFB74D;",children:t("p",{style:"margin: 0; color: #666; font-size: 14px;",children:["They will lose their spot in the check-in order. Consider using ",t("strong",{children:"edit"})," to update their preferences instead."]})})]}),t("div",{style:"display: flex; gap: 12px; margin-top: 8px;",children:[t("button",{onClick:Jt,style:{flex:1,padding:"12px",background:"#f5f5f5",color:"#666",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),t("button",{onClick:Or,style:{flex:1,padding:"12px",background:"#ef5350",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:"Yes, Remove"})]})]}):t(M,{children:[t("div",{style:"text-align: center; padding: 8px 0;",children:[t("div",{style:"font-size: 48px; margin-bottom: 8px;",children:"âœ“"}),t("p",{style:"color: #666; margin: 0;",children:te.value?`You've been removed from ${W(K.value)}`:`${ce.value} has been removed from ${W(K.value)}`})]}),t("div",{children:[t("p",{style:"margin: 0 0 8px 0; font-size: 13px; color: #666; text-align: center;",children:"Let others know:"}),t("div",{style:"display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;",children:[t("a",{href:`https://wa.me/?text=${encodeURIComponent(te.value?`I'm out on ${W(K.value)}.`:`Hi ${ce.value}, I removed you from ${W(K.value)}. Let me know if you have questions!`)}`,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 16px",background:"#25D366",color:"white",borderRadius:"6px",fontSize:"14px",textDecoration:"none"},children:"WhatsApp"}),t("a",{href:`sms:?body=${encodeURIComponent(te.value?`I'm out on ${W(K.value)}.`:`Hi ${ce.value}, I removed you from ${W(K.value)}. Let me know if you have questions!`)}`,style:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 16px",background:"#007AFF",color:"white",borderRadius:"6px",fontSize:"14px",textDecoration:"none"},children:"Text"}),t("a",{href:`mailto:?subject=${encodeURIComponent(te.value?`I'm Out on ${W(K.value)}`:`${Xn.value} - Check-in Removed`)}&body=${encodeURIComponent(te.value?`I'm out on ${W(K.value)}.`:`Hi ${ce.value},

I removed you from ${W(K.value)}.

Let me know if you have questions!`)}`,style:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 16px",background:"#EA4335",color:"white",borderRadius:"6px",fontSize:"14px",textDecoration:"none"},children:"Email"})]})]}),t("button",{onClick:Jt,style:{width:"100%",padding:"12px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:"pointer",marginTop:"8px"},children:"Done"})]})})})]});return e.length===0?t(M,{children:[t("div",{class:"empty-state",children:"No check-ins yet"}),i]}):t(M,{children:[t("div",{id:"checkinList",children:e.map((o,r)=>{const l=k.value&&xe(o.name)===xe(k.value),a=l?"checkin-item current-user":"checkin-item",s=Hr(o);let d="";o.isGuest?d=`guest of ${o.addedBy}`:o.addedBy&&xe(o.addedBy)!==xe(o.name)&&(d=`added by ${o.addedBy}`);const c=o.timeRange?q(o.timeRange.start,o.timeRange.end):"";return t("div",{class:a,children:[t("span",{children:[t("span",{class:"checkin-name",children:[r+1,". ",o.name,l&&t("span",{class:"current-user-badge",children:"YOU"}),d&&t("span",{class:"guest-indicator",children:[" ",d]}),c&&t("span",{class:"time-badge",children:c}),o.allowRotation===!1&&t("span",{class:"time-badge",style:"background: #fff3e0; color: #e65100;",children:"No 3s"})]}),t("span",{class:`preference-badge ${o.playStyle||"both"}`,children:Lr(o.playStyle||"both")}),t("span",{class:"checkin-time",children:Zi(o.timestamp)})]}),s&&t("div",{style:"display: flex; gap: 4px;",children:[t("button",{class:"edit-btn",onClick:()=>jr(r),title:"Edit preferences",style:{background:"rgba(76, 175, 80, 0.1)",color:"#4CAF50",border:"none",borderRadius:"50%",padding:"0",width:"28px",height:"28px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:"âœï¸"}),t("button",{class:"remove-btn",onClick:()=>Br(r),title:"Remove check-in",style:{background:"rgba(255, 82, 82, 0.1)",color:"#e57373",border:"none",borderRadius:"50%",padding:"0",width:"28px",height:"28px",fontSize:"18px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:"Ã—"})]})]},r)})}),i]})}function yi(e,n){return n[Tn(e)]||{include:[],exclude:[]}}function Gr(e,n,i){const o=yi(e,i),r=yi(n,i),l=Tn(e),a=Tn(n);return!o.exclude.includes(a)&&!r.exclude.includes(l)}function Vr(e,n){if(!e||!n||!e.start&&!e.end&&!n.start&&!n.end)return!0;const i=h=>{if(!h)return null;const[g,x]=h.split(":").map(Number);return g*60+x},o=i(e.start),r=i(e.end),l=i(n.start),a=i(n.end),s=360,d=1260,c=o??s,f=r??d,u=l??s;return c<(a??d)&&u<f}function it(e,n,i){return Gr(e.name,n.name,i)?Vr(e.timeRange,n.timeRange):!1}function ei(e,n={}){const i=[],o=[];let r=e.map((p,h)=>({...p,originalIndex:h}));r.sort((p,h)=>p.timestamp-h.timestamp);const l=r.filter(p=>p.playStyle==="doubles"),a=r.filter(p=>p.playStyle==="singles"),s=r.filter(p=>p.playStyle==="both"||!p.playStyle);let d=[...l,...s].sort((p,h)=>p.timestamp-h.timestamp);for(;d.length>=4;){const p=d.slice(0,4);i.push({type:"doubles",number:i.filter(h=>h.type==="doubles").length+1,players:p}),d.splice(0,4)}let c=[...a].sort((p,h)=>p.timestamp-h.timestamp);for(;c.length>=2;){let p=null;for(let h=0;h<c.length-1;h++){for(let g=h+1;g<c.length;g++)if(it(c[h],c[g],n)){p=[c[h],c[g]];break}if(p)break}if(p)i.push({type:"singles",players:p}),p.forEach(h=>{const g=c.findIndex(x=>x.originalIndex===h.originalIndex);g>-1&&c.splice(g,1)});else break}const f=d,u=c;if(f.length>0){const p=4-f.length,h=f.filter(_=>_.playStyle==="both"||!_.playStyle),g=h.length,x=f.every(_=>_.playStyle==="both"||!_.playStyle),m=f.every(_=>_.allowRotation!==!1),b=f.length===3&&it(f[0],f[1],n)&&it(f[0],f[2],n)&&it(f[1],f[2],n);let w=!1;g>=2&&(w=it(h[0],h[1],n)),i.push({type:"doubles-forming",players:f,needed:p,canRotate:f.length===3&&x&&m&&b,eitherCount:g,canPlaySingles:w})}return u.length>0&&u.forEach(p=>{i.push({type:"singles-forming",players:[p],needed:1})}),{matches:i,warnings:o}}const dt=v({}),Lt=v(null),xn=v(!1);function oo(e){return{0:"â˜€ï¸ Clear sky",1:"ðŸŒ¤ï¸ Mainly clear",2:"â›… Partly cloudy",3:"â˜ï¸ Overcast",45:"ðŸŒ«ï¸ Foggy",48:"ðŸŒ«ï¸ Foggy",51:"ðŸŒ¦ï¸ Light drizzle",53:"ðŸŒ¦ï¸ Drizzle",55:"ðŸŒ§ï¸ Heavy drizzle",61:"ðŸŒ§ï¸ Light rain",63:"ðŸŒ§ï¸ Rain",65:"ðŸŒ§ï¸ Heavy rain",71:"ðŸŒ¨ï¸ Light snow",73:"ðŸŒ¨ï¸ Snow",75:"ðŸŒ¨ï¸ Heavy snow",77:"ðŸŒ¨ï¸ Snow grains",80:"ðŸŒ¦ï¸ Rain showers",81:"ðŸŒ§ï¸ Rain showers",82:"â›ˆï¸ Heavy rain showers",85:"ðŸŒ¨ï¸ Snow showers",86:"ðŸŒ¨ï¸ Heavy snow showers",95:"â›ˆï¸ Thunderstorm",96:"â›ˆï¸ Thunderstorm with hail",99:"â›ˆï¸ Severe thunderstorm"}[e]||"ðŸŒ¡ï¸ Weather"}async function Kr(e,n,i){const o=`${e},${n},${i}`;if(dt.value[o])return dt.value[o];try{const r=`https://api.open-meteo.com/v1/forecast?latitude=${e}&longitude=${n}&daily=temperature_2m_max,temperature_2m_min,precipitation_probability_max,weathercode&temperature_unit=fahrenheit&timezone=America/Los_Angeles&forecast_days=14`,l=await fetch(r);if(!l.ok)throw new Error("Weather API error");const a=await l.json();if(!a.daily||!a.daily.time||!Array.isArray(a.daily.time))throw new Error("Invalid weather data format");const s=a.daily.time.indexOf(i);if(s===-1)throw new Error("Weather data not available for this date");const d={tempMax:Math.round(a.daily.temperature_2m_max[s]),tempMin:Math.round(a.daily.temperature_2m_min[s]),precipProb:a.daily.precipitation_probability_max[s]||0,weatherCode:a.daily.weathercode[s]};return dt.value={...dt.value,[o]:d},d}catch(r){console.error("Weather fetch error:",r)}return null}function Yr(){if(B(()=>{const i=pe(()=>{const o=D.value,r=T.value.location;if(!o)return;const l=new Date;l.setHours(0,0,0,0);const a=new Date(o+"T00:00:00"),s=Math.floor((a.getTime()-l.getTime())/(1e3*60*60*24));if(s<0||s>=14){Lt.value=null;return}const d=r?.lat??37.2358,c=r?.lon??-121.9623;xn.value=!0,Kr(d,c,o).then(f=>{Lt.value=f,xn.value=!1})});return()=>i()},[]),xn.value)return t("div",{id:"weatherWidget",style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"10px 14px",background:"linear-gradient(135deg, #e3f2fd 0%, #f0f4ff 100%)",borderRadius:"10px",marginBottom:"16px",fontSize:"13px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)",color:"#666"},children:"Loading weather..."});if(!Lt.value)return null;const e=Lt.value,n=T.value.location?.name||"Los Gatos, CA";return t("div",{id:"weatherWidget",style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 14px",background:"linear-gradient(135deg, #e3f2fd 0%, #f0f4ff 100%)",borderRadius:"10px",marginBottom:"16px",fontSize:"13px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[t("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t("span",{style:{fontWeight:600,color:"#1976d2"},children:n}),t("span",{style:{color:"#666"},children:"â€¢"}),t("span",{style:{color:"#666"},children:oo(e.weatherCode)})]}),t("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[t("span",{style:{fontWeight:600,color:"#333"},children:[e.tempMin,"Â°-",e.tempMax,"Â°F"]}),e.precipProb>0&&t("span",{style:{color:"#1976d2"},children:["ðŸ’§",e.precipProb,"%"]})]})]})}const Mt=v(null);typeof document<"u"&&document.addEventListener("click",e=>{if(Mt.value){const n=e.target;!n.closest(".share-dropdown")&&!n.closest("[data-share-button]")&&(Mt.value=null)}});function qr(e,n){const o=new Date(n+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"}),r=e.players.map(s=>s.name).join(" & "),l=S.value,a=`${window.location.origin}${window.location.pathname}#${l}`;if(e.type==="doubles-forming"){const s=e.needed||4-e.players.length;let c=`ðŸŽ¾ ${s===1?"1 more player needed":`${s} more players needed`} for doubles!
`;return c+=`ðŸ“… ${o}
`,c+=`ðŸ‘¥ ${r} ${e.players.length===1?"is":"are"} in

`,c+=`Can you make it? ${a}`,c}else if(e.type==="singles-forming"){const s=e.players[0];let d=`ðŸŽ¾ 1 more player needed for singles!
`;return d+=`ðŸ“… ${o}
`,d+=`ðŸ‘¤ ${s.name} is in`,s.timeRange&&(d+=` (${q(s.timeRange.start,s.timeRange.end)})`),d+=`

Can you make it? ${a}`,d}return""}function bn(e,n,i){const o=qr(e,n);if(i==="whatsapp"){const r=encodeURIComponent(o);window.open(`https://wa.me/?text=${r}`,"_blank")}else if(i==="sms"){const r=encodeURIComponent(o);window.open(`sms:?body=${r}`,"_blank")}else i==="copy"&&navigator.clipboard.writeText(o).then(()=>{y("Message copied!","success")}).catch(()=>{y("Failed to copy","error")});Mt.value=null}function xi({match:e,matchKey:n,needed:i}){const o=D.value||"",r=Mt.value===n;return t("div",{style:"position: relative; display: inline-block;",children:[t("button",{"data-share-button":!0,onClick:l=>{l.stopPropagation(),Mt.value=r?null:n},style:{background:r?"#e65100":"#ff9800",border:"none",borderRadius:"16px",padding:"6px 14px",fontSize:"13px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:"white",transition:"all 0.2s",boxShadow:"0 2px 6px rgba(255, 152, 0, 0.4)"},children:[t("span",{children:"Invite"}),t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",style:{transform:r?"rotate(180deg)":"none",transition:"transform 0.2s"},children:t("path",{d:"M7 10l5 5 5-5z"})})]}),r&&t("div",{class:"share-dropdown",style:{position:"absolute",top:"100%",right:"0",marginTop:"4px",background:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:100,overflow:"hidden",minWidth:"140px"},children:[t("button",{onClick:()=>bn(e,o,"whatsapp"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#25D366"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp"]}),t("button",{onClick:()=>bn(e,o,"sms"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#2196F3",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"})}),"SMS"]}),t("button",{onClick:()=>bn(e,o,"copy"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#666",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),"Copy"]})]})]})}function Jr(e){switch(e){case"singles":return"Singles";case"doubles":return"Doubles";default:return"Either"}}const Zr=Ro((...e)=>{const[n,i]=e;Wo(n,i)},500);function Bt({matchKey:e}){const n=G.value[e]||"";return t("div",{class:"match-notes",children:t("input",{type:"text",placeholder:"ðŸ“ Add note (court, time, etc.)",value:n,onInput:i=>{const o=i.target.value;Zr(e,o)},class:"match-note-input"})})}function Ee({players:e}){return t("ul",{children:e.map((n,i)=>{const o=n.isGuest?` (guest of ${n.addedBy})`:"",r=n.timeRange?` ${q(n.timeRange.start,n.timeRange.end)}`:"";return t("li",{children:["â€¢ ",n.name,o&&t("span",{class:"guest-indicator",children:o}),r&&t("span",{class:"time-badge",children:r}),t("span",{class:`preference-badge ${n.playStyle||"both"}`,children:Jr(n.playStyle||"both")})]},i)})})}function Qr(e,n,i){let l=`${new Date(i+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}
`,a=0,s=0;e.forEach(g=>{if(g.type==="doubles"){const x=g.players.map(w=>w.name);l+=`Doubles: ${x.join(", ")}
`;const m=g.players.filter(w=>w.timeRange).map(w=>q(w.timeRange.start,w.timeRange.end));m.length>0&&(l+=`${m[0]}
`);const b=`doubles-${g.number}`;G.value[b]&&(l+=`ðŸ“ ${G.value[b]}
`),l+=`
`}else if(g.type==="singles"){a++;const x=g.players.map(C=>C.name);l+=`Singles: ${x.join(", ")}
`;const m=g.players.every(C=>(C.playStyle||"both")==="both"),b=g.players.some(C=>C.allowRotation===!0);m&&b&&(l+=`Open to more players
`);const w=g.players.filter(C=>C.timeRange).map(C=>q(C.timeRange.start,C.timeRange.end));w.length>0&&(l+=`${w[0]}
`);const _=`singles-${a}`;G.value[_]&&(l+=`ðŸ“ ${G.value[_]}
`),l+=`
`}else if(g.type==="singles-or-practice"){s++,l+=`Rotation: ${g.players.map(b=>b.name).join(", ")}
`;const x=g.players.filter(b=>b.timeRange).map(b=>q(b.timeRange.start,b.timeRange.end));x.length>0&&(l+=`${x[0]}
`);const m=`rotation-${s}`;G.value[m]&&(l+=`ðŸ“ ${G.value[m]}
`),l+=`
`}else if(g.type==="doubles-forming"){const x=g.players.map(_=>_.name),m=g.needed===1?"need 1 more":`need ${g.needed} more`;l+=`Doubles (forming): ${x.join(", ")}
`,l+=`${m}
`,g.canRotate?l+=`Can rotate if no 4th
`:g.canPlaySingles&&(g.eitherCount||0)>=2?l+=`Will play singles if no more join
`:(g.eitherCount||0)===1&&g.players.length===1&&(l+=`Can play singles if 1 more joins
`);const b=g.players.filter(_=>_.timeRange).map(_=>q(_.timeRange.start,_.timeRange.end));b.length>0&&(l+=`${b[0]}
`);const w="doubles-forming-1";G.value[w]&&(l+=`ðŸ“ ${G.value[w]}
`),l+=`
`}else if(g.type==="singles-forming"){const x=g.players[0];l+=`Singles (forming): ${x.name}
`,l+=`need 1 more
`,x.timeRange&&(l+=`${q(x.timeRange.start,x.timeRange.end)}
`),l+=`
`}});const d=e.filter(g=>g.type==="waiting");if(d.length>0){const g=d.flatMap(x=>x.players.map(m=>m.name));g.length>0&&(l+=`Standby: ${g.join(", ")}
`)}const c=T.value.location,f=c?.lat??37.2358,u=c?.lon??-121.9623,p=`${f},${u},${i}`,h=dt.value[p];if(h){const g=oo(h.weatherCode);l+=`${g}, ${h.tempMax}Â°F`}return l.trim()}function Xr(e,n,i){const o=Qr(e,n,i),r=encodeURIComponent(o);window.open(`https://wa.me/?text=${r}`,"_blank")}function el(){const e=D.value;e&&confirm(`Are you sure you want to reset all check-ins for ${W(e)}?

This cannot be undone.`)&&jo()}function tl(){const e=fn.value,n=D.value||"";if(e.length===0)return null;const{matches:i,warnings:o}=ei(e),r=i.some(c=>c.type!=="waiting"||c.players.length>0);if(!r&&o.length===0)return null;const l=S.value,a=l&&sessionStorage.getItem(`adminAuth_${l}`)==="true";let s=0,d=0;return t("div",{class:"matches",id:"matches",style:"margin-top: 24px; padding-top: 24px; border-top: 2px solid #f0f0f0;",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;",children:[t("h2",{style:"margin: 0;",children:"Games"}),t("div",{style:"display: flex; gap: 8px; align-items: center;",children:[r&&t("button",{onClick:()=>Xr(i,e,n),title:"Share to WhatsApp",style:{background:"#25D366",color:"white",border:"none",borderRadius:"50%",padding:"0",width:"36px",height:"36px",fontSize:"16px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})})}),a&&e.length>0&&t("button",{class:"reset-day-btn",onClick:el,title:"Reset This Day",style:{background:"rgba(255, 82, 82, 0.1)",color:"#e57373",border:"none",borderRadius:"50%",padding:"0",width:"36px",height:"36px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]})]}),o.length>0&&t("div",{class:"warning-box",children:o.map((c,f)=>t("div",{children:c},f))}),i.map((c,f)=>{if(c.type==="doubles"){const u=`doubles-${c.number}`;return t("div",{class:"match-group",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;",children:[t("h3",{style:"margin: 0;",children:["Doubles ",c.number]}),t("span",{style:"display: flex; align-items: center; gap: 4px; color: #4CAF50; font-size: 13px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),"Ready"]})]}),t(Ee,{players:c.players}),t(Bt,{matchKey:u})]},f)}if(c.type==="singles"){s++;const u=`singles-${s}`,p=c.players.every(x=>(x.playStyle||"both")==="both"),h=c.players.some(x=>x.allowRotation===!0),g=p&&h;return t("div",{class:"match-group singles-group",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;",children:[t("h3",{style:"margin: 0;",children:["Singles",s>1?` ${s}`:""]}),t("span",{style:"display: flex; align-items: center; gap: 4px; color: #4CAF50; font-size: 13px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),"Ready"]})]}),t(Ee,{players:c.players}),g&&t("p",{style:"color: #666; font-size: 13px; margin: 8px 0 4px 0; font-style: italic;",children:"Open to more players"}),t(Bt,{matchKey:u})]},f)}if(c.type==="singles-or-practice"){d++;const u=`rotation-${d}`;return t("div",{class:"match-group singles-group",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;",children:[t("h3",{style:"margin: 0;",children:"Rotation (3 players) - 1v1 or 1v2"}),t("span",{style:"display: flex; align-items: center; gap: 4px; color: #4CAF50; font-size: 13px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),"Ready"]})]}),t(Ee,{players:c.players}),t(Bt,{matchKey:u})]},f)}if(c.type==="doubles-forming"){const u="doubles-forming-1",p=c.needed||4-c.players.length;let h="";return c.canRotate?h="Can rotate if no 4th":c.canPlaySingles&&(c.eitherCount||0)>=2?h="Will play singles if no more join":(c.eitherCount||0)===1&&c.players.length===1&&(h="Can play singles if 1 more joins"),t("div",{class:"match-group forming-group",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;",children:[t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("h3",{style:"margin: 0;",children:"Doubles"}),t("span",{style:"display: flex; align-items: center; gap: 4px; color: #F57C00; font-size: 12px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",children:t("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),"Need ",p]})]}),t(xi,{match:c,matchKey:u,needed:p})]}),t(Ee,{players:c.players}),h&&t("p",{style:"color: #666; font-size: 13px; margin: 8px 0 4px 0; font-style: italic;",children:h}),t(Bt,{matchKey:u})]},f)}return c.type==="singles-forming"?t("div",{class:"match-group forming-group",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;",children:[t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("h3",{style:"margin: 0;",children:"Singles"}),t("span",{style:"display: flex; align-items: center; gap: 4px; color: #F57C00; font-size: 12px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",children:t("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),"Need 1"]})]}),t(xi,{match:c,matchKey:"singles-forming-1",needed:1})]}),t(Ee,{players:c.players})]},f):c.type==="waiting"?t("div",{class:"match-group waiting-group",children:[t("h3",{children:"Waiting for Match"}),t(Ee,{players:c.players})]},f):null})]})}function nl(){return t("div",{children:[t(Nr,{}),t(Yr,{}),t(Fr,{}),t(tl,{}),t("div",{class:"checkins",style:"margin-top: 24px; padding-top: 24px; border-top: 2px solid #f0f0f0;",children:[t("h2",{onClick:()=>{Ht.value=!Ht.value},style:"cursor: pointer; display: flex; align-items: center; gap: 8px;",children:[t("span",{children:Ht.value?"â–¼":"â–¶"}),t("span",{children:["Check-ins (",t("span",{children:fn.value.length}),")"]})]}),Ht.value&&t(Ur,{})]})]})}function Pe(e,n){const i=e.replace(/-/g,"");if(n){const o=n.replace(":","")+"00";return`${i}T${o}`}return i}function wn(e){return e.replace(/\\/g,"\\\\").replace(/;/g,"\\;").replace(/,/g,"\\,").replace(/\n/g,"\\n")}function il(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}@tenniscoordinator`}function ol(e){const{date:n,title:i,description:o,location:r,startTime:l,endTime:a}=e,s=il(),c=new Date().toISOString().replace(/[-:]/g,"").split(".")[0]+"Z";let f=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Tennis Coordinator//EN","CALSCALE:GREGORIAN","METHOD:PUBLISH","BEGIN:VEVENT",`UID:${s}`,`DTSTAMP:${c}`];if(l&&a)f.push(`DTSTART:${Pe(n,l)}`),f.push(`DTEND:${Pe(n,a)}`);else if(l){f.push(`DTSTART:${Pe(n,l)}`);const[u,p]=l.split(":").map(Number),g=`${((u+2)%24).toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`;f.push(`DTEND:${Pe(n,g)}`)}else{f.push(`DTSTART;VALUE=DATE:${Pe(n)}`);const u=new Date(n+"T00:00:00");u.setDate(u.getDate()+1);const p=u.toISOString().split("T")[0];f.push(`DTEND;VALUE=DATE:${Pe(p)}`)}return f.push(`SUMMARY:${wn(i)}`),f.push(`DESCRIPTION:${wn(o)}`),r&&f.push(`LOCATION:${wn(r)}`),f.push("END:VEVENT"),f.push("END:VCALENDAR"),f.join(`\r
`)}function rl(e,n){const i=ol(e),o=new Blob([i],{type:"text/calendar;charset=utf-8"}),r=URL.createObjectURL(o),l=document.createElement("a");l.href=r,l.download=`tennis-${e.date}.ics`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r)}function ll(e){const{date:n,matchType:i,players:o,groupName:r,location:l,notes:a}=e,d=`${i.includes("doubles")?"Doubles":i.includes("singles")?"Singles":"Tennis"} - ${r}`;let c=`Players: ${o.map(h=>h.name).join(", ")}`;a&&(c+=`

Notes: ${a}`);let f,u;const p=o.filter(h=>h.timeRange);if(p.length>0){const h=p.map(x=>x.timeRange.start).sort(),g=p.map(x=>x.timeRange.end).sort();f=h[h.length-1],u=g[0],f>=u&&(f=p[0].timeRange.start,u=p[0].timeRange.end)}return{date:n,title:d,description:c,location:l,startTime:f,endTime:u}}const Dt=v(null),ve=v(null),ln=v(!1),Qe=v(new Set),gt=v(!1);function al(){const e=S.value;return e?sessionStorage.getItem(`adminAuth_${e}`)==="true":!1}typeof document<"u"&&document.addEventListener("click",e=>{if(Dt.value){const n=e.target;!n.closest(".share-dropdown")&&!n.closest("[data-share-button]")&&(Dt.value=null)}});function vt(e){return e.toLowerCase().replace(/\s+/g,"")}const sl=qe(()=>{const e=ve.value||k.value;if(!e)return[];const n=vt(e),i=[],o=new Date;o.setHours(0,0,0,0);const r=Object.keys(Z.value).sort();for(const l of r){if(new Date(l+"T00:00:00")<o)continue;const s=Z.value[l]||[];if(s.length===0)continue;const d={},c=L.value||{};for(const[u,p]of Object.entries(c))p&&typeof p=="object"&&(d[vt(u)]={include:p.include||[],exclude:p.exclude||[]});const f=ei(s,d);for(const u of f.matches)if(u.players.map(h=>vt(h.name)).includes(n)){const h=u.type==="doubles-forming"||u.type==="singles-forming";i.push({date:l,type:u.type,matchNumber:u.number||1,players:u.players.map(g=>({name:g.name,timeRange:g.timeRange})),isForming:h,needed:u.needed})}}return i});function Ln(e){switch(e){case"doubles":case"doubles-forming":return"Doubles";case"singles":case"singles-forming":return"Singles";case"rotation":case"singles-or-practice":return"Rotation";default:return e}}function cl(e){const i=new Date(e.date+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"}),o=e.players.map(a=>a.name).join(" & "),r=S.value,l=`${window.location.origin}${window.location.pathname}#${r}`;if(e.type==="doubles-forming"){const a=e.needed||4-e.players.length;let d=`ðŸŽ¾ ${a===1?"1 more player needed":`${a} more players needed`} for doubles!
`;return d+=`ðŸ“… ${i}
`,d+=`ðŸ‘¥ ${o} ${e.players.length===1?"is":"are"} in

`,d+=`Can you make it? ${l}`,d}else if(e.type==="singles-forming"){const a=e.players[0];let s=`ðŸŽ¾ 1 more player needed for singles!
`;return s+=`ðŸ“… ${i}
`,s+=`ðŸ‘¤ ${a.name} is in`,a.timeRange&&(s+=` (${q(a.timeRange.start,a.timeRange.end)})`),s+=`

Can you make it? ${l}`,s}return""}function _n(e,n){const i=cl(e);if(n==="whatsapp"){const o=encodeURIComponent(i);window.open(`https://wa.me/?text=${o}`,"_blank")}else if(n==="sms"){const o=encodeURIComponent(i);window.open(`sms:?body=${o}`,"_blank")}else n==="copy"&&navigator.clipboard.writeText(i).then(()=>{y("Message copied!","success")}).catch(()=>{y("Failed to copy","error")});Dt.value=null}function bi(e){ln.value||(D.value=e,ne.value="checkin")}function dl(e){const n=`${e.type.replace("-forming","")}-${e.matchNumber}`,i=G.value[n]||"",o=ll({date:e.date,matchType:e.type,players:e.players,groupName:H.value||"Tennis",location:T.value.location?.name,notes:i});rl(o),y("Calendar event downloaded","success")}function ul(e){const n=new Set(Qe.value);n.has(e)?n.delete(e):n.add(e),Qe.value=n}function pl(){ln.value=!1,Qe.value=new Set,gt.value=!1}function hl(e,n){const i=S.value,o=`${window.location.origin}${window.location.pathname}#${i}`,r=e.filter((d,c)=>{const f=`mygames-${d.date}-${d.type}-${c}`;return n.has(f)});if(r.length===0)return"";const l=r.filter(d=>!d.isForming),a=r.filter(d=>d.isForming);let s=`ðŸŽ¾ Tennis Update

`;if(l.length>0){s+=`âœ… Ready to Play:
`;for(const d of l){const f=new Date(d.date+"T00:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),u=Ln(d.type),p=d.players.map(h=>h.name).join(", ");s+=`â€¢ ${f} - ${u}
  ${p}
`}s+=`
`}if(a.length>0){s+=`ðŸŸ¡ Need Players:
`;for(const d of a){const f=new Date(d.date+"T00:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),u=Ln(d.type),p=d.needed||1,h=d.players.map(g=>g.name).join(", ");s+=`â€¢ ${f} - ${u} needs ${p}
  ${h}
`}s+=`
`}return s+=`Check in: ${o}`,s}function Ot(e,n){const i=hl(n,Qe.value);if(!i){y("No games selected","error");return}if(e==="native"&&navigator.share)navigator.share({title:"Tennis Update",text:i}).catch(()=>{navigator.clipboard.writeText(i).then(()=>{y("Copied to clipboard","success")})});else if(e==="whatsapp"){const o=encodeURIComponent(i);window.open(`https://wa.me/?text=${o}`,"_blank")}else if(e==="sms"){const o=encodeURIComponent(i);window.open(`sms:?body=${o}`,"_blank")}else navigator.clipboard.writeText(i).then(()=>{y("Copied to clipboard","success")}).catch(()=>{y("Failed to copy","error")});gt.value=!1}function fl(){const e=sl.value,n=al(),i=ve.value||k.value,o=ve.value&&ve.value!==k.value,r=Qe.value.size,l=ln.value;return t("div",{style:"padding: 16px 0;",children:[l&&t("div",{style:{position:"fixed",bottom:"70px",left:"50%",transform:"translateX(-50%)",width:"calc(100% - 32px)",maxWidth:"400px",background:"white",borderRadius:"16px",padding:"12px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px",zIndex:100,boxShadow:"0 4px 16px rgba(0,0,0,0.15)"},children:[t("button",{onClick:pl,style:{background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",cursor:"pointer",color:"#666"},children:"Cancel"}),t("span",{style:{fontSize:"14px",color:"#666"},children:[r," selected"]}),t("div",{style:{position:"relative"},children:[t("button",{onClick:()=>{gt.value=!gt.value},disabled:r===0,style:{background:r>0?"#4CAF50":"#ccc",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",fontWeight:"600",cursor:r>0?"pointer":"default",color:"white",display:"flex",alignItems:"center",gap:"6px"},children:["Share",t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"})})]}),gt.value&&r>0&&t("div",{style:{position:"absolute",bottom:"100%",right:"0",marginBottom:"8px",background:"white",borderRadius:"12px",boxShadow:"0 4px 16px rgba(0,0,0,0.2)",overflow:"hidden",minWidth:"160px"},children:[navigator.share&&t("button",{onClick:()=>Ot("native",e),style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 16px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#333"},children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#4CAF50",children:t("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"})}),"Share..."]}),t("button",{onClick:()=>Ot("whatsapp",e),style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 16px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#25D366",borderTop:navigator.share?"1px solid #f0f0f0":"none"},children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",children:t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp"]}),t("button",{onClick:()=>Ot("sms",e),style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 16px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#2196F3",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",children:t("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"})}),"SMS"]}),t("button",{onClick:()=>Ot("copy",e),style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 16px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#666",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",children:t("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),"Copy text"]})]})]})]}),t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;",children:[t("h2",{style:"margin: 0; font-size: 20px;",children:o?`${ve.value}'s Games`:"My Upcoming Games"}),t("div",{style:"display: flex; gap: 8px; align-items: center;",children:[o&&t("button",{onClick:()=>{ve.value=null},style:{background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"16px",padding:"4px 12px",fontSize:"12px",cursor:"pointer",color:"#666"},children:"Back to mine"}),!o&&e.length>0&&!l&&t("button",{onClick:()=>{ln.value=!0},style:{background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"16px",padding:"6px 12px",fontSize:"13px",cursor:"pointer",color:"#666",display:"flex",alignItems:"center",gap:"6px"},children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"})}),"Share"]})]})]}),n&&!o&&t("div",{style:{background:"#f5f5f5",borderRadius:"8px",padding:"12px",marginBottom:"16px"},children:[t("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"6px",fontWeight:"500"},children:"View another member's games"}),t("select",{value:"",onChange:a=>{const s=a.target.value;s&&(ve.value=s)},style:{marginBottom:0},children:[t("option",{value:"",children:"Select a member..."}),F.value.filter(a=>a!==k.value).sort((a,s)=>a.localeCompare(s)).map(a=>t("option",{value:a,children:a},a))]})]}),e.length===0?t("div",{style:"text-align: center; padding: 48px 24px; background: #f9f9f9; border-radius: 12px;",children:[t("div",{style:"font-size: 48px; margin-bottom: 16px;",children:"ðŸ“…"}),t("p",{style:"font-size: 18px; margin: 0 0 8px 0; color: #333;",children:"No upcoming games"}),t("p",{style:"font-size: 14px; color: #666; margin: 0;",children:o?`${ve.value} has no upcoming games.`:"Check in for a date to get matched with other players!"})]}):t("div",{style:"display: flex; flex-direction: column; gap: 12px;",children:e.map((a,s)=>{const d=a.players.filter(h=>vt(h.name)!==vt(i)),c=`mygames-${a.date}-${a.type}-${s}`,f=Dt.value===c,u=a.needed||1,p=Qe.value.has(c);return t("div",{onClick:()=>{l&&ul(c)},style:{padding:"16px",background:a.isForming?"#FFF8E1":"#E8F5E9",borderRadius:"12px",border:l&&p?"2px solid #4CAF50":a.isForming?"1px solid #FFE082":"1px solid #A5D6A7",cursor:l?"pointer":"default",position:"relative"},children:[l&&t("div",{style:{position:"absolute",top:"12px",right:"12px",width:"24px",height:"24px",borderRadius:"6px",border:p?"none":"2px solid #ccc",background:p?"#4CAF50":"white",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"16px",fontWeight:"bold"},children:p&&"âœ“"}),t("div",{onClick:h=>{l||(h.stopPropagation(),bi(a.date))},style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",cursor:"pointer",paddingRight:l?"32px":"0"},children:[t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("span",{style:"font-weight: 600; color: #333; font-size: 16px;",children:W(a.date)}),t("span",{style:{fontSize:"12px",padding:"2px 8px",borderRadius:"10px",background:"#f0f0f0",color:"#666",fontWeight:"500"},children:Ln(a.type)})]}),a.isForming?t("span",{style:"display: flex; align-items: center; gap: 4px; color: #F57C00; font-size: 12px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",children:t("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),"Need ",u]}):t("span",{style:"display: flex; align-items: center; gap: 4px; color: #4CAF50; font-size: 12px; font-weight: 600;",children:[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",children:t("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),"Ready"]})]}),t("div",{onClick:h=>{l||(h.stopPropagation(),bi(a.date))},style:{fontSize:"15px",color:"#555",cursor:"pointer",paddingRight:l?"32px":"0"},children:d.length>0?t(M,{children:[t("span",{style:"color: #888;",children:"Playing with "}),t("span",{style:"font-weight: 500;",children:d.map(h=>h.name).join(", ")})]}):t("span",{style:"color: #888; font-style: italic;",children:["Waiting for ",u," more player",u>1?"s":""]})}),!l&&t("div",{style:"margin-top: 12px; display: flex; gap: 8px; align-items: center; position: relative;",children:[t("button",{onClick:h=>{h.stopPropagation(),dl(a)},title:"Add to Calendar",style:{background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"16px",padding:"6px 12px",fontSize:"13px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:"#666",transition:"all 0.2s"},children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"})}),t("span",{children:"Calendar"})]}),a.isForming&&t(M,{children:[t("button",{"data-share-button":!0,onClick:h=>{h.stopPropagation(),Dt.value=f?null:c},style:{background:f?"#e65100":"#ff9800",border:"none",borderRadius:"16px",padding:"6px 14px",fontSize:"13px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:"white",transition:"all 0.2s",boxShadow:"0 2px 6px rgba(255, 152, 0, 0.4)"},children:[t("span",{children:"Invite"}),t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",fill:"currentColor",style:{transform:f?"rotate(180deg)":"none",transition:"transform 0.2s"},children:t("path",{d:"M7 10l5 5 5-5z"})})]}),f&&t("div",{class:"share-dropdown",style:{position:"absolute",bottom:"100%",left:"0",marginBottom:"4px",background:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:100,overflow:"hidden",minWidth:"140px"},children:[t("button",{onClick:h=>{h.stopPropagation(),_n(a,"whatsapp")},style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#25D366"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp"]}),t("button",{onClick:h=>{h.stopPropagation(),_n(a,"sms")},style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#2196F3",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"})}),"SMS"]}),t("button",{onClick:h=>{h.stopPropagation(),_n(a,"copy")},style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",width:"100%",border:"none",background:"white",cursor:"pointer",fontSize:"14px",color:"#666",borderTop:"1px solid #f0f0f0"},children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",children:t("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),"Copy"]})]})]})]})]},s)})}),e.length>0&&t("p",{style:"font-size: 13px; color: #888; text-align: center; margin-top: 16px;",children:"Tap a game to view that day's details"})]})}const jt=v(!1),Cn=v(!1),je=v(!1),We=v(!1),J=v([]);function ro(e){return e.toLowerCase().replace(/\s+/g,"")}async function gl(){const e=S.value,n=k.value;if(!(!e||!n))try{const l=(await R().ref(`groups/${e}/userNotifications/${ro(n)}/preferences`).once("value")).val()||{};je.value=l.activityAlerts===!0,We.value=l.matchConfirmations!==!1,J.value=l.unwatchedMembers||l.mutedMembers||[]}catch(i){console.error("Error loading notification prefs from Firebase:",i)}}async function Tt(){const e=S.value,n=k.value;if(!e||!n)return;const i={activityAlerts:je.value,matchConfirmations:We.value,unwatchedMembers:J.value};try{await R().ref(`groups/${e}/userNotifications/${ro(n)}/preferences`).set(i),y("Preferences saved","success")}catch(o){console.error("Error saving notification prefs:",o),y("Failed to save preferences","error")}}function vl(e){J.value.includes(e)?J.value=J.value.filter(n=>n!==e):J.value=[...J.value,e],Tt()}function ml(){J.value=[],Tt()}function yl(){J.value=F.value.filter(e=>e!==k.value),Tt()}function xl(e){return!J.value.includes(e)}function bl(e){e.read||Vo(e.id),e.date&&(D.value=e.date,ne.value="checkin")}function wl(e){const n=new Date(e),o=new Date().getTime()-e;return o<6e4?"Just now":o<36e5?`${Math.floor(o/6e4)}m ago`:o<864e5?`${Math.floor(o/36e5)}h ago`:n.toLocaleDateString([],{month:"short",day:"numeric"})}function _l(){const e=pn.value,n=e.filter(i=>!i.read).length;return B(()=>{gl()},[]),t("div",{style:"padding: 16px 0;",children:[Cn.value&&t("div",{style:"position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1002;",children:t("div",{style:"background: white; padding: 20px; border-radius: 12px; max-width: 350px; width: 90%;",children:[t("h3",{style:"margin-top: 0; margin-bottom: 8px; color: #333;",children:"Watched Members"}),t("p",{style:"margin: 0 0 12px 0; font-size: 13px; color: #666;",children:"Get activity alerts from these members"}),t("div",{style:"display: flex; gap: 8px; margin-bottom: 12px;",children:[t("button",{onClick:ml,style:"flex: 1; padding: 8px; background: #E8F5E9; color: #2E7D32; border: 1px solid #A5D6A7; border-radius: 6px; font-size: 13px; cursor: pointer; font-weight: 500;",children:"Select All"}),t("button",{onClick:yl,style:"flex: 1; padding: 8px; background: #f5f5f5; color: #666; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; cursor: pointer; font-weight: 500;",children:"Deselect All"})]}),t("div",{style:"max-height: 300px; overflow-y: auto;",children:F.value.filter(i=>i!==k.value).map(i=>{const o=xl(i);return t("button",{onClick:()=>vl(i),style:{display:"flex",alignItems:"center",gap:"10px",width:"100%",textAlign:"left",padding:"12px",marginBottom:"4px",border:o?"1px solid #A5D6A7":"1px solid #e0e0e0",borderRadius:"8px",background:o?"#E8F5E9":"white",color:"#333",cursor:"pointer",fontSize:"14px",fontWeight:"normal"},children:[t("span",{style:{width:"20px",height:"20px",borderRadius:"4px",border:o?"none":"2px solid #ccc",background:o?"#4CAF50":"white",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"14px",flexShrink:0},children:o&&"âœ“"}),i]},i)})}),t("button",{onClick:()=>{Cn.value=!1},style:"width: 100%; margin-top: 12px; background: #4CAF50; color: white;",children:"Done"})]})}),t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;",children:[t("h2",{style:"margin: 0; font-size: 20px;",children:["Notifications",n>0&&t("span",{style:"margin-left: 8px; font-size: 14px; color: #666; font-weight: 400;",children:["(",n," unread)"]})]}),n>0&&t("button",{onClick:qo,style:{background:"none",border:"none",color:"#4CAF50",fontSize:"14px",cursor:"pointer",padding:"4px 8px"},children:"Mark all read"})]}),t("div",{style:"margin-bottom: 16px; border: 1px solid #e0e0e0; border-radius: 12px; overflow: hidden;",children:[t("button",{onClick:()=>{jt.value=!jt.value},style:"width: 100%; padding: 14px 16px; background: #f9f9f9; border: none; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-size: 15px; font-weight: 500;",children:[t("span",{style:"display: flex; align-items: center; gap: 8px; color: #333;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#666",children:t("path",{d:"M19.14,12.94c0.04-0.31,0.06-0.63,0.06-0.94c0-0.31-0.02-0.63-0.06-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.37,4.82,11.69,4.82,12s0.02,0.63,0.06,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"})}),"Alert Settings"]}),t("span",{style:{color:"#999",transform:jt.value?"rotate(180deg)":"none",transition:"transform 0.2s"},children:"â–¼"})]}),jt.value&&t("div",{style:"padding: 16px; background: #fff; border-top: 1px solid #e0e0e0;",children:[t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px;",children:[t("div",{children:[t("div",{style:"font-weight: 500; font-size: 14px; color: #333;",children:"Activity alerts"}),t("div",{style:"font-size: 12px; color: #666;",children:"Check-ins, cancellations, notes"})]}),t("label",{style:"position: relative; display: inline-block; width: 48px; height: 26px;",children:[t("input",{type:"checkbox",checked:je.value,onChange:i=>{je.value=i.target.checked,Tt()},style:"opacity: 0; width: 0; height: 0;"}),t("span",{style:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:je.value?"#4CAF50":"#ccc",transition:"0.3s",borderRadius:"26px"},children:t("span",{style:{position:"absolute",height:"20px",width:"20px",left:je.value?"25px":"3px",bottom:"3px",backgroundColor:"white",transition:"0.3s",borderRadius:"50%"}})})]})]}),t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;",children:[t("div",{children:[t("div",{style:"font-weight: 500; font-size: 14px; color: #333;",children:"Match confirmations"}),t("div",{style:"font-size: 12px; color: #666;",children:"When you're placed in a match"})]}),t("label",{style:"position: relative; display: inline-block; width: 48px; height: 26px;",children:[t("input",{type:"checkbox",checked:We.value,onChange:i=>{We.value=i.target.checked,Tt()},style:"opacity: 0; width: 0; height: 0;"}),t("span",{style:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:We.value?"#4CAF50":"#ccc",transition:"0.3s",borderRadius:"26px"},children:t("span",{style:{position:"absolute",height:"20px",width:"20px",left:We.value?"25px":"3px",bottom:"3px",backgroundColor:"white",transition:"0.3s",borderRadius:"50%"}})})]})]}),t("div",{style:"padding-top: 12px; border-top: 1px solid #e0e0e0;",children:t("div",{style:"display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;",children:[t("div",{children:[t("div",{style:"font-weight: 500; font-size: 14px; color: #333;",children:"Watched members"}),t("div",{style:"font-size: 12px; color: #666;",children:(()=>{const i=F.value.filter(r=>r!==k.value);return`Watching ${i.length-J.value.length} of ${i.length} members`})()})]}),t("button",{onClick:()=>{Cn.value=!0},style:"background: #E8F5E9; color: #2E7D32; border: 1px solid #A5D6A7; padding: 6px 12px; border-radius: 6px; font-size: 13px; cursor: pointer; font-weight: 500;",children:"Edit"})]})})]})]}),e.length===0?t("div",{style:"text-align: center; padding: 48px 24px; background: #f9f9f9; border-radius: 12px;",children:[t("div",{style:"font-size: 48px; margin-bottom: 16px;",children:"ðŸ””"}),t("p",{style:"font-size: 18px; margin: 0 0 8px 0; color: #333;",children:"No notifications"}),t("p",{style:"font-size: 14px; color: #666; margin: 0;",children:"You'll see updates about matches and check-ins here"})]}):t("div",{style:"display: flex; flex-direction: column; gap: 8px;",children:e.map(i=>t("div",{onClick:()=>bl(i),style:{padding:"14px 16px",background:i.read?"#f9f9f9":"#E8F5E9",borderRadius:"10px",cursor:i.date?"pointer":"default",border:i.read?"1px solid #e0e0e0":"1px solid #A5D6A7",position:"relative"},children:t("div",{style:"display: flex; justify-content: space-between; align-items: flex-start;",children:[t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 15px; color: #333; margin-bottom: 6px;",children:[!i.read&&t("span",{style:"display: inline-block; width: 8px; height: 8px; background: #4CAF50; border-radius: 50%; margin-right: 8px;"}),i.message]}),t("div",{style:"font-size: 12px; color: #888; display: flex; align-items: center; gap: 8px; flex-wrap: wrap;",children:[t("span",{children:wl(i.timestamp)}),i.date&&t("span",{style:"color: #4CAF50; font-weight: 500; display: flex; align-items: center; gap: 2px;",children:[W(i.date)," â†’"]})]})]}),t("button",{onClick:o=>{o.stopPropagation(),Yo(i.id)},style:{background:"none",border:"none",color:"#999",fontSize:"18px",cursor:"pointer",padding:"0 4px",marginLeft:"8px"},children:"Ã—"})]})},i.id))})]})}function Cl(){const e=T.value.groupDescription,n=T.value.groupRules,i=e||n,o=[{title:"Getting Started",icon:"ðŸŽ¾",content:["When you first open the app, you'll be asked to select your name from the member list.","Use the date selector to pick the day you want to play.","Check in by selecting your match preference and optionally setting your available times."]},{title:"Check-in Options",icon:"âœ…",content:["Doubles - You want to play doubles matches (4 players).","Singles - You want to play singles matches (2 players).","Both - You're flexible and happy to play either format.","Rotation - Enable this option to join 3-player rotation matches where players take turns.","Time Range - Set your earliest and latest available times to help coordinate."]},{title:"Match Types",icon:"ðŸ‘¥",content:["Doubles (green) - A confirmed 4-player doubles match.","Singles (green) - A confirmed 2-player singles match.","Rotation (green) - A confirmed 3-player match with rotating play.","Forming (yellow) - A match that needs more players to be complete."]},{title:"My Games",icon:"ðŸ“…",content:["View all your upcoming games across all dates at a glance.","Tap any game card to jump directly to that day's check-in page.","Yellow background indicates the game is still forming and needs more players.","Green background means the game is confirmed and ready to play."]},{title:"Alerts",icon:"ðŸ””",content:["Get notified when matches are formed or when players join/leave.","Unread alerts show a red badge with the count on the tab.","Tap a notification to mark it as read.","Access notification settings to configure your preferences."]},{title:"Profile",icon:"ðŸ‘¤",content:["Access your profile by tapping your name badge in the top-right corner.","Edit your display name, phone number, and email address.","Change your user session to switch to a different account.","Admin login is available for group administrators."]},{title:"Tips",icon:"ðŸ’¡",content:["Check in early to get matched with your preferred players.",`Select "Both" if you're flexible - it increases your chances of getting a match.`,"Set your time preferences to help organizers coordinate scheduling.","Enable rotation if you're open to 3-player matches."]},{title:"Admin Features",icon:"âš™ï¸",content:["Access admin mode via Admin Login in your Profile page.","Manage Members - Add, edit, or remove group members.","Group Settings - Configure group name, PINs, weather location, story, and rules.","Activity History - View all check-ins and changes with option to delete test data.","Group Insights - View game stats, player activity trends, and analytics."]}],r=n?n.split(`
`).filter(l=>l.trim()):[];return t("div",{style:"padding: 16px 0;",children:[i&&t("div",{style:{marginBottom:"24px"},children:[t("h2",{style:"margin: 0 0 16px 0; font-size: 20px;",children:["About ",H.value]}),e&&t("div",{style:{background:"#E8F5E9",borderRadius:"12px",padding:"16px",border:"1px solid #C8E6C9",marginBottom:"12px"},children:[t("h3",{style:"margin: 0 0 8px 0; font-size: 15px; color: #2E7D32; display: flex; align-items: center; gap: 8px;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#4CAF50",children:t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})}),"Our Story"]}),t("p",{style:"margin: 0; color: #333; font-size: 14px; line-height: 1.6; white-space: pre-wrap;",children:e})]}),r.length>0&&t("div",{style:{background:"#FFF8E1",borderRadius:"12px",padding:"16px",border:"1px solid #FFECB3"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 15px; color: #F57C00; display: flex; align-items: center; gap: 8px;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#FF9800",children:t("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})}),"Rules & Tips"]}),t("ul",{style:"margin: 0; padding-left: 20px; color: #333; font-size: 14px; line-height: 1.6;",children:r.map((l,a)=>t("li",{style:"margin-bottom: 6px;",children:l},a))})]})]}),t("h2",{style:"margin: 0 0 16px 0; font-size: 20px;",children:"User Guide"}),t("div",{style:"display: flex; flex-direction: column; gap: 16px;",children:o.map((l,a)=>t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",border:"1px solid #e0e0e0"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px; display: flex; align-items: center; gap: 8px;",children:[t("span",{children:l.icon}),t("span",{children:l.title})]}),t("ul",{style:"margin: 0; padding-left: 20px; color: #555; font-size: 14px; line-height: 1.6;",children:l.content.map((s,d)=>t("li",{style:"margin-bottom: 4px;",children:s},d))})]},a))}),t("p",{style:"font-size: 13px; color: #888; text-align: center; margin-top: 20px;",children:"Need more help? Contact your group administrator."})]})}function kn(e){return e.toLowerCase().replace(/\s+/g,"")}const kl=qe(()=>{const e=Z.value,n=new Date;n.setHours(0,0,0,0);const i=new Date(n);i.setDate(i.getDate()-30);const o=new Date(n);o.setDate(o.getDate()-7);let r=0,l=0,a=0,s=0,d=0,c=0;const f={},u={0:0,1:0,2:0,3:0,4:0,5:0,6:0},p={};let h=0,g=0;const x=Object.keys(e).sort();for(const C of x){const $=e[C]||[];if($.length===0)continue;const A=new Date(C+"T00:00:00");if(!(A<n))continue;h++,g+=$.length;const oe=A>=i,re=A>=o,X=A.getDay(),j=new Date(A);j.setDate(j.getDate()-j.getDay());const le=j.toISOString().split("T")[0],{matches:lo}=ei($);for(const ee of lo)if(!(ee.type==="waiting"||ee.type==="doubles-forming"||ee.type==="singles-forming")){r++,u[X]++,p[le]=(p[le]||0)+1,oe&&d++,re&&c++,ee.type==="doubles"?l++:ee.type==="singles"?a++:ee.type==="singles-or-practice"&&s++;for(const tt of ee.players){const Te=kn(tt.name);f[Te]||(f[Te]={gamesPlayed:0,checkIns:0,lastPlayed:C,doublesPlayed:0,singlesPlayed:0}),f[Te].gamesPlayed++,f[Te].lastPlayed=C,ee.type==="doubles"?f[Te].doublesPlayed++:f[Te].singlesPlayed++}}for(const ee of $){const tt=kn(ee.name);f[tt]||(f[tt]={gamesPlayed:0,checkIns:0,lastPlayed:"",doublesPlayed:0,singlesPlayed:0}),f[tt].checkIns++}}const m=Object.entries(f).map(([C,$])=>({name:F.value.find(Q=>kn(Q)===C)||C,...$,participationRate:$.checkIns>0?Math.round($.gamesPlayed/$.checkIns*100):0})).sort((C,$)=>$.gamesPlayed-C.gamesPlayed).slice(0,10),b=Object.entries(u).sort((C,$)=>$[1]-C[1])[0],w=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],_=Object.entries(p).sort((C,$)=>$[0].localeCompare(C[0])).slice(0,8).reverse();return{totalGames:r,doublesGames:l,singlesGames:a,rotationGames:s,last30DaysGames:d,last7DaysGames:c,activeDays:h,totalCheckIns:g,averagePlayersPerDay:h>0?(g/h).toFixed(1):"0",topPlayers:m,mostPopularDay:b?w[parseInt(b[0])]:"N/A",mostPopularDayCount:b?b[1]:0,dayOfWeekCounts:u,recentWeeks:_,totalMembers:F.value.length,activeMembersLast30Days:Object.values(f).filter(C=>C.lastPlayed?new Date(C.lastPlayed+"T00:00:00")>=i:!1).length}});function Sn({label:e,value:n,subtext:i}){return t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",textAlign:"center",flex:"1",minWidth:"100px"},children:[t("div",{style:{fontSize:"24px",fontWeight:"700",color:"#4CAF50"},children:n}),t("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:e}),i&&t("div",{style:{fontSize:"11px",color:"#888",marginTop:"2px"},children:i})]})}function $n({value:e,max:n,color:i="#4CAF50"}){const o=n>0?e/n*100:0;return t("div",{style:{background:"#e0e0e0",borderRadius:"4px",height:"8px",flex:"1",overflow:"hidden"},children:t("div",{style:{background:i,height:"100%",width:`${o}%`,borderRadius:"4px",transition:"width 0.3s ease"}})})}function Sl(){const e=kl.value,n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i=Math.max(...Object.values(e.dayOfWeekCounts));return t("div",{style:"padding: 16px;",children:[t("h3",{style:"margin: 0 0 16px 0; font-size: 18px; color: #333;",children:"Group Insights"}),t("div",{style:{display:"flex",gap:"12px",marginBottom:"20px",flexWrap:"wrap"},children:[t(Sn,{label:"Total Games",value:e.totalGames,subtext:"all time"}),t(Sn,{label:"Last 30 Days",value:e.last30DaysGames}),t(Sn,{label:"Last 7 Days",value:e.last7DaysGames})]}),t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px;",children:"Game Types"}),t("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[t("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t("span",{style:{width:"70px",fontSize:"14px"},children:"Doubles"}),t($n,{value:e.doublesGames,max:e.totalGames,color:"#4CAF50"}),t("span",{style:{width:"40px",textAlign:"right",fontSize:"14px",fontWeight:"600"},children:e.doublesGames})]}),t("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t("span",{style:{width:"70px",fontSize:"14px"},children:"Singles"}),t($n,{value:e.singlesGames,max:e.totalGames,color:"#2196F3"}),t("span",{style:{width:"40px",textAlign:"right",fontSize:"14px",fontWeight:"600"},children:e.singlesGames})]}),t("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t("span",{style:{width:"70px",fontSize:"14px"},children:"Rotation"}),t($n,{value:e.rotationGames,max:e.totalGames,color:"#FF9800"}),t("span",{style:{width:"40px",textAlign:"right",fontSize:"14px",fontWeight:"600"},children:e.rotationGames})]})]})]}),t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px;",children:"Activity by Day"}),t("div",{style:{display:"flex",gap:"4px",alignItems:"flex-end",height:"80px"},children:n.map((o,r)=>{const l=e.dayOfWeekCounts[r],a=i>0?l/i*60:0;return t("div",{style:{flex:"1",textAlign:"center"},children:[t("div",{style:{background:r===Object.entries(e.dayOfWeekCounts).sort((s,d)=>d[1]-s[1])[0]?.[0]?"#4CAF50":"#c8e6c9",height:`${Math.max(a,4)}px`,borderRadius:"4px 4px 0 0",marginBottom:"4px",transition:"height 0.3s ease"}}),t("span",{style:{fontSize:"10px",color:"#666"},children:o})]},o)})}),t("p",{style:{fontSize:"13px",color:"#666",margin:"12px 0 0 0",textAlign:"center"},children:["Most popular: ",t("strong",{children:e.mostPopularDay})," (",e.mostPopularDayCount," games)"]})]}),e.recentWeeks.length>0&&t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px;",children:"Weekly Trend"}),t("div",{style:{display:"flex",gap:"4px",alignItems:"flex-end",height:"60px"},children:e.recentWeeks.map(([o,r])=>{const l=Math.max(...e.recentWeeks.map(c=>c[1])),a=l>0?r/l*50:0,s=new Date(o+"T00:00:00"),d=`${s.getMonth()+1}/${s.getDate()}`;return t("div",{style:{flex:"1",textAlign:"center"},children:[t("div",{style:{background:"#4CAF50",height:`${Math.max(a,4)}px`,borderRadius:"4px 4px 0 0",marginBottom:"4px"}}),t("span",{style:{fontSize:"9px",color:"#666"},children:d})]},o)})})]}),t("div",{style:{background:"#f9f9f9",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px;",children:"Most Active Players"}),t("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"11px",color:"#888",marginBottom:"8px",padding:"0 4px"},children:[t("span",{children:"Player"}),t("span",{children:"Games"})]}),e.topPlayers.length===0?t("p",{style:{fontSize:"14px",color:"#666",textAlign:"center",margin:"16px 0"},children:"No game data yet"}):t("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:e.topPlayers.map((o,r)=>t("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px",background:r<3?"#E8F5E9":"white",borderRadius:"8px"},children:[t("span",{style:{width:"20px",height:"20px",borderRadius:"50%",background:r===0?"#FFD700":r===1?"#C0C0C0":r===2?"#CD7F32":"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"600",color:r<3?"#333":"#666"},children:r+1}),t("span",{style:{flex:"1",fontSize:"14px"},children:o.name}),t("span",{style:{fontSize:"14px",fontWeight:"600",color:"#4CAF50"},children:o.gamesPlayed})]},o.name))})]}),t("div",{style:{background:"#E3F2FD",borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:[t("h3",{style:"margin: 0 0 12px 0; font-size: 16px;",children:"Group Health"}),t("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[t("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px"},children:[t("span",{style:{color:"#666"},children:"Total members"}),t("span",{style:{fontWeight:"600"},children:e.totalMembers})]}),t("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px"},children:[t("span",{style:{color:"#666"},children:"Active last 30 days"}),t("span",{style:{fontWeight:"600"},children:e.activeMembersLast30Days})]}),t("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px"},children:[t("span",{style:{color:"#666"},children:"Avg players/day"}),t("span",{style:{fontWeight:"600"},children:e.averagePlayersPerDay})]}),t("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px"},children:[t("span",{style:{color:"#666"},children:"Days with activity"}),t("span",{style:{fontWeight:"600"},children:e.activeDays})]})]})]}),t("p",{style:"font-size: 13px; color: #888; text-align: center; margin-top: 16px;",children:"Stats are based on completed games from past dates"})]})}function wi(){const e=S.value;return e?sessionStorage.getItem(`adminAuth_${e}`)==="true":!1}function $l(){const[e,n]=ae(wi()),[i,o]=ae(!1),[r,l]=ae(""),[a,s]=ae(""),[d,c]=ae(""),[f,u]=ae(!1),[p,h]=ae(!1);B(()=>{const _=setInterval(()=>{n(wi())},1e3);return()=>clearInterval(_)},[]),B(()=>{const _=k.value;if(_&&(l(_),L.value)){const C=L.value[_];C&&(s(C.phone||""),c(C.email||""))}},[k.value,L.value]);const g=async()=>{const _=k.value;if(!_)return;u(!0);const C=r.trim();if(C!==_){const A=await Qi(_,C);if(A){k.value=C;const Q=S.value;Q&&localStorage.setItem(`sessionUser_${Q}`,C),await hi(C,{phone:a,email:d})}u(!1),A&&o(!1)}else{const A=await hi(_,{phone:a,email:d});u(!1),A&&o(!1)}},x=()=>{const _=k.value;if(_&&(l(_),L.value)){const C=L.value[_];C&&(s(C.phone||""),c(C.email||""))}o(!1)},m=k.value&&L.value?L.value[k.value]:null,b=()=>{if(confirm("Change user? This will clear your current session.")){const _=S.value;_&&localStorage.removeItem(`sessionUser_${_}`),k.value="",y("Please select your name","info"),It.value=!0}},w=()=>{const _=S.value;_&&(sessionStorage.removeItem(`adminAuth_${_}`),n(!1),y("Logged out of admin mode","info"))};return t("div",{style:"padding: 16px 0;",children:[t("h2",{style:"margin: 0 0 16px 0; font-size: 20px;",children:"Profile"}),t("div",{style:{background:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"16px",border:"1px solid #e0e0e0"},children:[!i&&t("div",{style:"display: flex; justify-content: flex-end; margin-bottom: 8px;",children:t("button",{onClick:()=>o(!0),style:{background:"none",border:"none",color:"#4CAF50",cursor:"pointer",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},children:[t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:t("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})}),"Edit"]})}),i?t("div",{style:"display: flex; flex-direction: column; gap: 12px;",children:[t("div",{children:[t("label",{style:"display: block; font-size: 13px; color: #666; margin-bottom: 4px;",children:"Display Name"}),t("input",{type:"text",value:r,onInput:_=>l(_.target.value),placeholder:"Your name",style:{width:"100%",padding:"10px 12px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),t("div",{children:[t("label",{style:"display: block; font-size: 13px; color: #666; margin-bottom: 4px;",children:"Phone Number"}),t("input",{type:"tel",value:a,onInput:_=>s(_.target.value),placeholder:"e.g., (555) 123-4567",style:{width:"100%",padding:"10px 12px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),t("div",{children:[t("label",{style:"display: block; font-size: 13px; color: #666; margin-bottom: 4px;",children:"Email Address"}),t("input",{type:"email",value:d,onInput:_=>c(_.target.value),placeholder:"e.g., name@example.com",style:{width:"100%",padding:"10px 12px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",boxSizing:"border-box"}})]}),t("div",{style:"display: flex; gap: 8px; margin-top: 4px;",children:[t("button",{onClick:x,disabled:f,style:{flex:1,padding:"10px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"Cancel"}),t("button",{onClick:g,disabled:f,style:{flex:1,padding:"10px",background:"#4CAF50",border:"none",borderRadius:"8px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"500",opacity:f?.7:1},children:f?"Saving...":"Save"})]})]}):t("div",{style:"display: flex; flex-direction: column; gap: 8px;",children:[t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#888",children:t("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),t("span",{style:{color:"#333",fontSize:"14px"},children:k.value||"Not set"})]}),t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#888",children:t("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})}),t("span",{style:{color:m?.phone?"#333":"#aaa",fontSize:"14px"},children:m?.phone||"No phone number"})]}),t("div",{style:"display: flex; align-items: center; gap: 8px;",children:[t("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"#888",children:t("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})}),t("span",{style:{color:m?.email?"#333":"#aaa",fontSize:"14px"},children:m?.email||"No email address"})]}),!m?.phone&&!m?.email&&t("p",{style:"font-size: 13px; color: #888; margin: 8px 0 0 0;",children:"Add your contact info so organizers can reach you about matches."})]})]}),t("div",{style:"display: flex; flex-direction: column; gap: 8px;",children:[e&&t(M,{children:[t("button",{onClick:()=>{hn.value=!0},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#E8F5E9",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#4CAF50",children:t("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Manage Members"}),t("div",{style:"font-size: 13px; color: #888;",children:[F.value.length," members in group"]})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]}),t("button",{onClick:()=>{Ae.value=!0},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#666",children:t("path",{d:"M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Group Settings"}),t("div",{style:"font-size: 13px; color: #888;",children:"Name, PIN, location, and other settings"})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]}),t("button",{onClick:()=>{Ue.value=!0},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#666",children:t("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Activity History"}),t("div",{style:"font-size: 13px; color: #888;",children:"View recent check-ins and changes"})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]}),t("button",{onClick:()=>h(!p),style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:p?"#E3F2FD":"#fff",border:p?"1px solid #90CAF9":"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#E8F5E9",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#4CAF50",children:t("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Group Insights"}),t("div",{style:"font-size: 13px; color: #888;",children:"Game stats, player activity, and trends"})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",style:{transform:p?"rotate(90deg)":"none",transition:"transform 0.2s"},children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]}),p&&t("div",{style:{background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",overflow:"hidden"},children:t(Sl,{})}),t("button",{onClick:w,style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#FFF3E0",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#FF9800",children:t("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #FF9800;",children:"Exit Admin Mode"}),t("div",{style:"font-size: 13px; color: #888;",children:"Return to regular user view"})]})]})]}),!e&&t("button",{onClick:()=>{Ae.value=!0},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#FFF3E0",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#FF9800",children:t("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Admin Login"}),t("div",{style:"font-size: 13px; color: #888;",children:"Access group settings and member management"})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]}),t("button",{onClick:b,style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#fff",border:"1px solid #e0e0e0",borderRadius:"12px",cursor:"pointer",width:"100%",textAlign:"left",marginTop:e?"8px":"0"},children:[t("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:t("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:"#666",children:t("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})})}),t("div",{style:"flex: 1;",children:[t("div",{style:"font-size: 16px; font-weight: 500; color: #333;",children:"Change User"}),t("div",{style:"font-size: 13px; color: #888;",children:"Switch to a different account"})]}),t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"#ccc",children:t("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})})]})]}),t("p",{style:"font-size: 12px; color: #aaa; text-align: center; margin-top: 32px;",children:"Tennis Coordinator v0.8.1"})]})}const Y=v(!1),de=v(""),he=v("both"),fe=v(!1),Ce=v(!1),ot=v(""),Ne=v(""),rt=v(""),lt=v(""),at=v(""),st=v(""),Wt=v(!0),ke=v(""),Se=v(""),Ht=v(!0),Fe=v(!1),se=v(!1),ye=v(null);function zl(){Mo(),Do(),To(),Ko(),B(()=>{const i=S.value;if(i){if(sessionStorage.getItem("siteAdminAuth")==="true"){Fe.value=!0;return}const r=`pinAuth_${i}`,l=sessionStorage.getItem(r)==="true";Fe.value=l}},[S.value]),B(()=>{D.value=Ao()},[]),B(()=>{const i=S.value;if(i){const o=localStorage.getItem(`sessionUser_${i}`);o?k.value=o:Fe.value&&(It.value=!0)}},[S.value,Fe.value]);const e=()=>{const i=S.value;i&&sessionStorage.setItem(`pinAuth_${i}`,"true"),Fe.value=!0,window.scrollTo(0,0),k.value||(It.value=!0)},n=!Fe.value&&!!T.value.groupPin;return t(M,{children:[t(er,{isOpen:n,groupName:H.value,correctPin:T.value.groupPin,onSuccess:e}),t(zr,{}),t(fr,{}),t(kr,{}),t(cr,{}),t(or,{}),t("div",{class:"container",id:"appContainer",style:n?"filter: blur(5px); pointer-events: none;":"",children:[t(Xo,{}),t("div",{style:"padding-bottom: 80px;",children:[ne.value==="checkin"&&t(nl,{}),ne.value==="matches"&&t(fl,{}),ne.value==="notifications"&&t(_l,{}),ne.value==="help"&&t(Cl,{}),ne.value==="profile"&&t($l,{})]})]}),t(Tr,{}),t(Qo,{})]})}const Ut=v(!1),U=v({}),_i=v(!0),zn=v(null),$e=v(null),Gt=v(null),ct=v(""),Le=v(!1),ge=v(null),Vt=v("");function Il(){B(()=>{e()},[]);async function e(){try{const g=(await R().ref("siteSettings").once("value")).val()||{};zn.value=g.siteAdminPin||null,sessionStorage.getItem("siteAdminAuth")==="true"&&(Ut.value=!0,await n())}catch(p){console.error("Error initializing admin page:",p),y("Failed to initialize","error")}finally{_i.value=!1}}async function n(){try{const h=await R().ref("groups").once("value");U.value=h.val()||{}}catch(p){console.error("Error loading groups:",p),y("Failed to load groups","error")}}function i(p){p.preventDefault(),$e.value=null;const g=p.target.querySelector("input"),x=g.value.trim();if(!x){$e.value="Please enter a PIN";return}if(!zn.value){$e.value="Site admin PIN not configured. Please set siteAdminPin in siteSettings in Firebase.";return}x===zn.value?(sessionStorage.setItem("siteAdminAuth","true"),Ut.value=!0,$e.value=null,n()):($e.value="Incorrect PIN. Please try again.",g.value="",g.focus())}function o(){sessionStorage.removeItem("siteAdminAuth"),Ut.value=!1,U.value={}}function r(){window.location.hash="",window.location.reload()}function l(p){Gt.value===p?Gt.value=null:(Gt.value=p,ct.value="")}async function a(p){const h=ct.value.trim();if(!h){y("Please enter a member name","error");return}Le.value=!0;try{const g=R(),x=U.value[p],m=x?.settings?.members||[];if(m.some(w=>w.toLowerCase()===h.toLowerCase())){y("Member already exists","error"),Le.value=!1;return}const b=[...m,h];await g.ref(`groups/${p}/settings/members`).set(b),U.value={...U.value,[p]:{...x,settings:{...x?.settings,members:b}}},ct.value="",y(`Added ${h} to the group`,"success")}catch(g){console.error("Error adding member:",g),y("Failed to add member","error")}finally{Le.value=!1}}async function s(p,h){if(confirm(`Remove ${h} from this group?`))try{const g=R(),x=U.value[p],b=(x?.settings?.members||[]).filter(w=>w!==h);await g.ref(`groups/${p}/settings/members`).set(b),U.value={...U.value,[p]:{...x,settings:{...x?.settings,members:b}}},y(`Removed ${h}`,"success")}catch(g){console.error("Error removing member:",g),y("Failed to remove member","error")}}function d(p,h){ge.value={groupId:p,originalName:h},Vt.value=h}async function c(){const p=ge.value;if(!p)return;const h=Vt.value.trim();if(!h){y("Name cannot be empty","error");return}if(h===p.originalName){ge.value=null;return}const g=U.value[p.groupId],x=g?.settings?.members||[];if(x.some(m=>m.toLowerCase()===h.toLowerCase()&&m!==p.originalName)){y("A member with this name already exists","error");return}try{const m=R(),b=x.map($=>$===p.originalName?h:$);await m.ref(`groups/${p.groupId}/settings/members`).set(b);const w=g?.settings?.memberDetails||{};if(w[p.originalName]){const $=w[p.originalName];await m.ref(`groups/${p.groupId}/settings/memberDetails/${p.originalName}`).remove(),await m.ref(`groups/${p.groupId}/settings/memberDetails/${h}`).set($);const A={...w};A[h]=$,delete A[p.originalName],U.value={...U.value,[p.groupId]:{...g,settings:{...g?.settings,members:b,memberDetails:A}}}}else U.value={...U.value,[p.groupId]:{...g,settings:{...g?.settings,members:b}}};const C=(await m.ref(`groups/${p.groupId}/checkins`).once("value")).val()||{};for(const[$,A]of Object.entries(C))if(A&&typeof A=="object"){const Q=Object.values(A);let oe=!1;const re=Q.map(X=>X&&X.name===p.originalName?(oe=!0,{...X,name:h}):X);oe&&await m.ref(`groups/${p.groupId}/checkins/${$}`).set(re)}ge.value=null,y(`Renamed ${p.originalName} to ${h}`,"success")}catch(m){console.error("Error renaming member:",m),y("Failed to rename member","error")}}if(_i.value)return t("div",{class:"site-admin-page",children:t("div",{class:"site-admin-container",children:t("div",{class:"site-admin-loading",children:[t("div",{class:"loading-spinner-icon"}),t("p",{children:"Loading..."})]})})});if(!Ut.value)return t("div",{class:"site-admin-page",children:t("div",{class:"site-admin-container",children:t("div",{class:"site-admin-login-card",children:[t("div",{class:"site-admin-header",children:[t("span",{class:"site-admin-icon",children:"ðŸ”"}),t("h1",{children:"Site Administration"}),t("p",{class:"site-admin-subtitle",children:"Tennis Coordinator Platform"})]}),t("form",{onSubmit:i,class:"site-admin-form",children:[t("div",{class:"form-group",children:[t("label",{for:"admin-pin",children:"Administrator PIN"}),t("input",{id:"admin-pin",type:"password",placeholder:"Enter your PIN",class:"site-admin-input",autoFocus:!0})]}),$e.value&&t("div",{class:"site-admin-error",children:[t("span",{class:"error-icon",children:"âš ï¸"}),$e.value]}),t("button",{type:"submit",class:"site-admin-submit",children:"Sign In"})]}),t("div",{class:"site-admin-footer",children:t("button",{onClick:r,class:"back-to-home",children:"â† Back to Home"})})]})})});const f=Object.entries(U.value),u=f.reduce((p,[,h])=>p+(h.settings?.members?.length||0),0);return t("div",{class:"site-admin-page",children:t("div",{class:"site-admin-dashboard",children:[t("header",{class:"site-admin-dashboard-header",children:[t("div",{class:"header-left",children:[t("h1",{children:"ðŸŽ¾ Site Administration"}),t("p",{class:"header-subtitle",children:"Tennis Coordinator Platform"})]}),t("button",{onClick:o,class:"logout-button",children:"Sign Out"})]}),t("div",{class:"site-admin-stats",children:[t("div",{class:"stat-card",children:[t("span",{class:"stat-value",children:f.length}),t("span",{class:"stat-label",children:"Tennis Groups"})]}),t("div",{class:"stat-card",children:[t("span",{class:"stat-value",children:u}),t("span",{class:"stat-label",children:"Total Members"})]})]}),t("section",{class:"site-admin-section",children:[t("h2",{children:"All Tennis Groups"}),f.length===0?t("div",{class:"empty-state",children:t("p",{children:"No tennis groups have been created yet."})}):t("div",{class:"groups-grid",children:f.map(([p,h])=>{const g=h.settings?.members||[],x=Gt.value===p;return t("div",{class:`group-card ${x?"expanded":""}`,children:[t("div",{class:"group-card-header",children:[t("h3",{children:h.settings?.groupName||p}),t("span",{class:"group-id",children:["#",p]})]}),t("div",{class:"group-card-body",children:[t("div",{class:"group-stat",children:[t("span",{class:"group-stat-icon",children:"ðŸ‘¥"}),t("span",{children:[g.length," members"]})]}),h.settings?.location?.name&&t("div",{class:"group-stat",children:[t("span",{class:"group-stat-icon",children:"ðŸ“"}),t("span",{children:h.settings.location.name})]})]}),x&&t("div",{class:"group-members-section",children:[t("div",{class:"members-header",children:t("h4",{children:"Members"})}),t("div",{class:"add-member-form",children:[t("input",{type:"text",placeholder:"Enter member name",value:ct.value,onInput:m=>{ct.value=m.target.value},onKeyDown:m=>{m.key==="Enter"&&(m.preventDefault(),a(p))},class:"member-input",disabled:Le.value}),t("button",{onClick:()=>a(p),class:"add-member-btn",disabled:Le.value,children:Le.value?"...":"Add"})]}),t("div",{class:"members-list",children:g.length===0?t("p",{class:"no-members",children:"No members yet. Add the first member above."}):g.map(m=>{const b=ge.value?.groupId===p&&ge.value?.originalName===m;return t("div",{class:"member-item",children:b?t(M,{children:[t("input",{type:"text",value:Vt.value,onInput:w=>{Vt.value=w.target.value},onKeyDown:w=>{w.key==="Enter"?(w.preventDefault(),c()):w.key==="Escape"&&(ge.value=null)},class:"edit-member-input",autoFocus:!0}),t("button",{onClick:c,class:"save-member-btn",title:"Save",children:"âœ“"}),t("button",{onClick:()=>{ge.value=null},class:"cancel-edit-btn",title:"Cancel",children:"âœ•"})]}):t(M,{children:[t("span",{class:"member-name",children:m}),t("button",{onClick:()=>d(p,m),class:"edit-member-btn",title:"Edit name",children:"âœŽ"}),t("button",{onClick:()=>s(p,m),class:"remove-member-btn",title:"Remove member",children:"Ã—"})]})},m)})})]}),t("div",{class:"group-card-footer",children:[t("button",{onClick:()=>l(p),class:"manage-members-btn",children:x?"Hide Members":"Manage Members"}),t("a",{href:`#${p}`,class:"view-group-link",onClick:m=>{m.preventDefault(),window.location.hash=p,window.location.reload()},children:"View Group â†’"})]})]},p)})})]})]})})}function Al({message:e,type:n}){const i=()=>{switch(n){case"success":return"âœ“";case"error":return"âœ•";default:return"â„¹"}};return t("div",{class:`toast toast-${n}`,children:[t("span",{class:"toast-icon",children:i()}),t("span",{class:"toast-message",children:e})]})}const S=v(null),H=v(""),D=v(null),k=v(""),Ci=v(!0),ut=v([]),Z=v({}),F=v([]),L=v({}),fn=qe(()=>D.value?Z.value[D.value]||[]:[]);let Rl=0;function y(e,n="info"){const i=++Rl;ut.value=[...ut.value,{id:i,message:e,type:n}],setTimeout(()=>{ut.value=ut.value.filter(o=>o.id!==i)},3e3)}async function Kt(e){try{const o=(await R().ref("groups").once("value")).val()||{};for(const[r,l]of Object.entries(o))if(l.settings&&l.settings.shortCode===e)return console.log(`[resolveShortCode] Resolved "${e}" to group ID: ${r}`),r;return console.log(`[resolveShortCode] No match found for "${e}", using as-is`),null}catch(n){return console.error("[resolveShortCode] Error:",n),null}}async function Ml(){const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const s=e.replace(/^\/+|\/+$/g,"");if(s==="admin")return history.replaceState(null,"",e),"admin";if(s&&s!=="index.html"&&s!=="app.html")return history.replaceState(null,"",e),await Kt(s)||s}const n=window.location.hash.replace(/^#\/?/,"");if(n&&n!=="admin")return await Kt(n)||n;if(n==="admin")return"admin";const o=new URLSearchParams(window.location.search).get("group");if(o)return await Kt(o)||o;const l=window.location.pathname.replace(/^\/+|\/+$/g,"");return l==="admin"?"admin":!l||l==="index.html"||l==="app.html"?null:await Kt(l)||l}function Dl(){return B(()=>{async function e(){try{Ji();const n=await Ml();if(S.value=n,n&&n!=="admin"){const i=localStorage.getItem(`sessionUser_${n}`);i&&(k.value=i)}}catch(n){console.error("Initialization error:",n),y("Failed to initialize app","error")}finally{Ci.value=!1}}e()},[]),Ci.value?t("div",{class:"loading-screen",children:[t("div",{class:"loading-spinner",children:"ðŸŽ¾"}),t("p",{children:"Loading..."})]}):t(M,{children:[S.value===null&&t(Io,{}),S.value==="admin"&&t(Il,{}),S.value&&S.value!=="admin"&&t(zl,{}),t("div",{class:"toast-container",children:ut.value.map(e=>t(Al,{message:e.message,type:e.type},e.id))})]})}fo(t(Dl,{}),document.getElementById("app"));
